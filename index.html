<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Улучшенная игра TON CRASH с новыми функциями</title>
<style>
@import url('https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&display=swap');

* {
margin: 0;
padding: 0;
box-sizing: border-box;
}

/* Загрузочный экран с черным фоном и картинкой */
.loading-overlay {
position: fixed;
top: 0;
left: 0;
width: 100%;
height: 100%;
background: #000000;
z-index: 9999;
display: flex;
align-items: center;
justify-content: center;
opacity: 1;
transition: opacity 0.8s ease-out;
}

.loading-overlay img {
width: 200px;
height: 200px;
object-fit: contain;
}

.loading-overlay.fade-out {
opacity: 0;
pointer-events: none;
}

/* ФИКСИРОВАННЫЕ ПАНЕЛИ СВЕРХУ - ПЕРЕМЕЩЕНЫ НА 15 ПИКСЕЛЕЙ ВЫШЕ И ПОМЕНЯНЫ МЕСТАМИ */
.fixed-balance-panel {
position: fixed;
top: 105px;
right: 20px;
background: rgba(0, 0, 0, 0.4);
backdrop-filter: blur(10px);
border-radius: 25px;
padding: 12px 20px;
display: flex;
align-items: center;
gap: 12px;
z-index: 10000;
border: 1px solid rgba(255, 255, 255, 0.1);
transform: scale(0.77);
transform-origin: top right;
}

.fixed-balance-ton-logo {
width: 32px;
height: 32px;
border-radius: 50%;
}

.fixed-balance-amount {
color: white;
font-family: 'Orbitron', monospace;
font-weight: 700;
font-size: 1.1rem;
}

.fixed-balance-plus {
width: 28px;
height: 28px;
background: white;
color: black;
border-radius: 50%;
display: flex;
align-items: center;
justify-content: center;
font-weight: 900;
font-size: 1.2rem;
cursor: pointer;
transition: all 0.3s ease;
}

.fixed-balance-plus:hover {
transform: scale(1.1);
}

.fixed-status-panel {
position: fixed;
top: 105px;
left: 20px;
background: rgba(0, 0, 0, 0.4);
backdrop-filter: blur(10px);
border-radius: 25px;
padding: 12px 20px;
display: flex;
align-items: center;
gap: 12px;
z-index: 10000;
border: 1px solid rgba(255, 255, 255, 0.1);
transform: scale(0.77);
transform-origin: top left;
}

.fixed-status-icon {
width: 32px;
height: 32px;
}

.fixed-status-number {
color: #00ff00;
font-family: 'Orbitron', monospace;
font-weight: 700;
font-size: 1.1rem;
}

body {
font-family: 'Orbitron', monospace;
background: #141414;
color: white;
overflow-x: hidden;
min-height: 100vh;
padding: 20px;
padding-bottom: 150px;
padding-top: 100px;
}

/* ЗАТЕМНЕНИЕ ДЛЯ НЕАКТИВНЫХ ВКЛАДОК */
.content-dimmed .fixed-balance-panel,
.content-dimmed .fixed-status-panel {
opacity: 0.4;
transition: opacity 0.3s ease;
}

.content-dimmed:not(.tab-balance) .fixed-balance-panel {
opacity: 0.4;
}

.content-dimmed:not(.tab-status) .fixed-status-panel {
opacity: 0.4;
}

.container {
max-width: 1600px;
margin: 0 auto;
position: relative;
}

.header {
display: flex;
justify-content: space-between;
align-items: center;
margin-bottom: 30px;
background: #171717;
padding: 20px;
border-radius: 20px;
border: 1px solid rgba(139, 69, 255, 0.3);
}

.logo {
display: flex;
align-items: center;
gap: 15px;
}

.logo img {
height: 50px;
width: auto;
}

.balance-container {
display: flex;
align-items: center;
gap: 15px;
background: rgba(26, 26, 46, 0.8);
padding: 15px 20px;
border-radius: 12px;
border: 1px solid rgba(139, 69, 255, 0.3);
position: relative;
}

.ton-icon {
width: 24px;
height: 24px;
}

.balance-amount {
font-size: 1rem;
font-weight: 400;
display: flex;
flex-direction: column;
align-items: flex-start;
gap: 2px;
color: white;
cursor: pointer;
}

.balance-main {
font-size: 1.1rem;
font-weight: 700;
display: flex;
align-items: center;
gap: 8px;
}

.balance-secondary {
font-size: 0.9rem;
font-weight: 400;
opacity: 0.7;
display: flex;
align-items: center;
gap: 5px;
}

.currency-switch {
background: rgba(139, 69, 255, 0.2);
border: 1px solid #8b45ff;
border-radius: 8px;
padding: 2px 6px;
font-size: 0.7rem;
font-weight: 700;
color: #8b45ff;
margin-left: 5px;
cursor: pointer;
transition: all 0.3s ease;
}

.currency-switch:hover {
background: rgba(139, 69, 255, 0.4);
}

.balance-amount:hover {
transform: scale(1.02);
transition: transform 0.2s ease;
}

.balance-blurred {
filter: blur(8px);
user-select: none;
}

.balance-hidden .balance-main, .balance-hidden .balance-secondary {
color: #8b45ff;
font-weight: 900;
}

.balance-hidden .balance-main {
font-size: 1.5rem;
}

.login-overlay {
position: absolute;
top: 50%;
left: 50%;
transform: translate(-50%, -50%);
z-index: 10;
}

.login-btn {
background: #8b45ff;
color: white;
border: none;
padding: 12px 25px;
border-radius: 12px;
font-family: 'Orbitron', monospace;
font-weight: 700;
font-size: 1rem;
cursor: pointer;
transition: all 0.3s ease;
text-transform: none;
}

.login-btn:hover {
background: #7a3de6;
transform: translateY(-2px);
}

.balance-buttons {
display: flex;
gap: 10px;
margin-top: 10px;
align-items: center;
}

.balance-button {
background: #185fc9;
color: white;
border: none;
padding: 12px 16px;
border-radius: 50%;
font-family: 'Orbitron', monospace;
font-weight: 600;
font-size: 1.2rem;
cursor: pointer;
transition: all 0.3s ease;
text-transform: none;
width: 40px;
height: 40px;
display: flex;
align-items: center;
justify-content: center;
}

.balance-button:hover {
background: #1450a8;
transform: translateY(-1px);
}

.balance-button.withdraw {
display: none;
}

.refresh-balance-button {
background: #185fc9;
border: 1px solid #185fc9;
border-radius: 50%;
width: 35px;
height: 35px;
display: flex;
align-items: center;
justify-content: center;
cursor: pointer;
transition: all 0.3s ease;
font-size: 1.2rem;
margin-left: 10px;
color: white;
}

.refresh-balance-button:hover {
background: #1450a8;
transform: scale(1.1);
}

.menu-button {
display: none;
}

.dropdown-menu {
position: absolute;
top: 100%;
right: 0;
background: #1a1a2e;
border: 1px solid rgba(139, 69, 255, 0.3);
border-radius: 12px;
padding: 10px;
display: none;
flex-direction: column;
gap: 8px;
min-width: 150px;
z-index: 99999;
}

.dropdown-menu.show {
display: flex;
}

.dropdown-item {
background: rgba(139, 69, 255, 0.2);
color: white;
border: none;
padding: 8px 12px;
border-radius: 8px;
font-family: 'Orbitron', monospace;
font-weight: 600;
font-size: 0.8rem;
cursor: pointer;
transition: all 0.3s ease;
text-align: left;
text-transform: none;
}

.dropdown-item:hover {
background: rgba(139, 69, 255, 0.4);
transform: translateY(-1px);
}

/* Нижняя навигационная панель с затемнением неактивных элементов */
.bottom-navigation {
position: fixed;
bottom: 0;
left: 0;
right: 0;
background: #2a2a2a;
opacity: 0.90;
padding: 15px 0;
border-top: 1px solid rgba(139, 69, 255, 0.3);
z-index: 1000;
display: flex;
justify-content: center;
gap: 20px;
}

.nav-btn {
background: rgba(139, 69, 255, 0.2);
border: 1px solid rgba(139, 69, 255, 0.3);
border-radius: 15px;
padding: 15px;
cursor: pointer;
transition: all 0.3s ease;
display: flex;
align-items: center;
justify-content: center;
width: 60px;
height: 60px;
position: relative;
}

.nav-btn::before {
content: '';
position: absolute;
top: 0;
left: 0;
right: 0;
bottom: 0;
background: rgba(128, 128, 128, 0.6);
border-radius: 15px;
opacity: 0;
transition: opacity 0.3s ease;
}

.nav-btn:not(.active)::before {
opacity: 1;
}

.nav-btn:hover {
background: rgba(139, 69, 255, 0.3);
transform: translateY(-2px);
}

.nav-btn.active {
background: #8b45ff;
border-color: #8b45ff;
}

.nav-btn.active::before {
opacity: 0;
}

.nav-btn img {
width: 32px;
height: 32px;
object-fit: contain;
position: relative;
z-index: 2;
filter: brightness(1);
}

.nav-btn:not(.active) img {
filter: brightness(1) contrast(0.5) grayscale(0.8);
}

.nav-btn.active img {
filter: brightness(1.2);
}

.bottom-buttons {
display: none;
}

.bottom-btn {
background: #1a1a2e;
border: 1px solid rgba(139, 69, 255, 0.3);
border-radius: 12px;
color: white;
font-family: 'Orbitron', monospace;
font-weight: 700;
padding: 10px 20px;
cursor: pointer;
transition: all 0.3s ease;
z-index: 1001;
pointer-events: auto;
}

.bottom-btn:hover {
background: rgba(139, 69, 255, 0.2);
transform: translateY(-2px);
}

.content-slider {
position: relative;
overflow: hidden;
width: 100%;
}

.slider-container {
display: flex;
transition: transform 0.5s ease-in-out;
width: 500%;
}

.slide {
width: 20%;
flex-shrink: 0;
}

.main-content {
display: grid;
grid-template-columns: 320px 1fr 420px;
gap: 30px;
height: 720px;
overflow: visible;
}

.bonus-content {
padding: 20px;
background: #2a2a2a;
border-radius: 20px;
border: 1px solid rgba(150, 150, 150, 0.3);
margin: 0 auto;
max-width: 800px;
overflow-y: auto;
max-height: 80vh;
scrollbar-width: none;
-ms-overflow-style: none;
}

.bonus-content::-webkit-scrollbar {
display: none;
}

.cases-content {
padding: 20px;
background: #2a2a2a;
border-radius: 20px;
border: 1px solid rgba(128, 128, 128, 0.3);
margin: 0 auto;
max-width: 800px;
overflow-y: auto;
max-height: 80vh;
scrollbar-width: none;
-ms-overflow-style: none;
text-align: center;
}

.cases-content::-webkit-scrollbar {
display: none;
}

.cases-title {
text-align: center;
font-size: 2.5rem;
font-weight: 900;
color: white;
margin-bottom: 40px;
text-transform: none;
text-shadow: 3px 3px 6px rgba(0, 0, 0, 0.9), 0 0 15px rgba(128, 128, 128, 0.3);
}

.start-case {
background: rgba(128, 128, 128, 0.1);
border: 3px solid rgba(128, 128, 128, 0.5);
border-radius: 20px;
padding: 40px;
text-align: center;
transition: all 0.3s ease;
position: relative;
overflow: hidden;
max-width: 500px;
margin: 0 auto;
cursor: pointer;
}

.start-case:hover {
background: rgba(128, 128, 128, 0.2);
border-color: #808080;
box-shadow: 0 0 30px rgba(128, 128, 128, 0.4);
transform: translateY(-5px);
}

.case-image {
width: 150px;
height: 150px;
margin: 0 auto 20px;
object-fit: contain;
border-radius: 15px;
}

.case-name {
font-size: 2rem;
font-weight: 900;
color: #808080;
margin-bottom: 15px;
text-transform: none;
text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.8);
}

.case-price {
font-size: 1.8rem;
font-weight: 900;
color: white;
margin-bottom: 25px;
}

.case-buttons {
display: flex;
justify-content: center;
gap: 15px;
margin-bottom: 30px;
}

.case-open-btn {
background: #808080;
color: #000;
border: none;
padding: 15px 30px;
border-radius: 12px;
font-family: 'Orbitron', monospace;
font-weight: 700;
font-size: 1.1rem;
cursor: pointer;
transition: all 0.3s ease;
text-transform: none;
}

.case-open-btn:hover {
background: #999999;
transform: translateY(-2px);
box-shadow: 0 5px 15px rgba(128, 128, 128, 0.3);
}

.case-demo-btn {
background: rgba(255, 255, 255, 0.1);
color: white;
border: 2px solid rgba(255, 255, 255, 0.3);
padding: 13px 28px;
border-radius: 12px;
font-family: 'Orbitron', monospace;
font-weight: 600;
font-size: 1rem;
cursor: pointer;
transition: all 0.3s ease;
text-transform: none;
}

.case-demo-btn:hover {
background: rgba(255, 255, 255, 0.2);
transform: translateY(-2px);
box-shadow: 0 5px 15px rgba(255, 255, 255, 0.2);
}

.case-prizes {
text-align: left;
background: rgba(0, 0, 0, 0.3);
padding: 20px;
border-radius: 15px;
border: 1px solid rgba(128, 128, 128, 0.2);
display: none;
}

.case-prizes.show {
display: block;
}

.case-prizes-title {
font-size: 1.2rem;
color: #808080;
margin-bottom: 15px;
font-weight: 700;
text-align: center;
}

.prizes-grid {
display: grid;
grid-template-columns: 1fr 1fr;
gap: 15px;
}

.prize-item {
display: flex;
align-items: center;
gap: 10px;
padding: 12px;
background: rgba(128, 128, 128, 0.1);
border-radius: 12px;
font-size: 0.8rem;
color: white;
border: 1px solid rgba(128, 128, 128, 0.2);
position: relative;
}

.prize-icon {
width: 24px;
height: 24px;
border-radius: 4px;
object-fit: cover;
}

.prize-info {
display: flex;
flex-direction: column;
}

.prize-name {
font-weight: 600;
font-size: 0.75rem;
margin-bottom: 2px;
}

.prize-price {
color: #808080;
font-weight: 700;
font-size: 0.7rem;
}

.wallet-content {
padding: 0;
background: #0d0d0d;
border-radius: 20px;
margin: 0 auto;
max-width: 800px;
position: relative;
overflow: hidden;
min-height: 720px;
}

.wallet-header {
background: #0d0d0d;
padding: 24px;
border-bottom: 1px solid rgba(255, 255, 255, 0.1);
display: flex;
justify-content: space-between;
align-items: center;
position: relative;
z-index: 2;
}

.wallet-title {
font-size: 1.8rem;
font-weight: 900;
color: white;
margin: 0;
text-transform: none;
}

.refresh-button {
background: transparent;
color: #8b45ff;
border: none;
padding: 10px;
border-radius: 50%;
font-weight: 700;
font-size: 1.5rem;
cursor: pointer;
transition: all 0.3s ease;
display: flex;
align-items: center;
justify-content: center;
width: 40px;
height: 40px;
}

.refresh-button:hover {
color: white;
background: rgba(139, 69, 255, 0.2);
transform: rotate(180deg);
}

.wallet-overview {
padding: 30px 24px;
background: #0d0d0d;
border-bottom: 1px solid rgba(255, 255, 255, 0.1);
position: relative;
z-index: 2;
}

.total-balance {
text-align: center;
margin-bottom: 30px;
}

.total-balance h3 {
font-size: 1rem;
color: #888;
margin-bottom: 12px;
font-weight: 400;
text-transform: none;
}

.balance-display {
display: flex;
align-items: center;
justify-content: center;
gap: 12px;
margin-bottom: 8px;
flex-direction: column;
}

.balance-amount-large {
font-size: 3rem;
font-weight: 700;
color: #ffffff;
}

.balance-ton-secondary {
font-size: 1.2rem;
font-weight: 400;
color: #ffffff;
opacity: 0.7;
margin-top: -10px;
}

.wallet-actions {
display: flex;
gap: 15px;
justify-content: center;
flex-wrap: nowrap;
align-items: center;
}

.action-button {
background: rgba(139, 69, 255, 0.2);
color: #8b45ff;
border: 1px solid rgba(139, 69, 255, 0.3);
padding: 15px 20px;
border-radius: 12px;
font-weight: 600;
font-size: 0.9rem;
cursor: pointer;
transition: all 0.3s ease;
min-width: 90px;
display: flex;
flex-direction: column;
align-items: center;
gap: 8px;
}

.action-button:hover {
background: rgba(139, 69, 255, 0.3);
transform: translateY(-2px);
}

.action-button::before {
content: '';
width: 24px;
height: 24px;
background: #8b45ff;
border-radius: 50%;
display: flex;
align-items: center;
justify-content: center;
}

.action-button.deposit::before {
content: '↓';
color: white;
font-size: 16px;
font-weight: bold;
}

.action-button.withdraw::before {
content: '↑';
color: white;
font-size: 16px;
font-weight: bold;
}

.wallet-tabs {
display: none;
}

.assets-section {
padding: 0;
max-height: none;
overflow: visible;
position: relative;
z-index: 2;
background: #0d0d0d;
}

.assets-header {
padding: 20px 24px 10px;
background: #0d0d0d;
border-bottom: 1px solid rgba(255, 255, 255, 0.1);
display: flex;
justify-content: space-between;
align-items: center;
}

.assets-title {
color: #888;
font-size: 0.9rem;
font-weight: 400;
cursor: pointer;
transition: all 0.3s ease;
}

.assets-title:hover {
color: #8b45ff;
}

.show-balances-button {
background: #8b45ff;
color: white;
border: none;
padding: 8px 16px;
border-radius: 8px;
font-family: 'Orbitron', monospace;
font-weight: 600;
font-size: 0.8rem;
cursor: pointer;
transition: all 0.3s ease;
}

.show-balances-button:hover {
background: #7a3de6;
transform: translateY(-1px);
}

.asset-item {
display: flex;
align-items: center;
padding: 16px 24px;
border-bottom: 1px solid rgba(255, 255, 255, 0.05);
transition: all 0.3s ease;
background: #0d0d0d;
}

.asset-item:hover {
background: rgba(139, 69, 255, 0.05);
}

.asset-icon {
width: 40px;
height: 40px;
border-radius: 50%;
margin-right: 16px;
display: flex;
align-items: center;
justify-content: center;
overflow: hidden;
}

.asset-icon img {
width: 32px;
height: 32px;
object-fit: contain;
border-radius: 50%;
}

.asset-info {
flex: 1;
}

.asset-main {
display: flex;
align-items: center;
gap: 8px;
margin-bottom: 4px;
}

.asset-name {
font-weight: 600;
color: #ffffff;
font-size: 1rem;
}

.asset-price {
font-size: 0.85rem;
color: #888;
}

.asset-change {
font-size: 0.8rem;
font-weight: 600;
padding: 2px 6px;
border-radius: 4px;
}

.asset-change.positive {
color: #26a69a;
}

.asset-change.negative {
color: #ef5350;
}

.asset-balance {
text-align: right;
}

.asset-amount {
font-weight: 600;
color: #ffffff;
font-size: 1rem;
margin-bottom: 4px;
}

.asset-value {
font-size: 0.85rem;
color: #888;
}

.crypto-charts, .stocks-section {
display: none;
}

.stocks-section {
padding: 20px 24px;
position: relative;
z-index: 2;
}

.stocks-title {
font-size: 1.2rem;
color: #8b45ff;
margin-bottom: 20px;
font-weight: 700;
}

.stock-item {
display: flex;
align-items: center;
padding: 15px 0;
border-bottom: 2px solid rgba(139, 69, 255, 0.1);
}

.stock-info {
flex: 1;
margin-right: 16px;
}

.stock-symbol {
font-weight: 700;
color: #ffffff;
font-size: 1rem;
}

.stock-name {
font-size: 0.85rem;
color: #8b45ff;
margin-top: 4px;
opacity: 0.8;
}

.stock-price {
text-align: right;
margin-right: 16px;
}

.stock-price-value {
font-weight: 700;
color: #ffffff;
font-size: 1rem;
}

.stock-change {
text-align: right;
font-size: 0.85rem;
font-weight: 700;
padding: 6px 12px;
border-radius: 8px;
}

.stock-change.positive {
color: #00d4aa;
background: rgba(0, 212, 170, 0.2);
}

.stock-change.negative {
color: #ff6b6b;
background: rgba(255, 107, 107, 0.2);
}

.promo-section {
margin-top: 15px;
padding: 15px;
background: rgba(150, 150, 150, 0.1);
border-radius: 8px;
border: 1px solid rgba(150, 150, 150, 0.2);
}

.promo-title {
font-size: 0.9rem;
color: #888;
margin-bottom: 10px;
font-weight: 600;
text-transform: none;
}

.promo-input {
width: 100%;
padding: 10px;
background: rgba(0, 0, 0, 0.3);
border: 1px solid rgba(150, 150, 150, 0.3);
border-radius: 4px;
color: white;
font-family: 'Orbitron', monospace;
font-size: 0.8rem;
margin-bottom: 10px;
}

.promo-input:focus {
outline: none;
border-color: #888;
}

.promo-button {
background: #ff8640;
color: white;
border: none;
padding: 8px 16px;
border-radius: 4px;
font-weight: 600;
font-size: 0.8rem;
cursor: pointer;
transition: all 0.2s ease;
}

.promo-button:hover {
background: #e6732e;
}

.bonus-title {
text-align: center;
font-size: 2.5rem;
font-weight: 900;
color: white;
margin-bottom: 30px;
text-transform: none;
text-shadow: 3px 3px 6px rgba(0, 0, 0, 0.9), 0 0 15px rgba(150, 150, 150, 0.3);
}

.bonus-stages {
display: grid;
grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
gap: 20px;
margin-bottom: 40px;
}

.bonus-stage {
background: rgba(150, 150, 150, 0.1);
border: 2px solid rgba(150, 150, 150, 0.3);
border-radius: 15px;
padding: 20px;
text-align: center;
transition: all 0.3s ease;
opacity: 0.4;
position: relative;
overflow: hidden;
}

.bonus-stage.active {
background: rgba(150, 150, 150, 0.2);
border-color: #888;
opacity: 1;
box-shadow: 0 0 20px rgba(150, 150, 150, 0.3);
}

.bonus-stage.completed {
background: rgba(0, 255, 0, 0.2);
border-color: #00ff00;
opacity: 1;
}

.bonus-stage-number {
font-size: 1.5rem;
font-weight: 900;
color: white;
margin-bottom: 10px;
position: relative;
z-index: 2;
text-transform: none;
}

.bonus-stage.active .bonus-stage-number {
color: #888;
}

.bonus-stage.completed .bonus-stage-number {
color: #00ff00;
}

.bonus-percentage {
font-size: 2rem;
font-weight: 900;
margin-bottom: 10px;
position: relative;
z-index: 2;
color: white;
}

.bonus-stage.active .bonus-percentage {
color: #888;
}

.bonus-stage.completed .bonus-percentage {
color: #00ff00;
}

.bonus-description {
font-size: 0.9rem;
opacity: 0.8;
position: relative;
z-index: 2;
color: white;
text-transform: none;
}

.bonus-info {
background: rgba(150, 150, 150, 0.1);
border-radius: 15px;
padding: 20px;
margin-bottom: 30px;
border: 1px solid rgba(150, 150, 150, 0.3);
}

.bonus-progress {
text-align: center;
margin-bottom: 20px;
}

.bonus-progress-text {
font-size: 1.2rem;
color: white;
margin-bottom: 15px;
text-transform: none;
}

.bonus-progress-bar {
width: 100%;
height: 10px;
background: rgba(255, 255, 255, 0.1);
border-radius: 10px;
overflow: hidden;
margin-bottom: 15px;
}

.bonus-progress-fill {
height: 100%;
background: linear-gradient(90deg, #888, #aaa);
border-radius: 10px;
transition: width 0.3s ease;
}

.bonus-stats {
display: grid;
grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
gap: 20px;
text-align: center;
}

.bonus-stat {
background: rgba(150, 150, 150, 0.1);
padding: 15px;
border-radius: 15px;
border: 1px solid rgba(150, 150, 150, 0.3);
}

.bonus-stat-value {
font-size: 1.5rem;
font-weight: 900;
color: white;
}

.bonus-stat-label {
font-size: 0.9rem;
opacity: 0.8;
margin-top: 5px;
color: white;
text-transform: none;
}

.pepe-contest {
background: rgba(150, 150, 150, 0.1);
border-radius: 15px;
padding: 30px;
margin-bottom: 30px;
display: flex;
align-items: center;
gap: 20px;
border: 2px solid rgba(150, 150, 150, 0.3);
}

.pepe-contest-image {
width: 120px;
height: 120px;
border-radius: 15px;
object-fit: cover;
}

.pepe-contest-content {
flex: 1;
text-align: center;
}

.pepe-contest-title {
font-size: 2rem;
font-weight: 900;
color: white;
margin-bottom: 20px;
text-transform: none;
text-shadow: 3px 3px 6px rgba(0, 0, 0, 0.9), 0 0 15px rgba(150, 150, 150, 0.3);
}

.pepe-contest-button {
background: #ff8640;
color: white;
border: none;
padding: 15px 30px;
border-radius: 12px;
font-family: 'Orbitron', monospace;
font-weight: 700;
font-size: 1.1rem;
cursor: pointer;
transition: all 0.3s ease;
text-transform: none;
}

.pepe-contest-button:hover {
background: #e6732e;
transform: translateY(-2px);
}

.players-panel {
background: #171717;
border-radius: 15px;
border: 1px solid rgba(139, 69, 255, 0.3);
padding: 20px;
max-height: 720px;
overflow: hidden;
position: relative;
}

.players-controls {
display: none;
}

.players-panel::after {
content: '';
position: absolute;
bottom: 0;
left: 0;
right: 0;
height: 60px;
background: linear-gradient(transparent, #171717);
pointer-events: none;
z-index: 10;
}

.players-title {
font-weight: 700;
margin-bottom: 20px;
color: white;
text-align: center;
font-size: 1.2rem;
text-transform: none;
}

/* НОВЫЙ ДИЗАЙН ДЛЯ ИГРОКОВ */
.player-item {
display: flex;
align-items: center;
gap: 15px;
padding: 12px 15px;
margin-bottom: 8px;
background: rgba(139, 69, 255, 0.1);
border-radius: 12px;
border: 1px solid rgba(139, 69, 255, 0.2);
font-size: 0.9rem;
position: relative;
transition: all 0.3s ease;
opacity: 0;
transform: translateY(20px);
animation: playerSlideIn 0.5s ease-out forwards;
min-height: 60px;
}

@keyframes playerSlideIn {
to {
opacity: 1;
transform: translateY(0);
}
}

.player-item.user {
background: rgba(139, 69, 255, 0.3);
border: 2px solid #8b45ff;
order: -1;
margin-bottom: 10px;
}

.player-item.lost {
background: rgba(255, 68, 68, 0.2);
border-color: #ff4444;
color: #ff9999;
}

.player-item.won {
background: rgba(28, 191, 25, 0.2);
border-color: #1cbf19;
position: relative;
}

/* Аватарка с первой буквой ника */
.player-avatar {
width: 40px;
height: 40px;
border-radius: 50%;
background: linear-gradient(135deg, #8b45ff, #6b35d9);
display: flex;
align-items: center;
justify-content: center;
font-weight: 900;
font-size: 1.2rem;
color: white;
flex-shrink: 0;
}

/* Информация об игроке */
.player-details {
flex: 1;
display: flex;
justify-content: space-between;
align-items: center;
}

.player-left {
display: flex;
flex-direction: column;
gap: 2px;
}

.player-name {
font-size: 0.9rem;
font-weight: 700;
color: white;
text-transform: none;
}

.player-bet-amount {
font-size: 0.8rem;
color: rgba(255, 255, 255, 0.7);
display: flex;
align-items: center;
gap: 4px;
}

.player-center {
display: flex;
align-items: center;
gap: 8px;
}

.player-multiplier {
font-size: 0.85rem;
color: white;
font-weight: 700;
padding: 4px 8px;
border-radius: 8px;
background: rgba(255, 255, 255, 0.1);
transition: all 0.3s ease;
}

.player-multiplier.green {
background: rgba(28, 191, 25, 0.3);
color: #1cbf19;
}

.player-right {
display: flex;
flex-direction: column;
align-items: flex-end;
gap: 2px;
position: relative;
}

.player-win-amount {
font-size: 0.85rem;
color: white;
font-weight: 600;
}

.player-gift-gif {
position: absolute;
top: -5px;
right: 0;
width: 24px;
height: 24px;
border-radius: 4px;
object-fit: cover;
opacity: 1;
transition: opacity 0.5s ease-in-out;
z-index: 5;
}

.current-win-amount {
font-size: 0.8rem;
color: #1cbf19;
font-weight: 700;
margin-top: 5px;
}

.bet-info-display {
position: fixed;
bottom: 20px;
left: 50%;
transform: translateX(-50%);
font-size: 0.8rem;
color: rgba(255, 255, 255, 0.5);
z-index: 100;
text-align: center;
pointer-events: none;
text-transform: none;
}

.game-area {
position: relative;
overflow: visible;
}

/* УЛУЧШЕННАЯ СЕТКА С ЧЕРНЫМ ФОНОМ И БЕЛЫМИ КОНТУРАМИ - ИЗМЕНЕНО ДЛЯ 32 КЛЕТОК */
.game-canvas {
background: #000000;
border-radius: 25px;
border: 2px solid rgba(240, 240, 240, 0.3);
position: relative;
overflow: hidden;
display: flex;
align-items: center;
justify-content: center;
height: 720px;
width: 100%;
/* НОВЫЙ РАЗМЕР СЕТКИ ДЛЯ 32 КЛЕТОК (25px вместо 12.5px) */
--grid-size: 25px;
background-image: 
  linear-gradient(rgba(255, 255, 255, 0.3) 1px, transparent 1px),
  linear-gradient(90deg, rgba(255, 255, 255, 0.3) 1px, transparent 1px),
  linear-gradient(rgba(255, 255, 255, 0.2) 1px, transparent 1px),
  linear-gradient(90deg, rgba(255, 255, 255, 0.2) 1px, transparent 1px);
background-size: 
  var(--grid-size) var(--grid-size), 
  var(--grid-size) var(--grid-size),
  calc(var(--grid-size) * 0.5) calc(var(--grid-size) * 0.5),
  calc(var(--grid-size) * 0.5) calc(var(--grid-size) * 0.5);
}

/* НОВЫЕ ВЫИГРЫШИ ДРУГИХ ИГРОКОВ ПОД ИГРОЙ */
.recent-wins-panel {
background: #171717;
border-radius: 15px;
border: 1px solid rgba(139, 69, 255, 0.3);
padding: 20px;
margin-top: 20px;
max-height: 200px;
overflow: hidden;
position: relative;
}

.recent-wins-title {
font-weight: 700;
margin-bottom: 15px;
color: white;
text-align: center;
font-size: 1.1rem;
text-transform: none;
}

.wins-list {
display: flex;
flex-direction: column;
gap: 10px;
}

.win-item {
display: flex;
align-items: center;
gap: 15px;
padding: 10px 15px;
background: rgba(139, 69, 255, 0.1);
border-radius: 10px;
border: 1px solid rgba(139, 69, 255, 0.2);
animation: winSlideIn 0.5s ease-out;
}

.win-item-rocket {
width: 32px;
height: 32px;
}

.win-item-details {
flex: 1;
}

.win-item-player {
font-size: 0.85rem;
font-weight: 600;
color: white;
margin-bottom: 2px;
}

.win-item-amount {
font-size: 0.9rem;
font-weight: 700;
color: #1cbf19;
display: flex;
align-items: center;
gap: 4px;
}

.win-item-multiplier {
font-size: 0.8rem;
color: rgba(255, 255, 255, 0.7);
}

.recent-wins-panel::after {
content: '';
position: absolute;
bottom: 0;
left: 0;
right: 0;
height: 30px;
background: linear-gradient(transparent, #171717);
pointer-events: none;
z-index: 10;
}

/* ОБНОВЛЕННЫЕ КНОПКИ УПРАВЛЕНИЯ С НИЖНИМ z-index */
.game-control-buttons {
position: absolute;
bottom: 20px;
left: 20px;
right: 20px;
display: flex;
gap: 15px;
z-index: 10;
}

.game-control-button {
border: none;
border-radius: 12px;
font-family: 'Orbitron', monospace;
font-weight: 600;
font-size: 1rem;
cursor: pointer;
transition: all 0.3s ease;
text-transform: none;
display: none;
}

/* КНОПКА ОТМЕНИТЬ - ЦВЕТ #246dff */
.game-control-button.cancel-bet-button {
background: #246dff;
color: white;
border: 1px solid #246dff;
font-weight: 700;
flex: 1;
padding: 16px;
font-size: 1.2rem;
border-radius: 15px;
box-shadow: 0 4px 15px rgba(36, 109, 255, 0.3);
}

.game-control-button.cancel-bet-button:hover {
background: #1e5dd6;
transform: translateY(-2px);
box-shadow: 0 6px 20px rgba(36, 109, 255, 0.4);
}

/* КНОПКА ПОСТАВИТЬ - ЦВЕТ #246dff */
.game-control-button.place-bet-button {
background: #246dff;
color: white;
border: 1px solid #246dff;
font-weight: 700;
flex: 1;
padding: 16px;
font-size: 1.2rem;
border-radius: 15px;
box-shadow: 0 4px 15px rgba(36, 109, 255, 0.3);
}

.game-control-button.place-bet-button:hover {
background: #1e5dd6;
transform: translateY(-2px);
box-shadow: 0 6px 20px rgba(36, 109, 255, 0.4);
}

/* КНОПКА ЗАБРАТЬ - ЦВЕТ #246dff */
.game-control-button.cashout-button {
background: #246dff;
color: white;
border: 1px solid #246dff;
font-weight: 700;
flex: 1;
padding: 16px;
font-size: 1.2rem;
border-radius: 15px;
box-shadow: 0 4px 15px rgba(36, 109, 255, 0.3);
}

.game-control-button.cashout-button:hover {
background: #1e5dd6;
transform: translateY(-2px);
box-shadow: 0 6px 20px rgba(36, 109, 255, 0.4);
}

.game-control-button.show {
display: block;
}

.registration-info {
position: absolute;
bottom: 10px;
left: 50%;
transform: translateX(-50%);
font-size: 0.7rem;
color: rgba(255, 255, 255, 0.4);
text-align: center;
z-index: 24;
max-width: 90%;
line-height: 1.2;
text-transform: none;
pointer-events: none;
}

/* УЛУЧШЕННАЯ ЛИНЕЙКА СНИЗУ С ПОЛОСКАМИ РАЗНЫХ РАЗМЕРОВ И ЦВЕТОВ - НА ЗАДНЕМ ПЛАНЕ */
.rocket-speed-indicator {
position: absolute;
bottom: 0;
left: 0;
width: 100%;
height: 30px;
background: rgba(0, 0, 0, 0.6);
border-radius: 0 0 25px 25px;
overflow: hidden;
z-index: 5;
opacity: 0;
transition: opacity 1s ease-in-out;
}

.rocket-speed-indicator.visible {
opacity: 1;
}

.speed-lines {
position: absolute;
top: 0;
left: 0;
width: 200%;
height: 100%;
background-image: repeating-linear-gradient(
  90deg,
  transparent,
  transparent 10px,
  #080f04 10px,
  #080f04 12px,
  transparent 12px,
  transparent 22px,
  #080f04 22px,
  #080f04 24px,
  transparent 24px,
  transparent 34px,
  #080f04 34px,
  #080f04 36px,
  transparent 36px,
  transparent 46px,
  #080f04 46px,
  #080f04 48px,
  transparent 48px,
  transparent 58px,
  #68c23e 58px,
  #68c23e 73px,
  transparent 73px,
  transparent 83px,
  #080f04 83px,
  #080f04 85px,
  transparent 85px,
  transparent 95px,
  #080f04 95px,
  #080f04 97px,
  transparent 97px,
  transparent 107px,
  #080f04 107px,
  #080f04 109px,
  transparent 109px,
  transparent 119px,
  #080f04 119px,
  #080f04 121px,
  transparent 121px,
  transparent 131px,
  #68c23e 131px,
  #68c23e 146px
);
animation: speedLinesMove 3s linear infinite;
opacity: 0.8;
}

@keyframes speedLinesMove {
0% { transform: translateX(0); }
100% { transform: translateX(-50%); }
}

/* УЛУЧШЕННАЯ ВЕРТИКАЛЬНАЯ ЛИНЕЙКА СЛЕВА С ПОЛОСКАМИ - НА ЗАДНЕМ ПЛАНЕ */
.rocket-speed-indicator-vertical {
position: absolute;
top: 0;
left: 0;
width: 30px;
height: 100%;
background: rgba(0, 0, 0, 0.6);
border-radius: 25px 0 0 25px;
overflow: hidden;
z-index: 5;
opacity: 0;
transition: opacity 1s ease-in-out;
}

.rocket-speed-indicator-vertical.visible {
opacity: 1;
}

.speed-lines-vertical {
position: absolute;
top: 0;
left: 0;
width: 100%;
height: 200%;
background-image: repeating-linear-gradient(
  0deg,
  transparent,
  transparent 10px,
  #080f04 10px,
  #080f04 12px,
  transparent 12px,
  transparent 22px,
  #080f04 22px,
  #080f04 24px,
  transparent 24px,
  transparent 34px,
  #080f04 34px,
  #080f04 36px,
  transparent 36px,
  transparent 46px,
  #080f04 46px,
  #080f04 48px,
  transparent 48px,
  transparent 58px,
  #68c23e 58px,
  #68c23e 73px,
  transparent 73px,
  transparent 83px,
  #080f04 83px,
  #080f04 85px,
  transparent 85px,
  transparent 95px,
  #080f04 95px,
  #080f04 97px,
  transparent 97px,
  transparent 107px,
  #080f04 107px,
  #080f04 109px,
  transparent 109px,
  transparent 119px,
  #080f04 119px,
  #080f04 121px,
  transparent 121px,
  transparent 131px,
  #68c23e 131px,
  #68c23e 146px
);
animation: speedLinesVerticalMove 4s linear infinite;
opacity: 0.8;
}

@keyframes speedLinesVerticalMove {
0% { transform: translateY(0); }
100% { transform: translateY(-50%); }
}

.game-canvas::before {
content: '';
position: absolute;
top: 0;
left: 0;
right: 0;
bottom: 0;
background: radial-gradient(circle at 20% 80%, rgba(139, 69, 255, 0.05) 0%, transparent 50%), radial-gradient(circle at 80% 20%, rgba(139, 69, 255, 0.05) 0%, transparent 50%);
}

.multiplier-display {
position: absolute;
top: 50px;
left: 50%;
transform: translateX(-50%);
font-size: 4rem;
font-weight: 900;
color: white;
z-index: 10;
transition: all 0.1s ease;
}

.multiplier-display.red {
color: #ff4444;
}

/* УБРАНО СООБЩЕНИЕ О ВЫИГРЫШЕ ВВЕРХУ */
.win-display {
display: none !important;
}

.trading-chart {
position: absolute;
bottom: 30px;
left: 0;
width: 100%;
height: calc(100% - 30px);
z-index: 5;
}

.chart-line {
stroke: #96ff54;
stroke-width: 8;
fill: none;
filter: drop-shadow(0 0 10px #96ff54);
transition: stroke 0.3s ease;
}

.chart-line.crashed {
stroke: #ff4444;
filter: drop-shadow(0 0 10px #ff4444);
}

.chart-area {
fill: url(#gradient);
opacity: 0.3;
}

.game-gif {
position: absolute;
width: 120px;
height: 120px;
z-index: 8;
opacity: 0;
transition: opacity 0.3s ease;
pointer-events: none;
border-radius: 15px;
}

.game-gif.show {
opacity: 1;
}

.countdown-overlay {
position: absolute;
top: 0;
left: 0;
right: 0;
bottom: 0;
background: rgba(0, 0, 0, 0.9);
display: flex;
align-items: center;
justify-content: center;
z-index: 20;
border-radius: 20px;
}

.countdown-number {
font-size: 8rem;
font-weight: 900;
color: white;
animation: heartbeat 1s ease-in-out;
}

@keyframes heartbeat {
0% { transform: scale(0.8); opacity: 0.5; }
50% { transform: scale(1.2); opacity: 1; }
100% { transform: scale(1); opacity: 1; }
}

.game-crashed {
position: absolute;
top: 50%;
left: 50%;
transform: translate(-50%, -50%);
font-size: 3rem;
font-weight: 900;
z-index: 15;
animation: crashPulse 0.5s ease-in-out;
text-transform: none;
color: #ff4444;
}

@keyframes crashPulse {
0% { transform: translate(-50%, -50%) scale(0); }
50% { transform: translate(-50%, -50%) scale(1.2); }
100% { transform: translate(-50%, -50%) scale(1); }
}

.betting-panel {
background: #171717;
border-radius: 15px;
border: 1px solid rgba(139, 69, 255, 0.3);
padding: 30px;
}

.game-stats {
display: grid;
grid-template-columns: repeat(2, 1fr);
gap: 20px;
margin-bottom: 30px;
}

.stat-card {
background: rgba(139, 69, 255, 0.1);
padding: 20px;
border-radius: 12px;
border: 1px solid rgba(139, 69, 255, 0.3);
text-align: center;
}

.stat-value {
font-size: 2rem;
font-weight: 900;
color: white;
}

.stat-label {
margin-top: 5px;
font-size: 0.9rem;
color: white;
opacity: 0.8;
text-transform: none;
}

.history-panel {
background: #171717;
border-radius: 12px;
border: 1px solid rgba(150, 150, 150, 0.3);
padding: 20px;
}

.history-title {
font-weight: 700;
margin-bottom: 15px;
color: white;
text-transform: none;
}

.history-list {
display: flex;
flex-wrap: wrap;
gap: 10px;
}

.history-item {
padding: 8px 15px;
border-radius: 20px;
font-weight: 700;
font-size: 0.9rem;
opacity: 0.6;
filter: brightness(0.7);
}

.history-item.win {
background: rgba(139, 69, 255, 0.2);
color: rgba(255, 255, 255, 0.7);
}

.history-item.lose.red-multiplier {
background: rgba(255, 68, 68, 0.4);
color: rgba(255, 255, 255, 0.7);
}

.history-item.lose.yellow-multiplier {
background: rgba(255, 215, 0, 0.4);
color: rgba(0, 0, 0, 0.7);
}

.history-item.lose.orange-multiplier {
background: rgba(255, 165, 0, 0.4);
color: rgba(255, 255, 255, 0.7);
}

.history-item.lose.green-multiplier {
background: rgba(0, 212, 170, 0.4);
color: rgba(255, 255, 255, 0.7);
}

.game-history-mini {
position: absolute;
top: 20px;
right: 20px;
display: flex;
gap: 10px;
z-index: 15;
}

.mini-result {
width: 60px;
height: 40px;
border-radius: 15px;
display: flex;
align-items: center;
justify-content: center;
font-weight: 900;
font-size: 0.9rem;
border: 2px solid;
animation: slideIn 0.5s ease-out;
opacity: 0.6;
filter: brightness(0.7);
}

.mini-result.red {
background: rgba(255, 68, 68, 0.6);
color: rgba(255, 255, 255, 0.8);
border-color: rgba(255, 68, 68, 0.6);
}

.mini-result.yellow {
background: rgba(255, 215, 0, 0.6);
color: rgba(0, 0, 0, 0.8);
border-color: rgba(255, 215, 0, 0.6);
}

.mini-result.orange {
background: rgba(255, 165, 0, 0.6);
color: rgba(255, 255, 255, 0.8);
border-color: rgba(255, 165, 0, 0.6);
}

.mini-result.green {
background: rgba(0, 212, 170, 0.6);
color: rgba(255, 255, 255, 0.8);
border-color: rgba(0, 212, 170, 0.6);
}

.mini-result.pending {
background: rgba(139, 69, 255, 0.3);
color: #8b45ff;
border-color: #8b45ff;
animation: pulse 1s infinite;
}

@keyframes slideIn {
0% { transform: translateX(100px); opacity: 0; }
100% { transform: translateX(0); opacity: 0.6; }
}

@keyframes pulse {
0% { opacity: 0.5; }
50% { opacity: 1; }
100% { opacity: 0.5; }
}

.support-content {
padding: 20px;
background: #2a2a2a;
border-radius: 20px;
border: 1px solid rgba(150, 150, 150, 0.3);
margin: 0 auto;
max-width: 800px;
overflow-y: auto;
max-height: 80vh;
scrollbar-width: none;
-ms-overflow-style: none;
}

.support-content::-webkit-scrollbar {
display: none;
}

.support-content-title {
text-align: center;
font-size: 2.5rem;
font-weight: 900;
color: white;
margin-bottom: 40px;
text-transform: none;
text-shadow: 3px 3px 6px rgba(0, 0, 0, 0.9), 0 0 15px rgba(150, 150, 150, 0.3);
}

.support-channels {
display: grid;
grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
gap: 20px;
margin-bottom: 40px;
}

.support-channel {
background: rgba(150, 150, 150, 0.1);
border: 2px solid rgba(150, 150, 150, 0.3);
border-radius: 15px;
padding: 30px;
text-align: center;
transition: all 0.3s ease;
cursor: pointer;
}

.support-channel:hover {
background: rgba(150, 150, 150, 0.2);
transform: translateY(-5px);
box-shadow: 0 10px 25px rgba(150, 150, 150, 0.2);
}

.support-channel-icon {
font-size: 3rem;
margin-bottom: 15px;
display: block;
}

.support-channel-title {
font-size: 1.5rem;
font-weight: 700;
color: white;
margin-bottom: 10px;
}

.support-channel-desc {
color: rgba(255, 255, 255, 0.8);
font-size: 1rem;
line-height: 1.4;
}

/* УБИРАЕМ ПАНЕЛЬ С УВЕДОМЛЕНИЯМИ СВЕРХУ */
.wins-panel {
display: none !important;
}

/* НОВОЕ BOTTOM SHEET МОДАЛЬНЫЕ ОКНА */
.bottom-sheet-overlay {
position: fixed;
top: 0;
left: 0;
width: 100%;
height: 100%;
background: rgba(0, 0, 0, 0.45);
z-index: 10000;
opacity: 0;
visibility: hidden;
transition: all 0.3s ease;
}

.bottom-sheet-overlay.show {
opacity: 1;
visibility: visible;
}

.bottom-sheet {
position: fixed;
bottom: 0;
left: 0;
right: 0;
background: #2a2a2a;
border-radius: 25px 25px 0 0;
padding: 30px 20px 40px;
max-height: 70vh;
overflow-y: auto;
transform: translateY(100%);
transition: transform 0.3s ease;
z-index: 10001;
}

.bottom-sheet-overlay.show .bottom-sheet {
transform: translateY(0);
}

.bottom-sheet-header {
position: relative;
text-align: center;
margin-bottom: 30px;
padding-top: 10px;
}

.bottom-sheet-header::before {
content: '';
position: absolute;
top: 0;
left: 50%;
transform: translateX(-50%);
width: 40px;
height: 4px;
background: rgba(255, 255, 255, 0.3);
border-radius: 2px;
}

.bottom-sheet h2 {
color: #246dff;
margin-bottom: 25px;
font-size: 1.8rem;
font-weight: 700;
text-transform: none;
}

.modal-overlay {
position: fixed;
top: 0;
left: 0;
width: 100%;
height: 100%;
background: rgba(0, 0, 0, 0.8);
display: flex;
align-items: center;
justify-content: center;
z-index: 1000;
opacity: 0;
visibility: hidden;
transition: all 0.3s ease;
}

.modal-overlay.show {
opacity: 1;
visibility: visible;
}

.modal {
background: #2a2a2a;
border: 2px solid rgba(150, 150, 150, 0.5);
border-radius: 20px;
padding: 30px;
max-width: 450px;
width: 90%;
text-align: center;
transform: scale(0.8);
transition: transform 0.3s ease;
}

.modal-overlay.show .modal {
transform: scale(1);
}

.modal h2 {
color: white;
margin-bottom: 25px;
font-size: 1.8rem;
text-transform: none;
}

.modal-input {
width: 100%;
padding: 15px;
background: rgba(0, 0, 0, 0.5);
border: 2px solid rgba(150, 150, 150, 0.3);
border-radius: 12px;
color: white;
font-family: 'Orbitron', monospace;
font-size: 1.2rem;
font-weight: 600;
text-align: center;
margin-bottom: 20px;
}

.modal-input:focus {
outline: none;
border-color: #888;
}

.modal-buttons {
display: flex;
gap: 15px;
justify-content: center;
margin-top: 25px;
}

.modal-btn {
padding: 12px 25px;
border: none;
border-radius: 12px;
font-family: 'Orbitron', monospace;
font-weight: 700;
font-size: 1rem;
cursor: pointer;
transition: all 0.3s ease;
text-transform: none;
min-width: 120px;
}

.modal-btn.confirm {
background: #246dff;
color: white;
}

.modal-btn.cancel {
background: rgba(150, 150, 150, 0.2);
color: #888;
border: 1px solid rgba(150, 150, 150, 0.3);
}

.modal-btn:hover {
transform: translateY(-2px);
}

.deposit-buttons {
display: grid;
grid-template-columns: 1fr 1fr;
gap: 15px;
margin-bottom: 20px;
}

.deposit-btn {
padding: 15px;
background: rgba(150, 150, 150, 0.2);
border: 1px solid rgba(150, 150, 150, 0.3);
border-radius: 12px;
color: white;
cursor: pointer;
font-family: 'Orbitron', monospace;
font-weight: 600;
font-size: 1rem;
transition: all 0.3s ease;
display: flex;
align-items: center;
justify-content: center;
gap: 8px;
text-transform: none;
}

.deposit-btn:hover {
background: rgba(150, 150, 150, 0.3);
transform: translateY(-2px);
}

.cryptopay-btn {
background: #1fbcff;
color: white;
border: none;
padding: 12px 20px;
border-radius: 12px;
font-family: 'Orbitron', monospace;
font-weight: 700;
font-size: 0.9rem;
cursor: pointer;
transition: all 0.3s ease;
margin-bottom: 15px;
text-transform: none;
}

.cryptopay-btn:hover {
background: #1ca8e6;
transform: translateY(-2px);
}

.ton-logo-rounded {
border-radius: 50%;
}

.qr-container {
text-align: center;
margin-bottom: 20px;
}

.qr-image {
max-width: 200px;
margin-bottom: 15px;
}

.copy-text {
background: rgba(0, 0, 0, 0.5);
padding: 12px;
border-radius: 12px;
font-family: monospace;
font-size: 11px;
word-break: break-all;
margin-bottom: 10px;
cursor: pointer;
transition: background 0.3s ease;
}

.copy-text:hover {
background: rgba(0, 0, 0, 0.7);
}

.timer-display {
font-size: 1.3rem;
color: #ff4444;
font-weight: 900;
margin-bottom: 15px;
}

.deposit-status {
text-align: center;
padding: 15px;
background: rgba(150, 150, 150, 0.1);
border-radius: 12px;
margin-bottom: 15px;
}

.account-modal {
max-width: 600px;
}

.account-info {
background: rgba(150, 150, 150, 0.1);
padding: 20px;
border-radius: 15px;
margin-bottom: 25px;
}

.account-balance {
font-size: 2.2rem;
color: white;
font-weight: 900;
margin-bottom: 20px;
}

.account-buttons {
display: grid;
grid-template-columns: 1fr 1fr;
gap: 15px;
margin-bottom: 25px;
}

.last-bets {
text-align: left;
}

.last-bets h3 {
color: white;
margin-bottom: 15px;
text-transform: none;
}

.bet-item {
background: rgba(150, 150, 150, 0.1);
padding: 12px;
border-radius: 12px;
margin-bottom: 10px;
display: flex;
justify-content: space-between;
align-items: center;
color: white;
}

.bet-result.win {
color: #1cbf19;
}

.bet-result.lose {
color: #ff4444;
}

/* УЛУЧШЕННЫЙ ИНТЕРФЕЙС СТАВОК В BOTTOM SHEET */
.bet-amount-input {
width: 100%;
padding: 20px 15px;
background: rgba(0, 0, 0, 0.5);
border: 3px solid rgba(36, 109, 255, 0.3);
border-radius: 20px;
color: #ffffff;
font-family: 'Orbitron', monospace;
font-size: 2rem;
font-weight: 700;
text-align: center;
margin-bottom: 25px;
transition: all 0.3s ease;
}

.bet-amount-input:focus {
outline: none;
background: rgba(0, 0, 0, 0.7);
border-color: #246dff;
transform: scale(1.02);
box-shadow: 0 0 20px rgba(36, 109, 255, 0.3);
}

.currency-selector {
display: flex;
justify-content: center;
gap: 15px;
margin-bottom: 30px;
}

.currency-btn {
padding: 12px 25px;
background: rgba(36, 109, 255, 0.2);
border: 2px solid rgba(36, 109, 255, 0.3);
border-radius: 15px;
color: white;
cursor: pointer;
font-family: 'Orbitron', monospace;
font-weight: 600;
transition: all 0.3s ease;
display: flex;
align-items: center;
gap: 10px;
font-size: 1rem;
}

.currency-btn.active {
background: rgba(36, 109, 255, 0.5);
border-color: #246dff;
box-shadow: 0 0 15px rgba(36, 109, 255, 0.3);
}

.currency-btn:hover {
background: rgba(36, 109, 255, 0.3);
transform: translateY(-2px);
}

.quick-bet-grid {
display: grid;
grid-template-columns: repeat(3, 1fr);
gap: 15px;
margin-bottom: 30px;
}

.quick-bet {
padding: 15px 12px;
background: rgba(36, 109, 255, 0.2);
border: 2px solid rgba(36, 109, 255, 0.3);
border-radius: 15px;
color: white;
cursor: pointer;
font-family: 'Orbitron', monospace;
font-weight: 600;
font-size: 1rem;
transition: all 0.3s ease;
display: flex;
align-items: center;
justify-content: center;
gap: 8px;
}

.quick-bet:hover {
background: rgba(36, 109, 255, 0.4);
transform: translateY(-2px);
box-shadow: 0 5px 15px rgba(36, 109, 255, 0.3);
}

.quick-bet.special {
background: rgba(255, 165, 0, 0.2);
border-color: rgba(255, 165, 0, 0.4);
color: #ffa500;
font-weight: 700;
}

.quick-bet.special:hover {
background: rgba(255, 165, 0, 0.3);
box-shadow: 0 5px 15px rgba(255, 165, 0, 0.3);
}

.auto-cashout-container {
background: rgba(0, 0, 0, 0.3);
border: 1px solid rgba(36, 109, 255, 0.3);
border-radius: 15px;
padding: 20px;
margin-bottom: 30px;
}

.auto-cashout-header {
display: flex;
justify-content: space-between;
align-items: center;
margin-bottom: 15px;
}

.auto-cashout-label {
color: white;
font-weight: 600;
font-size: 1rem;
}

.auto-cashout-toggle {
position: relative;
width: 60px;
height: 30px;
background: rgba(255, 255, 255, 0.2);
border-radius: 15px;
cursor: pointer;
transition: background 0.3s ease;
}

.auto-cashout-toggle.active {
background: #246dff;
}

.auto-cashout-toggle::after {
content: '';
position: absolute;
top: 3px;
left: 3px;
width: 24px;
height: 24px;
background: white;
border-radius: 50%;
transition: transform 0.3s ease;
}

.auto-cashout-toggle.active::after {
transform: translateX(30px);
}

.auto-cashout-input {
width: 100%;
padding: 15px;
background: rgba(0, 0, 0, 0.5);
border: 2px solid rgba(36, 109, 255, 0.3);
border-radius: 12px;
color: white;
font-family: 'Orbitron', monospace;
font-size: 1.2rem;
text-align: center;
}

.auto-cashout-input:focus {
outline: none;
border-color: #246dff;
}

/* НОВАЯ BOTTOM SHEET ДЛЯ ВЫИГРЫШЕЙ ПОСЕРЕДИНЕ И ВНИЗУ */
.win-modal {
background: #2a2a2a;
border: 2px solid rgba(150, 150, 150, 0.5);
border-radius: 25px 25px 0 0;
padding: 40px;
max-width: 400px;
width: 100%;
text-align: center;
transform: translateY(100%);
transition: transform 0.3s ease;
position: fixed;
bottom: 0;
left: 50%;
margin-left: -200px;
}

.win-modal::before {
content: '';
position: absolute;
top: -80px;
left: 50%;
transform: translateX(-50%);
width: 120px;
height: 120px;
background: rgba(150, 150, 150, 0.3);
border-radius: 15px;
background-image: url('https://podarki-tg.com/wp-content/uploads/2025/06/image-520.png');
background-size: contain;
background-repeat: no-repeat;
background-position: center;
z-index: -1;
border: 2px solid rgba(150, 150, 150, 0.5);
}

.win-modal-overlay.show .win-modal {
transform: translateY(0);
}

.win-modal h2 {
color: white;
margin-bottom: 25px;
font-size: 2.2rem;
text-transform: none;
}

.win-amount {
font-size: 3.5rem;
font-weight: 900;
color: #888;
margin-bottom: 25px;
display: flex;
align-items: center;
justify-content: center;
gap: 10px;
}

.win-multiplier {
font-size: 1.3rem;
color: white;
margin-bottom: 25px;
text-transform: none;
}

.withdraw-modal {
background: #2a2a2a;
border: 2px solid rgba(150, 150, 150, 0.5);
border-radius: 20px;
padding: 40px;
max-width: 550px;
width: 95%;
text-align: center;
transform: scale(0.8);
transition: transform 0.3s ease;
}

.withdraw-modal-overlay.show .withdraw-modal {
transform: scale(1);
}

.withdraw-modal h2 {
color: #888;
margin-bottom: 30px;
font-size: 2rem;
font-weight: 900;
text-transform: none;
}

.withdraw-input {
width: 100%;
padding: 18px 15px;
background: rgba(0, 0, 0, 0.5);
border: 2px solid rgba(150, 150, 150, 0.3);
border-radius: 15px;
color: #ffffff;
font-family: 'Orbitron', monospace;
font-size: 1.1rem;
font-weight: 600;
text-align: center;
margin-bottom: 20px;
transition: all 0.3s ease;
}

.withdraw-input:focus {
outline: none;
background: rgba(0, 0, 0, 0.7);
border-color: #888;
}

.withdraw-info {
background: rgba(150, 150, 150, 0.1);
padding: 20px;
border-radius: 15px;
margin-bottom: 25px;
color: #ffffff;
font-size: 0.9rem;
text-transform: none;
border: 1px solid rgba(150, 150, 150, 0.3);
line-height: 1.5;
}

.color-picker-modal {
background: #2a2a2a;
border: 2px solid rgba(150, 150, 150, 0.5);
border-radius: 20px;
padding: 30px;
max-width: 350px;
width: 90%;
text-align: center;
transform: scale(0.8);
transition: transform 0.3s ease;
}

.color-picker-modal-overlay.show .color-picker-modal {
transform: scale(1);
}

.color-picker {
width: 100%;
height: 50px;
border: 2px solid rgba(150, 150, 150, 0.3);
border-radius: 12px;
margin-bottom: 15px;
cursor: pointer;
}

.color-preview {
width: 100%;
height: 35px;
background: white;
border-radius: 12px;
margin-bottom: 15px;
display: flex;
align-items: center;
justify-content: center;
font-weight: 900;
color: black;
}

.support-modal {
background: #2a2a2a;
border: 2px solid rgba(150, 150, 150, 0.5);
border-radius: 20px;
padding: 30px;
max-width: 450px;
width: 90%;
text-align: left;
transform: scale(0.8);
transition: transform 0.3s ease;
}

.support-modal-overlay.show .support-modal {
transform: scale(1);
}

.support-chat {
height: 250px;
overflow-y: auto;
border: 2px solid rgba(150, 150, 150, 0.3);
border-radius: 12px;
padding: 12px;
margin-bottom: 15px;
background: rgba(0, 0, 0, 0.5);
}

.chat-message {
margin-bottom: 12px;
padding: 8px;
border-radius: 8px;
}

.chat-message.user {
background: rgba(150, 150, 150, 0.3);
text-align: right;
}

.chat-message.bot {
background: rgba(255, 255, 255, 0.1);
}

.support-input-container {
display: flex;
gap: 8px;
}

.support-input {
flex: 1;
padding: 8px;
background: rgba(0, 0, 0, 0.5);
border: 2px solid rgba(150, 150, 150, 0.3);
border-radius: 8px;
color: white;
font-family: 'Orbitron', monospace;
}

.support-send {
background: #888;
color: white;
border: none;
padding: 8px 16px;
border-radius: 8px;
cursor: pointer;
font-family: 'Orbitron', monospace;
font-weight: 700;
text-transform: none;
}

.pepe-welcome-modal {
background: #2a2a2a;
border: 2px solid rgba(150, 150, 150, 0.5);
border-radius: 20px;
padding: 30px;
max-width: 450px;
width: 90%;
text-align: center;
transform: scale(0.8);
transition: transform 0.3s ease;
}

.pepe-welcome-modal-overlay.show .pepe-welcome-modal {
transform: scale(1);
}

.pepe-welcome-image {
width: 150px;
height: 150px;
border-radius: 15px;
object-fit: cover;
margin: 0 auto 20px;
}

.pepe-welcome-title {
font-size: 2.2rem;
font-weight: 900;
color: white;
margin-bottom: 20px;
text-transform: none;
text-shadow: 3px 3px 6px rgba(0, 0, 0, 0.9), 0 0 15px rgba(150, 150, 150, 0.3);
}

.pepe-welcome-description {
font-size: 1.1rem;
color: white;
margin-bottom: 25px;
text-transform: none;
}

.pulse-animation {
animation: pulseBalance 0.5s ease-in-out;
}

@keyframes pulseBalance {
0% { transform: scale(1); }
50% { transform: scale(1.05); }
100% { transform: scale(1); }
}

.counting-animation {
animation: countUp 2s ease-out;
}

@keyframes countUp {
0% { transform: scale(0.8); opacity: 0.5; }
50% { transform: scale(1.05); opacity: 0.8; }
100% { transform: scale(1); opacity: 1; }
}

.asset-balance.hidden .asset-amount, .asset-balance.hidden .asset-value {
color: #8b45ff !important;
font-weight: 900;
}

.asset-balance.hidden .asset-amount {
font-size: 1.2rem;
}

.case-modal {
background: #2a2a2a;
border: 2px solid rgba(128, 128, 128, 0.5);
border-radius: 20px;
padding: 30px;
max-width: 600px;
width: 90%;
text-align: center;
transform: scale(0.8);
transition: transform 0.3s ease;
}

.case-modal-overlay.show .case-modal {
transform: scale(1);
}

.case-modal h2 {
color: #808080;
margin-bottom: 25px;
font-size: 1.8rem;
font-weight: 700;
text-transform: none;
}

.case-slot-container {
width: 400px;
height: 160px;
margin: 0 auto 30px;
background: linear-gradient(45deg, #808080, #999999, #808080, #999999);
background-size: 400% 400%;
border-radius: 20px;
display: flex;
align-items: center;
justify-content: center;
position: relative;
overflow: hidden;
border: 3px solid #666666;
}

.case-slot-container::before {
content: '▼';
position: absolute;
top: -15px;
left: 50%;
transform: translateX(-50%);
font-size: 2rem;
color: #ff4444;
z-index: 10;
text-shadow: 0 0 10px #ff4444;
animation: arrowBounce 1s ease-in-out infinite;
}

@keyframes arrowBounce {
0%, 100% { transform: translateX(-50%) translateY(0); }
50% { transform: translateX(-50%) translateY(5px); }
}

.slot-wheel {
width: 7500px;
height: 150px;
display: flex;
flex-direction: row;
position: absolute;
animation-timing-function: cubic-bezier(0.25, 0.46, 0.45, 0.94);
left: 0;
top: 50%;
transform: translateY(-50%);
}

.slot-item {
width: 150px;
height: 150px;
display: flex;
align-items: center;
justify-content: center;
flex-shrink: 0;
position: relative;
}

.slot-item img {
width: 120px;
height: 120px;
object-fit: contain;
border-radius: 15px;
}

.slot-spinning {
animation: slotSpinHorizontal 4s ease-out;
}

@keyframes slotSpinHorizontal {
0% { transform: translateX(0px) translateY(-50%); }
20% { transform: translateX(-1500px) translateY(-50%); animation-timing-function: ease-out; }
60% { transform: translateX(-3000px) translateY(-50%); animation-timing-function: ease-out; }
80% { transform: translateX(-3600px) translateY(-50%); animation-timing-function: ease-in-out; }
95% { transform: translateX(-3750px) translateY(-50%); animation-timing-function: ease-in; }
100% { transform: translateX(-3600px) translateY(-50%); }
}

.case-result {
background: rgba(128, 128, 128, 0.1);
border: 2px solid #808080;
border-radius: 15px;
padding: 30px;
margin-bottom: 20px;
display: none;
}

.case-result-image {
width: 120px;
height: 120px;
margin: 0 auto 20px;
border-radius: 15px;
object-fit: cover;
display: block;
}

.case-result-title {
font-size: 1.8rem;
font-weight: 700;
color: #FFD700;
margin-bottom: 15px;
}

.case-result-description {
color: white;
opacity: 0.9;
line-height: 1.4;
margin-bottom: 20px;
font-size: 1rem;
}

.case-result-price {
font-size: 2rem;
font-weight: 900;
color: #808080;
margin-bottom: 25px;
text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.8);
}

.prize-action-buttons {
display: flex;
justify-content: center;
gap: 20px;
margin-top: 20px;
}

.sell-btn {
background: #808080;
color: #000;
border: none;
padding: 15px 30px;
border-radius: 12px;
font-family: 'Orbitron', monospace;
font-weight: 700;
font-size: 1.1rem;
cursor: pointer;
transition: all 0.3s ease;
text-transform: none;
}

.sell-btn:hover {
background: #999999;
transform: translateY(-2px);
box-shadow: 0 5px 15px rgba(128, 128, 128, 0.3);
}

.sell-btn:disabled {
background: #555555;
color: #888888;
cursor: not-allowed;
transform: none;
box-shadow: none;
}

.get-btn {
background: rgba(255, 255, 255, 0.1);
color: white;
border: 2px solid rgba(255, 255, 255, 0.3);
padding: 13px 30px;
border-radius: 12px;
font-family: 'Orbitron', monospace;
font-weight: 700;
font-size: 1.1rem;
cursor: pointer;
transition: all 0.3s ease;
text-transform: none;
}

.get-btn:hover {
background: rgba(255, 255, 255, 0.2);
transform: translateY(-2px);
box-shadow: 0 5px 15px rgba(255, 255, 255, 0.2);
}

.get-btn:disabled {
background: rgba(255, 255, 255, 0.05);
color: #888888;
cursor: not-allowed;
transform: none;
box-shadow: none;
border-color: rgba(255, 255, 255, 0.1);
}

@media (max-width: 1400px) {
.main-content {
grid-template-columns: 1fr;
height: auto;
}

.game-canvas {
height: 480px;
}

.players-panel {
order: 2;
max-height: 400px;
}

.betting-panel {
order: 3;
}

.header-center {
position: static;
transform: none;
}

body {
padding-bottom: 150px;
}
}

@media (max-width: 768px) {
body {
padding: 10px;
padding-bottom: 150px;
padding-top: 120px;
}

.fixed-balance-panel, .fixed-status-panel {
position: fixed;
top: 105px;
padding: 8px 15px;
border-radius: 20px;
transform: scale(0.77);
}

.fixed-balance-panel {
right: 10px;
transform-origin: top right;
}

.fixed-status-panel {
left: 10px;
transform-origin: top left;
}

.fixed-balance-ton-logo, .fixed-status-icon {
width: 24px;
height: 24px;
}

.fixed-balance-amount, .fixed-status-number {
font-size: 0.9rem;
}

.fixed-balance-plus {
width: 24px;
height: 24px;
font-size: 1rem;
}

.header {
flex-direction: column;
gap: 20px;
text-align: center;
padding: 15px;
}

.balance-container {
flex-direction: column;
text-align: center;
padding: 15px;
}

.balance-buttons {
justify-content: center;
flex-wrap: wrap;
gap: 8px;
margin-top: 15px;
}

.balance-button, .menu-button {
padding: 6px 12px;
font-size: 0.8rem;
}

.game-canvas {
height: 400px;
margin-bottom: 20px;
}

.multiplier-display {
font-size: 3rem;
}

.game-control-buttons {
bottom: 15px;
left: 15px;
right: 15px;
}

.game-control-button {
min-width: 120px;
padding: 12px 16px;
font-size: 0.9rem;
}

.registration-info {
font-size: 0.6rem;
max-width: 95%;
}

.bonus-content, .wallet-content, .cases-content, .support-content {
padding: 15px;
max-width: 100%;
min-height: 600px;
}

.bonus-title, .wallet-title, .cases-title, .support-content-title {
font-size: 1.5rem;
}

.bonus-stages {
grid-template-columns: repeat(2, 1fr);
gap: 15px;
}

.bonus-stats {
grid-template-columns: 1fr;
gap: 15px;
}

.wallet-actions {
grid-template-columns: repeat(2, 1fr);
gap: 15px;
flex-wrap: wrap;
}

.balance-amount-large {
font-size: 1.5rem;
}

.asset-item {
padding: 15px;
}

.asset-icon {
width: 35px;
height: 35px;
}

.modal {
padding: 20px;
max-width: 95%;
}

.modal h2 {
font-size: 1.5rem;
margin-bottom: 20px;
}

.modal-input {
font-size: 1.2rem;
padding: 15px;
}

.win-modal {
max-width: 95%;
padding: 30px;
left: 2.5%;
margin-left: 0;
}

.win-amount {
font-size: 3rem;
}

.players-panel {
max-height: 300px;
}

.player-item {
padding: 8px 12px;
font-size: 0.8rem;
}

.pepe-contest {
flex-direction: column;
text-align: center;
}

.pepe-contest-image {
width: 100px;
height: 100px;
margin: 0 auto 20px;
}

.wallet-content {
min-height: 500px;
}

.wallet-header {
padding: 16px;
}

.wallet-overview {
padding: 16px;
}

.wallet-title {
font-size: 1.25rem;
}

.balance-amount-large {
font-size: 1.5rem;
}

.withdraw-modal {
max-width: 95%;
padding: 30px;
}

.withdraw-modal h2 {
font-size: 2rem;
}

.withdraw-input {
font-size: 1.1rem;
padding: 20px;
}

.start-case {
max-width: 100%;
padding: 30px 20px;
}

.case-image {
width: 120px;
height: 120px;
}

.case-name {
font-size: 1.5rem;
}

.prizes-grid {
grid-template-columns: 1fr;
}

.case-slot-container {
width: 300px;
height: 120px;
}

.slot-item {
width: 120px;
height: 120px;
}

.slot-item img {
width: 80px;
height: 80px;
}

.prize-action-buttons {
flex-direction: column;
gap: 15px;
}

.sell-btn, .get-btn {
width: 100%;
padding: 15px;
}

.bottom-navigation {
padding: 10px 0;
gap: 15px;
}

.nav-btn {
width: 50px;
height: 50px;
padding: 12px;
}

.nav-btn img {
width: 28px;
height: 28px;
}

.support-channels {
grid-template-columns: 1fr;
gap: 15px;
}

.support-channel {
padding: 20px;
}

.bottom-buttons {
flex-direction: column;
gap: 10px;
left: 20px;
bottom: 80px;
}

.bottom-btn {
align-self: flex-start;
}
}

#depositButtons .modal-btn.confirm {
display: none;
}
</style>
</head>
<body>
<!-- Загрузочный экран с черным фоном -->
<div class="loading-overlay" id="loadingOverlay">
<img src="https://i.postimg.cc/NjF39JPN/zag.gif" alt="Loading">
</div>

<!-- ФИКСИРОВАННЫЕ ПАНЕЛИ СВЕРХУ - НА 15 ПИКСЕЛЕЙ ВЫШЕ И ПОМЕНЯНЫ МЕСТАМИ -->
<div class="fixed-status-panel">
<img src="https://cdn-icons-png.flaticon.com/512/4122/4122823.png" alt="Status" class="fixed-status-icon">
<span class="fixed-status-number" id="fixedStatusNumber">79</span>
</div>

<div class="fixed-balance-panel">
<img src="https://files.svgcdn.io/token-branded/ton.png" alt="TON" class="fixed-balance-ton-logo">
<span class="fixed-balance-amount" id="fixedBalanceAmount">100 TON</span>
<div class="fixed-balance-plus" onclick="showDepositModal()">+</div>
</div>

<div class="container">
<div class="header">
<div class="logo">
<img src="https://i.postimg.cc/MTF4gsV0/tyuj.png" alt="TON CRASH">
</div>

<div class="balance-container">
<div class="balance-amount" id="balance" onclick="toggleCurrency()">
<div class="balance-main balance-blurred" id="balanceMain">
<span id="balanceMainText">100</span>
<img src="https://files.svgcdn.io/token-branded/ton.png" alt="TON" style="width: 20px; height: 20px; margin-left: 8px;">
</div>
<div class="balance-secondary balance-blurred" id="balanceSecondary">
<span id="balanceSecondaryText" style="display: none;">1.00 TON</span>
<span class="currency-switch" id="currencySwitch" style="display: none;">TON</span>
</div>
</div>

<div class="balance-buttons" id="balanceButtons" style="display: none;">
<button class="balance-button deposit" onclick="showDepositModal()" title="Пополнить">+</button>
<div class="refresh-balance-button" onclick="refreshBalance()" title="Обновить баланс">
🔄
</div>
<div style="position: relative;">
<div class="dropdown-menu" id="dropdownMenu">
<button class="dropdown-item" onclick="switchToSlide(3); toggleMenu()">Кошелек</button>
<button class="dropdown-item" onclick="showAccountModal(); toggleMenu()">Профиль</button>
</div>
</div>
</div>

<div class="login-overlay" id="loginOverlay">
<button class="login-btn" onclick="showLoginModal()" data-lang="login">Войти</button>
</div>
</div>
</div>

<div class="content-slider">
<div class="slider-container" id="sliderContainer">
<!-- Слайд 1: Игра CRASH -->
<div class="slide">
<div class="main-content">
<div class="players-panel">
<div class="players-title" data-lang="players-online">Игроки</div>
<div id="playersList"></div>
</div>

<div class="game-area">
<div class="game-canvas" id="gameCanvas">
<div class="multiplier-display" id="multiplier">1.00x</div>
<div class="win-display" id="winDisplay">+0.00</div>

<svg class="trading-chart" id="tradingChart" viewBox="0 0 800 500">
<defs>
<linearGradient id="gradient" x1="0%" y1="0%" x2="0%" y2="100%">
<stop offset="0%" style="stop-color:#96ff54;stop-opacity:0.8" />
<stop offset="100%" style="stop-color:#96ff54;stop-opacity:0" />
</linearGradient>
</defs>
<path class="chart-area" id="chartArea" d=""></path>
<path class="chart-line" id="chartLine" d=""></path>
</svg>

<img src="/placeholder.svg" alt="Game Animation" class="game-gif" id="gameGif">

<div class="game-history-mini" id="gameHistoryMini"></div>

<div class="countdown-overlay" id="countdown" style="display: none;">
<div class="countdown-number" id="countdownNumber">3</div>
</div>

<!-- УЛУЧШЕННАЯ ВЕРТИКАЛЬНАЯ ЛИНЕЙКА СЛЕВА С ПОЛОСКАМИ - НА ЗАДНЕМ ПЛАНЕ -->
<div class="rocket-speed-indicator-vertical" id="rocketSpeedVertical">
<div class="speed-lines-vertical"></div>
</div>

<!-- УЛУЧШЕННАЯ ЛИНЕЙКА СНИЗУ С ПОЛОСКАМИ РАЗНЫХ РАЗМЕРОВ И ЦВЕТОВ - НА ЗАДНЕМ ПЛАНЕ -->
<div class="rocket-speed-indicator" id="rocketSpeedBottom">
<div class="speed-lines" id="speedLines"></div>
</div>

<div class="game-control-buttons">
<button class="game-control-button cancel-bet-button" id="gameControlCancel" onclick="cancelBet()" data-lang="cancel-bet">ОТМЕНИТЬ СТАВКУ</button>
<button class="game-control-button place-bet-button" id="gameControlPlace" onclick="showBetModal()" data-lang="place-bet">ПОСТАВИТЬ</button>
<button class="game-control-button cashout-button" id="gameControlCashout" onclick="cashOut()" data-lang="cashout">ЗАБРАТЬ</button>
</div>

<div class="registration-info"></div>
</div>

<!-- НОВОЕ: Окно с последними выигрышами других игроков -->
<div class="recent-wins-panel">
<div class="recent-wins-title">🚀 Последние выигрыши</div>
<div class="wins-list" id="recentWinsList">
<!-- Выигрыши будут добавляться динамически -->
</div>
</div>
</div>

<div class="betting-panel">
<div class="game-stats">
<div class="stat-card">
<div class="stat-value" id="totalGames">0</div>
<div class="stat-label" data-lang="total-games">Всего игр</div>
</div>
<div class="stat-card">
<div class="stat-value" id="winRate">0%</div>
<div class="stat-label" data-lang="win-rate">Процент побед</div>
</div>
</div>

<div class="history-panel">
<div class="history-title" data-lang="game-history">История последних игр</div>
<div class="history-list" id="historyList"></div>
</div>
</div>
</div>
</div>

<!-- Слайд 2: Бонусы -->
<div class="slide">
<div class="bonus-content">
<div class="bonus-title" data-lang="bonus-system">Бонусная система</div>

<div class="bonus-info">
<div class="bonus-progress">
<div class="bonus-progress-text" id="bonusProgressText" data-lang="stage-progress">Стадия 1 из 5</div>
<div class="bonus-progress-bar">
<div class="bonus-progress-fill" id="bonusProgressFill" style="width: 0%"></div>
</div>
</div>

<div class="bonus-stats">
<div class="bonus-stat">
<div class="bonus-stat-value" id="totalDeposits">0</div>
<div class="bonus-stat-label" data-lang="total-deposits">Всего пополнений</div>
</div>
<div class="bonus-stat">
<div class="bonus-stat-value" id="totalBonus">0.00</div>
<div class="bonus-stat-label" data-lang="bonus-received">Получено бонусов</div>
</div>
<div class="bonus-stat">
<div class="bonus-stat-value" id="nextBonusAmount">100%</div>
<div class="bonus-stat-label" data-lang="next-bonus">Следующий бонус</div>
</div>
</div>
</div>

<div class="bonus-stages" id="bonusStages"></div>

<div class="pepe-contest">
<img src="https://i.postimg.cc/hGpYHrm4/rounded-in-photoretrica-10.png" alt="PEPE Contest" class="pepe-contest-image">
<div class="pepe-contest-content">
<div class="pepe-contest-title">Выиграйте PEPE</div>
<button class="pepe-contest-button" onclick="participateInContest()">Участвовать</button>
</div>
</div>
</div>
</div>

<!-- Слайд 3: Кейсы -->
<div class="slide">
<div class="cases-content">
<div class="cases-title">🎁 Кейсы с подарками</div>

<div class="start-case" onclick="toggleCasePrizes()">
<img src="https://i.postimg.cc/G3QdGS3H/image.png" alt="START Case" class="case-image">
<div class="case-name">START</div>
<div class="case-price">3.00 TON</div>

<div class="case-buttons">
<button class="case-open-btn" onclick="event.stopPropagation(); openStartCase()">Открыть кейс</button>
<button class="case-demo-btn" onclick="event.stopPropagation(); demoStartCase()">Демо прокрут</button>
</div>

<div class="case-prizes" id="casePrizes">
<div class="case-prizes-title">Возможные призы:</div>
<div class="prizes-grid">
<div class="prize-item">
<img src="https://emojio.ru/images/apple-b/11.0/1f9f8.png" alt="Мишка" class="prize-icon">
<div class="prize-info">
<div class="prize-name">Мишка</div>
<div class="prize-price">0.10 TON</div>
</div>
</div>
<div class="prize-item">
<img src="https://emojio.ru/images/apple-b/1f37e.png" alt="Шампанское" class="prize-icon">
<div class="prize-info">
<div class="prize-name">Шампанское</div>
<div class="prize-price">0.50 TON</div>
</div>
</div>
<div class="prize-item">
<img src="https://i.postimg.cc/HsZsMPW2/9017120-imgwebp-Photoroom.png" alt="Подарок" class="prize-icon">
<div class="prize-info">
<div class="prize-name">Подарок #3</div>
<div class="prize-price">0.10 TON</div>
</div>
</div>
<div class="prize-item">
<img src="https://i.postimg.cc/1XF2zXzF/2025-10-04-233431-Photoroom.png" alt="Подарок" class="prize-icon">
<div class="prize-info">
<div class="prize-name">Подарок #4</div>
<div class="prize-price">0.50 TON</div>
</div>
</div>
<div class="prize-item">
<img src="https://i.postimg.cc/BbNDHctn/2025-10-04-233719-Photoroom.png" alt="Подарок" class="prize-icon">
<div class="prize-info">
<div class="prize-name">Подарок #5</div>
<div class="prize-price">1.00 TON</div>
</div>
</div>
<div class="prize-item">
<img src="https://i.postimg.cc/rw5VHyCz/2025-10-04-233857-Photoroom.png" alt="Подарок" class="prize-icon">
<div class="prize-info">
<div class="prize-name">Подарок #6</div>
<div class="prize-price">1.00 TON</div>
</div>
</div>
<div class="prize-item">
<img src="https://i.postimg.cc/DyrfjycP/2025-10-04-234058-Photoroom.png" alt="Подарок" class="prize-icon">
<div class="prize-info">
<div class="prize-name">Подарок #7</div>
<div class="prize-price">3.00 TON</div>
</div>
</div>
<div class="prize-item">
<img src="https://telegifter.ru/wp-content/themes/gifts/assets/img/gifts/snoopcigar/Happy%20Face.webp" alt="Happy Face" class="prize-icon">
<div class="prize-info">
<div class="prize-name">Happy Face</div>
<div class="prize-price">10.00 TON</div>
</div>
</div>
<div class="prize-item">
<img src="https://telegifter.ru/wp-content/themes/gifts/assets/img/gifts/freshsocks/Billie%20Jean.webp" alt="Billie Jean" class="prize-icon">
<div class="prize-info">
<div class="prize-name">Billie Jean</div>
<div class="prize-price">15.00 TON</div>
</div>
</div>
<div class="prize-item">
<img src="https://telegifter.ru/wp-content/themes/gifts/assets/img/gifts/durovscap/Asterix.webp" alt="Asterix" class="prize-icon">
<div class="prize-info">
<div class="prize-name">Asterix</div>
<div class="prize-price">800.00 TON</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>

<!-- Слайд 4: Кошелек -->
<div class="slide">
<div class="wallet-content">
<div class="wallet-header">
<h1 class="wallet-title" data-lang="wallet-title">🔶</h1>
<button class="refresh-button" onclick="refreshWallet()">
⚙️
</button>
</div>

<div class="wallet-overview">
<div class="total-balance">
<h3>Общий баланс в USD</h3>
<div class="balance-display">
<div class="balance-amount-large" id="totalBalanceDisplay">$0.00</div>
<div class="balance-ton-secondary" id="balanceTonSecondary">0.00 TON</div>
<div style="color: #8b45ff; font-size: 1.5rem; margin-left: 10px; cursor: pointer;" onclick="toggleWalletBalanceVisibility()">
<svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
<path d="M12 4.5C7.5 4.5 3.9 7.2 2.7 11.2C2.6 11.5 2.6 11.8 2.7 12.1C3.9 16.1 7.5 18.8 12 18.8C16.5 18.8 20.1 16.1 21.3 12.1C21.4 11.8 21.4 11.5 21.3 11.2C20.1 7.2 16.5 4.5 12 4.5ZM12 16.2C9.5 16.2 7.5 14.2 7.5 11.7C7.5 9.2 9.5 7.2 12 7.2C14.5 7.2 16.5 9.2 16.5 11.7C16.5 14.2 14.5 16.2 12 16.2ZM12 9C10.3 9 9 10.3 9 12C9 13.7 10.3 15 12 15C13.7 15 15 13.7 15 12C15 10.3 13.7 9 12 9Z"/>
</svg>
</div>
</div>
</div>

<div class="wallet-actions">
<button class="action-button deposit" onclick="showDepositModal()" data-lang="deposit">Пополнить</button>
<button class="action-button withdraw" onclick="showWithdrawModal()" data-lang="withdraw">Вывести</button>
</div>
</div>

<div class="assets-header">
<div class="assets-title" onclick="toggleSmallBalances()">Скрыть мелкие балансы</div>
<button class="show-balances-button" id="showBalancesButton" onclick="showAllBalances()">Показать балансы</button>
</div>

<div class="assets-section" id="assetsSection">
<div class="asset-item">
<div class="asset-icon" style="background: #26a69a;">
<img src="https://upload.wikimedia.org/wikipedia/commons/0/01/USDT_Logo.png" alt="USDT">
</div>
<div class="asset-info">
<div class="asset-main">
<div class="asset-name">Tether</div>
<div class="asset-price">$1 </div>
<div class="asset-change positive">+0.01%</div>
</div>
</div>
<div class="asset-balance" id="usdtAssetBalance">
<div class="asset-amount" id="usdtWalletBalance">***</div>
<div class="asset-value" id="usdtWalletValue">***</div>
</div>
</div>

<div class="asset-item">
<div class="asset-icon" style="background: #0098ea;">
<img src="https://ton.org/download/ton_symbol.png" alt="TON">
</div>
<div class="asset-info">
<div class="asset-main">
<div class="asset-name">Toncoin</div>
<div class="asset-price">$2.7 </div>
<div class="asset-change negative">-2.18%</div>
</div>
</div>
<div class="asset-balance">
<div class="asset-amount" id="tonWalletBalance">***</div>
<div class="asset-value" id="tonWalletValue">***</div>
</div>
</div>

<div class="asset-item">
<div class="asset-icon" style="background: #9945ff;">
<img src="https://png.pngtree.com/png-vector/20220913/ourmid/pngtree-solana-sol-cryptocurrency-symbol-depicted-on-a-plain-white-backdrop-vector-png-image_39199908.png" alt="Solana">
</div>
<div class="asset-info">
<div class="asset-main">
<div class="asset-name">Solana</div>
<div class="asset-price">$201.83 </div>
<div class="asset-change negative">-0.11%</div>
</div>
</div>
<div class="asset-balance" id="solAssetBalance">
<div class="asset-amount" id="solWalletBalance">***</div>
<div class="asset-value" id="solWalletValue">***</div>
</div>
</div>

<div class="asset-item">
<div class="asset-icon" style="background: #ff0013;">
<img src="https://s3.coinmarketcap.com/static-gravity/image/4aec70f6f1254e4f89650cc68ae49f3c.png" alt="TRON">
</div>
<div class="asset-info">
<div class="asset-main">
<div class="asset-name">TRON</div>
<div class="asset-price">$0.337 </div>
<div class="asset-change positive">+0.39%</div>
</div>
</div>
<div class="asset-balance" id="tronAssetBalance">
<div class="asset-amount" id="tronWalletBalance">***</div>
<div class="asset-value" id="tronWalletValue">***</div>
</div>
</div>

<div class="asset-item">
<div class="asset-icon" style="background: #6c7293;">
<img src="https://s3.coinmarketcap.com/static-gravity/image/4aec70f6f1254e4f89650cc68ae49f3c.png" alt="Gram">
</div>
<div class="asset-info">
<div class="asset-main">
<div class="asset-name">Gram</div>
<div class="asset-price">$0.00306 </div>
<div class="asset-change positive">+0.50%</div>
</div>
</div>
<div class="asset-balance" id="gramAssetBalance">
<div class="asset-amount" id="gramWalletBalance">***</div>
<div class="asset-value" id="gramWalletValue">***</div>
</div>
</div>

<div class="asset-item">
<div class="asset-icon" style="background: #f7931a;">
<img src="https://upload.wikimedia.org/wikipedia/commons/thumb/4/46/Bitcoin.svg/2048px-Bitcoin.svg.png" alt="Bitcoin">
</div>
<div class="asset-info">
<div class="asset-main">
<div class="asset-name">Bitcoin</div>
<div class="asset-price">$109,497 </div>
<div class="asset-change negative">-0.64%</div>
</div>
</div>
<div class="asset-balance" id="btcAssetBalance">
<div class="asset-amount" id="btcWalletBalance">***</div>
<div class="asset-value" id="btcWalletValue">***</div>
</div>
</div>
</div>
</div>
</div>

<!-- Слайд 5: Поддержка -->
<div class="slide">
<div class="support-content">
<div class="support-content-title">💬 Поддержка</div>

<div class="support-channels">
<div class="support-channel" onclick="window.open('https://t.me/suphiex', '_blank')">
<div class="support-channel-icon">📱</div>
<div class="support-channel-title">Telegram</div>
<div class="support-channel-desc">Быстрая поддержка через Telegram бота. Ответим в течение 5 минут!</div>
</div>

<div class="support-channel" onclick="showSupportModal()">
<div class="support-channel-icon">💬</div>
<div class="support-channel-title">Онлайн чат</div>
<div class="support-channel-desc">Интерактивный чат с автоответами на популярные вопросы</div>
</div>

<div class="support-channel" onclick="window.open('mailto:support@toncrash.com', '_blank')">
<div class="support-channel-icon">📧</div>
<div class="support-channel-title">Email</div>
<div class="support-channel-desc">Отправьте нам письмо для детального рассмотрения вопроса</div>
</div>

<div class="support-channel" onclick="window.open('https://t.me/TonBet999', '_blank')">
<div class="support-channel-icon">📢</div>
<div class="support-channel-title">Новости</div>
<div class="support-channel-desc">Подпишитесь на наш канал для получения актуальных новостей</div>
</div>
</div>

<div style="background: rgba(150, 150, 150, 0.1); border-radius: 15px; padding: 30px; text-align: center;">
<h3 style="color: white; margin-bottom: 20px; font-size: 1.5rem;">Часто задаваемые вопросы</h3>
<div style="display: grid; grid-template-columns: 1fr; gap: 15px; text-align: left;">
<div style="background: rgba(0,0,0,0.3); padding: 15px; border-radius: 10px;">
<strong>Как пополнить баланс?</strong><br>
Перейдите в раздел "Пополнить", выберите способ оплаты и следуйте инструкциям.
</div>
<div style="background: rgba(0,0,0,0.3); padding: 15px; border-radius: 10px;">
<strong>Как вывести средства?</strong><br>
Минимальная сумма вывода - 1 TON. Переходите в "Кошелек" → "Вывести".
</div>
<div style="background: rgba(0,0,0,0.3); padding: 15px; border-radius: 10px;">
<strong>Есть ли бонусы?</strong><br>
Да! За первое пополнение +100%, за второе +50%, далее по 10%.
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>

<!-- Нижняя навигационная панель с затемнением -->
<div class="bottom-navigation">
<button class="nav-btn active" id="crashNavBtn" onclick="switchToSlide(0)">
<img src="https://radika1.link/2025/10/06/1111111a5c731ee14345948.png" alt="Crash">
</button>
<button class="nav-btn" id="bonusNavBtn" onclick="switchToSlide(1)">
<img src="https://s3.radikal.cloud/2025/10/06/dfbvdfvb722e5d95b81c326a.png" alt="Бонусы">
</button>
<button class="nav-btn" id="casesNavBtn" onclick="switchToSlide(2)">
<img src="https://s3.radikal.cloud/2025/10/06/rfgdserfdsc0938887a0a8ff16.png" alt="Кейсы">
</button>
<button class="nav-btn" id="walletNavBtn" onclick="switchToSlide(3)">
<img src="https://s2.radikal.cloud/2025/10/06/VEKUAPe97322d36350490f.png" alt="Кошелек">
</button>
<button class="nav-btn" id="supportNavBtn" onclick="switchToSlide(4)">
<img src="https://cdn-icons-png.flaticon.com/512/1159/1159633.png" alt="Поддержка">
</button>
</div>

<div class="bottom-buttons">
<button class="bottom-btn" onclick="toggleLanguage()" id="languageSwitcher">RU</button>
<button class="bottom-btn" onclick="showSupportModal()">💬</button>
</div>

<div class="bet-info-display" id="betInfoDisplay" style="display: none;"></div>

<!-- Модальные окна -->
<div class="modal-overlay pepe-welcome-modal-overlay" id="pepeWelcomeModal">
<div class="modal pepe-welcome-modal">
<img src="https://i.postimg.cc/hGpYHrm4/rounded-in-photoretrica-10.png" alt="PEPE Contest" class="pepe-welcome-image">
<div class="pepe-welcome-title">Выиграйте PEPE!</div>
<div class="pepe-welcome-description">
Примите участие в конкурсе и получите шанс выиграть PEPE токены!
</div>
<div class="modal-buttons">
<button class="modal-btn confirm" onclick="participateInContest(); closePepeWelcomeModal()">Участвовать</button>
<button class="modal-btn cancel" onclick="closePepeWelcomeModal()">Позже</button>
</div>
</div>
</div>

<div class="modal-overlay" id="loginModal">
<div class="modal">
<h2 data-lang="login-title">Вход в игру</h2>
<input type="text" class="modal-input" id="telegramNick" data-lang-placeholder="enter-nickname" placeholder="Введите ваш ник в Telegram" maxlength="20">
<div class="remember-me-container" style="margin: 10px 0; text-align: left;">
<label style="display: flex; align-items: center; color: #fff; font-size: 14px; cursor: pointer;">
<input type="checkbox" id="rememberMe" style="margin-right: 8px; transform: scale(1.2);">
<span data-lang="remember-me">Запомнить меня</span>
</label>
</div>
<div class="modal-buttons">
<button class="modal-btn confirm" onclick="login()" data-lang="login">Войти</button>
<button class="modal-btn cancel" onclick="closeLoginModal()" data-lang="cancel">Отмена</button>
</div>
</div>
</div>

<!-- НОВОЕ BOTTOM SHEET ДЛЯ СТАВОК -->
<div class="bottom-sheet-overlay" id="betModal">
<div class="bottom-sheet">
<div class="bottom-sheet-header">
<h2 data-lang="place-bet">Сделать ставку</h2>
</div>

<div class="currency-selector">
<button class="currency-btn active" id="tonCurrencyBtn" onclick="selectBetCurrency('TON')">
<img src="https://files.svgcdn.io/token-branded/ton.png" alt="TON" style="width: 20px; height: 20px;">
TON
</button>
<button class="currency-btn" id="usdtCurrencyBtn" onclick="selectBetCurrency('USDT')">
<img src="https://upload.wikimedia.org/wikipedia/commons/0/01/USDT_Logo.png" alt="USDT" style="width: 20px; height: 20px;">
USDT
</button>
</div>

<input type="number" class="bet-amount-input" id="betAmountInput" placeholder="0.10" min="0.01" step="0.01">

<div class="quick-bet-grid" id="quickBetGrid">
<button class="quick-bet" onclick="setBetAmountModal(10)">
+10
<img src="https://files.svgcdn.io/token-branded/ton.png" alt="TON" style="width: 16px; height: 16px;" id="quickBet1Icon">
</button>
<button class="quick-bet" onclick="setBetAmountModal(30)">
+30
<img src="https://files.svgcdn.io/token-branded/ton.png" alt="TON" style="width: 16px; height: 16px;" id="quickBet2Icon">
</button>
<button class="quick-bet special" onclick="setBetAmountModal(999999)">
ВСЕ
</button>
<button class="quick-bet" onclick="setBetAmountModal(0.5)">
0.5
<img src="https://files.svgcdn.io/token-branded/ton.png" alt="TON" style="width: 16px; height: 16px;" id="quickBet4Icon">
</button>
<button class="quick-bet" onclick="setBetAmountModal(1.0)">
1.0
<img src="https://files.svgcdn.io/token-branded/ton.png" alt="TON" style="width: 16px; height: 16px;" id="quickBet5Icon">
</button>
<button class="quick-bet special" onclick="doubleBetModal()">2x</button>
</div>

<!-- Автокешаут -->
<div class="auto-cashout-container">
<div class="auto-cashout-header">
<div class="auto-cashout-label">Авто кешаут</div>
<div class="auto-cashout-toggle" id="autoCashoutToggle" onclick="toggleAutoCashout()"></div>
</div>
<input type="number" class="auto-cashout-input" id="autoCashoutInput" placeholder="2.00" min="1.01" step="0.01" value="2.00">
</div>

<div class="modal-buttons">
<button class="modal-btn confirm" onclick="confirmBet()" data-lang="place-bet">ПОСТАВИТЬ</button>
<button class="modal-btn cancel" onclick="closeBetModal()" data-lang="cancel">Отмена</button>
</div>
</div>
</div>

<div class="modal-overlay" id="depositModal">
<div class="modal">
<h2 data-lang="deposit-balance">Пополнение баланса</h2>
<button class="cryptopay-btn" onclick="openCryptoPay()">
CryptoPay [+2%]
</button>
<div class="deposit-buttons">
<button class="deposit-btn" onclick="depositCurrency('TON')" id="tonDepositBtn">
<img src="https://i.postimg.cc/Vk7BwHKh/image-1.png" alt="TON" class="ton-logo-rounded" style="width: 24px; height: 24px;">
TON
</button>
<button class="deposit-btn" onclick="depositCurrency('SBP')" id="sbpDepositBtn">
<img src="https://png.klev.club/uploads/posts/2024-05/png-klev.club-92ub-p-sbp-logotip-png-18.png" alt="СБП" style="width: 30px; height: 30px; object-fit: contain;">
СБП
</button>
</div>
<input type="number" class="modal-input" id="depositAmount" data-lang-placeholder="enter-deposit-amount" placeholder="Введите сумму для пополнения" min="1" step="1">

<div class="promo-section">
<div class="promo-title">Промокод</div>
<input type="text" class="promo-input" id="promoCodeInput" placeholder="Введите промокод">
<button class="promo-button" onclick="applyPromoCode()">Применить</button>
</div>

<div class="modal-buttons" id="depositButtons">
<button class="modal-btn confirm" onclick="confirmDeposit()">Пополнить</button>
<button class="modal-btn cancel" onclick="closeDepositModal()" data-lang="cancel">Отмена</button>
</div>

<div id="tonDepositInfo" style="display: none;">
<div class="qr-container">
<img src="https://i.postimg.cc/XYg1C8QK/5375564163138584120.jpg" alt="QR Code" class="qr-image">
<div class="copy-text" onclick="copyAddress()">
UQCvyMHj2r7Ig73EcbBI3h405uemns12eX49OBW3cVsOEzuW
</div>
<div class="timer-display" id="timerDisplay">05:00</div>
<div class="deposit-status">
<p>Ожидание платежа...</p>
<p>Средства будут зачислены автоматически после истечения таймера</p>
</div>
</div>
<div class="modal-buttons">
<button class="modal-btn cancel" onclick="closeDepositModal()">Закрыть</button>
</div>
</div>
</div>
</div>

<div class="modal-overlay" id="p2pModal">
<div class="modal">
<h2>P2P Торговля</h2>
<p>Функция P2P торговли будет доступна в ближайшее время!</p>
<p>Следите за обновлениями.</p>
<div class="modal-buttons">
<button class="modal-btn cancel" onclick="closeP2PModal()">Закрыть</button>
</div>
</div>
</div>

<div class="modal-overlay" id="withdrawModal">
<div class="modal withdraw-modal">
<h2 data-lang="withdraw-balance">Вывод средств</h2>
<div class="withdraw-info">
<p data-lang="withdraw-info">Минимальная сумма для вывода: 1 TON</p>
<p data-lang="withdraw-fee">Комиссия сети: 0.02 TON</p>
</div>
<input type="text" class="withdraw-input" id="withdrawAddress" data-lang-placeholder="ton-address" placeholder="Введите TON адрес">
<input type="number" class="withdraw-input" id="withdrawAmount" data-lang-placeholder="withdraw-amount" placeholder="Введите сумму для вывода" min="1" step="0.01">
<div class="modal-buttons">
<button class="modal-btn confirm" onclick="confirmWithdraw()" data-lang="withdraw">Вывести</button>
<button class="modal-btn cancel" onclick="closeWithdrawModal()" data-lang="cancel">Отмена</button>
</div>
</div>
</div>

<div class="modal-overlay" id="accountModal">
<div class="modal account-modal">
<h2 data-lang="my-account">Мой аккаунт</h2>
<div class="account-info">
<div class="account-balance" id="accountBalance">1.00 TON</div>
<div class="account-buttons">
<button class="modal-btn confirm" onclick="showDepositModal(); closeAccountModal()" data-lang="deposit">Пополнить</button>
<button class="modal-btn cancel balance-button withdraw" onclick="showWithdrawModal(); closeAccountModal()" data-lang="withdraw">Вывод средств</button>
</div>
</div>

<div class="last-bets">
<h3 data-lang="last-bets">Последние 3 ставки:</h3>
<div id="lastBetsList">
<div class="bet-item">
<span data-lang="bet-amount">Ставка: 0.5 TON</span>
<span class="bet-result win">+0.75 TON</span>
<div class="current-win-amount">Можно забрать сейчас: 1.0 TON</div>
</div>
<div class="bet-item">
<span data-lang="bet-amount">Ставка: 0.25 TON</span>
<span class="bet-result lose">-0.25 TON</span>
</div>
<div class="bet-item">
<span data-lang="bet-amount">Ставка: 1.0 TON</span>
<span class="bet-result win">+2.0 TON</span>
<div class="current-win-amount">Можно забрать сейчас: 3.0 TON</div>
</div>
</div>
</div>

<div class="modal-buttons">
<button class="modal-btn cancel" onclick="closeAccountModal()" data-lang="close">Закрыть</button>
</div>
</div>
</div>

<!-- НОВОЕ BOTTOM SHEET ДЛЯ ВЫИГРЫШЕЙ ПОСЕРЕДИНЕ И ВНИЗУ -->
<div class="bottom-sheet-overlay win-modal-overlay" id="winModal">
<div class="bottom-sheet win-modal">
<div class="bottom-sheet-header">
<h2 data-lang="win-title">Выигрыш!</h2>
</div>
<div class="win-amount" id="winAmountDisplay">
+0.00
<img src="https://ton.org/download/ton_symbol.png" alt="TON" style="width: 48px; height: 48px; margin-left: 10px;">
</div>
<div class="win-multiplier" id="winMultiplierDisplay" data-lang="at-multiplier">при 0.00x</div>
<div class="modal-buttons">
<button class="modal-btn confirm" onclick="closeWinModal()" data-lang="great">Отлично!</button>
</div>
</div>
</div>

<div class="modal-overlay color-picker-modal-overlay" id="colorPickerModal">
<div class="modal color-picker-modal">
<h2>Выбор цвета баланса</h2>
<input type="color" class="color-picker" id="colorPicker" value="#ffffff" onchange="updateColorPreview()">
<div class="color-preview" id="colorPreview">1.00</div>
<div class="modal-buttons">
<button class="modal-btn confirm" onclick="applyBalanceColor()">Применить</button>
<button class="modal-btn cancel" onclick="closeColorPicker()">Отмена</button>
</div>
</div>
</div>

<div class="modal-overlay support-modal-overlay" id="supportModal">
<div class="modal support-modal">
<h2>Техническая поддержка</h2>
<div class="support-chat" id="supportChat">
<div class="chat-message bot">
Добро пожаловать! Я помогу вам с популярными вопросами. Выберите интересующую тему или задайте свой вопрос.
</div>
</div>
<div class="support-input-container">
<input type="text" class="support-input" id="supportInput" placeholder="Задайте ваш вопрос...">
<button class="support-send" onclick="sendSupportMessage()">Отправить</button>
</div>
<div class="modal-buttons" style="margin-top: 20px;">
<button class="modal-btn cancel" onclick="closeSupportModal()">Закрыть</button>
</div>
</div>
</div>

<!-- Модальное окно кейса START -->
<div class="modal-overlay case-modal-overlay" id="caseModal">
<div class="modal case-modal">
<h2 id="caseModalTitle">Открытие кейса START</h2>

<div class="case-slot-container" id="caseSlotContainer">
<div class="slot-wheel" id="slotWheel">
<!-- Призы будут добавлены динамически -->
</div>
</div>

<div class="case-result" id="caseResult">
<img src="" alt="Prize" class="case-result-image" id="caseResultImage">
<div class="case-result-title" id="caseResultTitle">Поздравляем!</div>
<div class="case-result-description" id="caseResultDescription">Вы выиграли приз!</div>
<div class="case-result-price" id="caseResultPrice">0.10 TON</div>

<div class="prize-action-buttons">
<button class="sell-btn" id="sellPrizeBtn" onclick="sellPrize()">Продать за 0.10 TON</button>
<button class="get-btn" id="getPrizeBtn" onclick="getPrize()">Получить</button>
</div>
</div>

<div class="modal-buttons">
<button class="modal-btn cancel" onclick="closeCaseModal()">Закрыть</button>
</div>
</div>
</div>

<script>
// Переменные для автокешаута
let autoCashoutEnabled = false;
let autoCashoutMultiplier = 2.00;

// Переменная для рандомного числа в статус панели
let statusNumber = Math.floor(Math.random() * (100 - 15 + 1)) + 15;

// СОСТОЯНИЕ ПОКАЗА БАЛАНСОВ В КОШЕЛЬКЕ
let areWalletBalancesVisible = false;

// ФУНКЦИЯ ПОКАЗА/СКРЫТИЯ ВСЕХ БАЛАНСОВ В КОШЕЛЬКЕ
function showAllBalances() {
areWalletBalancesVisible = !areWalletBalancesVisible;
const showBalancesButton = document.getElementById('showBalancesButton');

if (areWalletBalancesVisible) {
// Показываем все балансы
if (game) game.updateWalletDisplay();
showBalancesButton.textContent = 'Скрыть балансы';
} else {
// Скрываем все балансы кроме главного
hideAllWalletBalances();
showBalancesButton.textContent = 'Показать балансы';
}
}

function hideAllWalletBalances() {
// Скрываем балансы всех криптовалют, кроме главного верхнего баланса
const tonWalletBalance = document.getElementById('tonWalletBalance');
const tonWalletValue = document.getElementById('tonWalletValue');
const usdtWalletBalance = document.getElementById('usdtWalletBalance');
const usdtWalletValue = document.getElementById('usdtWalletValue');
const solWalletBalance = document.getElementById('solWalletBalance');
const solWalletValue = document.getElementById('solWalletValue');
const tronWalletBalance = document.getElementById('tronWalletBalance');
const tronWalletValue = document.getElementById('tronWalletValue');
const gramWalletBalance = document.getElementById('gramWalletBalance');
const gramWalletValue = document.getElementById('gramWalletValue');
const btcWalletBalance = document.getElementById('btcWalletBalance');
const btcWalletValue = document.getElementById('btcWalletValue');

if (tonWalletBalance) tonWalletBalance.textContent = '***';
if (tonWalletValue) tonWalletValue.textContent = '***';
if (usdtWalletBalance) usdtWalletBalance.textContent = '***';
if (usdtWalletValue) usdtWalletValue.textContent = '***';
if (solWalletBalance) solWalletBalance.textContent = '***';
if (solWalletValue) solWalletValue.textContent = '***';
if (tronWalletBalance) tronWalletBalance.textContent = '***';
if (tronWalletValue) tronWalletValue.textContent = '***';
if (gramWalletBalance) gramWalletBalance.textContent = '***';
if (gramWalletValue) gramWalletValue.textContent = '***';
if (btcWalletBalance) btcWalletBalance.textContent = '***';
if (btcWalletValue) btcWalletValue.textContent = '***';
}

// СИСТЕМА ПОДАРКОВ НА ОСНОВЕ СУММЫ СТАВКИ - ЗАМЕНЕНЫ ГИФКИ НА ПОДАРКИ
const betGiftThresholds = [
{ threshold: 3.00, gif: 'https://telegifter.ru/wp-content/themes/gifts/assets/img/gifts/bunnymuffin/Froggy.webp' },
{ threshold: 5.00, gif: 'https://telegifter.ru/wp-content/themes/gifts/assets/img/gifts/berrybox/Berrific.webp' },
{ threshold: 7.50, gif: 'https://telegifter.ru/wp-content/themes/gifts/assets/img/gifts/skullflower/Black%20Cat.webp' },
{ threshold: 10.00, gif: 'https://telegifter.ru/wp-content/themes/gifts/assets/img/gifts/ionicdryer/Arc%20Reactor.webp' },
{ threshold: 15.00, gif: 'https://telegifter.ru/wp-content/themes/gifts/assets/img/gifts/voodoodoll/Disco%20Doll.webp' },
{ threshold: 25.00, gif: 'https://telegifter.ru/wp-content/themes/gifts/assets/img/gifts/toybear/Deadpool.webp' },
{ threshold: 50.00, gif: 'https://telegifter.ru/wp-content/themes/gifts/assets/img/gifts/genielamp/Aladdin.webp' },
{ threshold: 75.00, gif: 'https://telegifter.ru/wp-content/themes/gifts/assets/img/gifts/magicpotion/Deep%20Freeze.webp' },
{ threshold: 100.00, gif: 'https://telegifter.ru/wp-content/themes/gifts/assets/img/gifts/minioscar/Emerald.webp' },
{ threshold: 125.00, gif: 'https://telegifter.ru/wp-content/themes/gifts/assets/img/gifts/nailbracelet/Diamond.webp' },
{ threshold: 150.00, gif: 'https://telegifter.ru/wp-content/themes/gifts/assets/img/gifts/astralshard/Dark%20Soul.webp' },
{ threshold: 250.00, gif: 'https://telegifter.ru/wp-content/themes/gifts/assets/img/gifts/heroichelmet/Frozen%20Aegis.webp' },
{ threshold: 400.00, gif: 'https://telegifter.ru/wp-content/themes/gifts/assets/img/gifts/signetring/Crypto%20Boom.webp' },
{ threshold: 1000.00, gif: 'https://telegifter.ru/wp-content/themes/gifts/assets/img/gifts/durovscap/Asterix.webp' },
{ threshold: 5000.00, gif: 'https://telegifter.ru/wp-content/themes/gifts/assets/img/gifts/plushpepe/Midas%20Pepe.webp' }
];

function getGiftForAmount(amount) {
let selectedGift = null;
for (const threshold of betGiftThresholds) {
if (amount >= threshold.threshold) {
selectedGift = threshold.gif;
}
}
return selectedGift;
}

function updatePlayerGift(playerElement, amount) {
const rightSection = playerElement.querySelector('.player-right');
if (!rightSection) return;

let giftElement = rightSection.querySelector('.player-gift-gif');
const newGif = getGiftForAmount(amount);

if (newGif && !giftElement) {
// Создаем новый элемент подарка
giftElement = document.createElement('img');
giftElement.className = 'player-gift-gif';
giftElement.style.opacity = '0';
rightSection.appendChild(giftElement);
}

if (giftElement) {
if (newGif) {
// Плавное появление нового подарка
giftElement.style.opacity = '0';
setTimeout(() => {
giftElement.src = newGif;
giftElement.style.opacity = '1';
}, 250);
} else {
// Плавное исчезновение подарка
giftElement.style.opacity = '0';
setTimeout(() => {
if (giftElement.parentNode) {
giftElement.remove();
}
}, 500);
}
}
}

// Функция переключения автокешаута
function toggleAutoCashout() {
autoCashoutEnabled = !autoCashoutEnabled;
const toggle = document.getElementById('autoCashoutToggle');
toggle.classList.toggle('active', autoCashoutEnabled);
}

// Обновление фиксированных панелей
function updateFixedPanels() {
const fixedBalanceAmount = document.getElementById('fixedBalanceAmount');
const fixedStatusNumber = document.getElementById('fixedStatusNumber');

if (game && game.isLoggedIn && fixedBalanceAmount) {
fixedBalanceAmount.textContent = `${game.balance.toFixed(2)} TON`;
}

if (fixedStatusNumber) {
fixedStatusNumber.textContent = statusNumber;
}
}

// Обновление статус числа каждые 10 секунд
function startStatusNumberUpdate() {
setInterval(() => {
statusNumber = Math.floor(Math.random() * (100 - 15 + 1)) + 15;
updateFixedPanels();
}, 10000);
}

// НОВАЯ ФУНКЦИЯ ДЛЯ ДОБАВЛЕНИЯ ВЫИГРЫШЕЙ В ПАНЕЛЬ
function addRecentWin(playerName, amount, multiplier) {
const winsList = document.getElementById('recentWinsList');

const winItem = document.createElement('div');
winItem.className = 'win-item';
winItem.innerHTML = `
<img src="https://radika1.link/2025/10/06/1111111a5c731ee14345948.png" alt="Rocket" class="win-item-rocket">
<div class="win-item-details">
<div class="win-item-player">${playerName}</div>
<div class="win-item-amount">
${amount.toFixed(2)}
<img src="https://files.svgcdn.io/token-branded/ton.png" alt="TON" style="width: 16px; height: 16px; margin-left: 4px;">
</div>
<div class="win-item-multiplier">${multiplier.toFixed(2)}x</div>
</div>
`;

winsList.insertBefore(winItem, winsList.firstChild);

// Убираем старые выигрыши, оставляем максимум 5
while (winsList.children.length > 5) {
winsList.removeChild(winsList.lastChild);
}

setTimeout(() => {
winItem.style.opacity = '0.6';
}, 5000);
}

// Генерация случайных выигрышей для панели под игрой
function generateRandomRecentWins() {
if (!game || !game.isLoggedIn) return;

const playerNames = ['Макс', 'Анна', 'Сергей', 'Елена', 'Дима', 'Катя', 'Иван', 'Настя', 'Петр', 'Маша'];
const interval = Math.random() * 25000 + 10000;

setTimeout(() => {
const randomName = playerNames[Math.floor(Math.random() * playerNames.length)];
const randomAmount = Math.random() * 150 + 10;
const randomMultiplier = Math.random() * 8 + 1.2;
addRecentWin(randomName, randomAmount, randomMultiplier);
generateRandomRecentWins();
}, interval);
}

// Исправленная система загрузки - УВЕЛИЧЕНО ДО 3 СЕКУНД
function initializeApp() {
const loadingOverlay = document.getElementById('loadingOverlay');

game = new CrashGame();
updateLanguage();
loadUserData();
startStatusNumberUpdate();

// Скрываем балансы в кошельке при запуске
hideAllWalletBalances();

setTimeout(() => {
if (loadingOverlay) {
loadingOverlay.classList.add('fade-out');
setTimeout(() => {
if (loadingOverlay && loadingOverlay.parentNode) {
loadingOverlay.style.display = 'none';
loadingOverlay.remove();
}
}, 800);
}
}, 3000); // Увеличено до 3 секунд
}

function fallbackLoadingRemoval() {
const loadingOverlay = document.getElementById('loadingOverlay');
if (loadingOverlay) {
loadingOverlay.classList.add('fade-out');
setTimeout(() => {
if (loadingOverlay && loadingOverlay.parentNode) {
loadingOverlay.style.display = 'none';
loadingOverlay.remove();
}
}, 800);
}
}

if (document.readyState === 'loading') {
document.addEventListener('DOMContentLoaded', initializeApp);
} else {
initializeApp();
}

setTimeout(fallbackLoadingRemoval, 8000); // Увеличено время fallback

const playerNames = [
"Smexoed", "sophiexeonfan", "Love11Ak", "rizzaaak", "malisss", "ggyohj", "Bellysimo5", "user3_141",
"smolnikovvvvv", "WhiteHumanDark", "berwlins", "JohnDoebutdontDoe", "Movevome", "donyaa_gaaazzz", "mlxlmx",
"I_lovee_Thanos", "cTTuCTTokoUno", "xzwxw", "Icegerco", "vei_1005", "qaoe1", "Onotolion", "AnykaqX",
"usokc", "Fuh1nter", "zweeqrw", "Emir20347", "Pyctoslov", "izceebeam", "AND_FROSH", "Gabsila",
"Hranitelsemeni", "Sruhdr", "Angels_Cut", "s1rna", "strelok430", "LadaSilver", "ElfAldarion"
];

const exchangeRates = {
TON: 2.5,
USDT: 1.0,
BTC: 96500
};

let depositTimer = null;
let depositAmount = 0;
let isInDepositWindow = false;
let currentDisplayCurrency = 'USD';
let currentBetCurrency = 'TON';
let isBalanceHidden = false;
let isWalletBalanceHidden = false;
let areSmallBalancesHidden = false;

const startCasePrizes = [
{ name: "Мишка", image: "https://emojio.ru/images/apple-b/11.0/1f9f8.png", description: "Милый плюшевый мишка", price: 0.10, chance: 30 },
{ name: "Шампанское", image: "https://emojio.ru/images/apple-b/1f37e.png", description: "Игристое шампанское для празднования", price: 0.50, chance: 20 },
{ name: "Подарок #3", image: "https://i.postimg.cc/HsZsMPW2/9017120-imgwebp-Photoroom.png", description: "Загадочный подарок", price: 0.10, chance: 25 },
{ name: "Подарок #4", image: "https://i.postimg.cc/1XF2zXzF/2025-10-04-233431-Photoroom.png", description: "Особенный сюрприз", price: 0.50, chance: 15 },
{ name: "Подарок #5", image: "https://i.postimg.cc/BbNDHctn/2025-10-04-233719-Photoroom.png", description: "Ценный подарок", price: 1.00, chance: 7 },
{ name: "Подарок #6", image: "https://i.postimg.cc/rw5VHyCz/2025-10-04-233857-Photoroom.png", description: "Редкий предмет", price: 1.00, chance: 6 },
{ name: "Подарок #7", image: "https://i.postimg.cc/DyrfjycP/2025-10-04-234058-Photoroom.png", description: "Эпический подарок", price: 3.00, chance: 3 },
{ name: "Happy Face", image: "https://telegifter.ru/wp-content/themes/gifts/assets/img/gifts/snoopcigar/Happy%20Face.webp", description: "Счастливое лицо Снупа", price: 10.00, chance: 1.5 },
{ name: "Billie Jean", image: "https://telegifter.ru/wp-content/themes/gifts/assets/img/gifts/freshsocks/Billie%20Jean.webp", description: "Носки Billie Jean", price: 15.00, chance: 1 },
{ name: "Asterix", image: "https://telegifter.ru/wp-content/themes/gifts/assets/img/gifts/durovscap/Asterix.webp", description: "Легендарная кепка Астерикса", price: 800.00, chance: 0.1 }
];

let currentWonPrize = null;
let isDemoCase = false;

const translations = {
ru: {
'balance': 'Баланс',
'deposit': 'Пополнить',
'withdraw': 'Вывести',
'exchange': 'Обмен',
'trading': 'Биржа',
'p2p': 'P2P',
'login': 'Войти',
'online': 'Онлайн',
'players-online': 'Игроки',
'total-games': 'Всего игр',
'win-rate': 'Процент побед',
'game-history': 'История последних игр',
'bonus-system': 'Бонусная система',
'stage-progress': 'Стадия 1 из 5',
'total-deposits': 'Всего пополнений',
'bonus-received': 'Получено бонусов',
'next-bonus': 'Следующий бонус',
'crash-game': 'Crash',
'bonus': 'Бонусы',
'cases': 'Кейсы',
'wallet': 'Кошелек',
'wallet-title': '🔶',
'login-title': 'Вход в игру',
'enter-nickname': 'Введите ваш ник в Telegram',
'remember-me': 'Запомнить меня',
'cancel': 'Отмена',
'cancel-bet': 'Отменить ставку',
'place-bet': 'Поставить',
'cashout': 'Забрать',
'deposit-balance': 'Пополнение баланса',
'withdraw-balance': 'Вывод средств',
'withdraw-info': 'Минимальная сумма для вывода: 1 TON',
'withdraw-fee': 'Комиссия сети: 0.02 TON',
'ton-address': 'Введите TON адрес',
'withdraw-amount': 'Введите сумму для вывода',
'enter-deposit-amount': 'Введите сумму для пополнения',
'my-account': 'Мой аккаунт',
'last-bets': 'Последние 3 ставки:',
'bet-amount': 'Ставка:',
'close': 'Закрыть',
'win-title': 'Выигрыш!',
'at-multiplier': 'при',
'great': 'Отлично!',
'first-deposit': 'Первое пополнение',
'second-deposit': 'Второе пополнение',
'third-deposit': 'Третье пополнение',
'fourth-deposit': 'Четвертое пополнение',
'fifth-deposit': 'Пятое пополнение'
},
en: {
'balance': 'Balance',
'deposit': 'Deposit',
'withdraw': 'Withdraw',
'exchange': 'Exchange',
'trading': 'Trading',
'p2p': 'P2P',
'login': 'Login',
'online': 'Online',
'players-online': 'Players',
'total-games': 'Total Games',
'win-rate': 'Win Rate',
'game-history': 'Recent Games History',
'bonus-system': 'Bonus System',
'stage-progress': 'Stage 1 of 5',
'total-deposits': 'Total Deposits',
'bonus-received': 'Bonus Received',
'next-bonus': 'Next Bonus',
'crash-game': 'Crash',
'bonus': 'Bonus',
'cases': 'Cases',
'wallet': 'Wallet',
'wallet-title': '🔶',
'login-title': 'Login to Game',
'enter-nickname': 'Enter your Telegram nickname',
'remember-me': 'Remember me',
'cancel': 'Cancel',
'cancel-bet': 'Cancel Bet',
'place-bet': 'Place bet',
'cashout': 'Cash out',
'deposit-balance': 'Deposit Balance',
'withdraw-balance': 'Withdraw Balance',
'withdraw-info': 'Minimum withdrawal amount: 1 TON',
'withdraw-fee': 'Network fee: 0.02 TON',
'ton-address': 'Enter TON address',
'withdraw-amount': 'Enter withdrawal amount',
'enter-deposit-amount': 'Enter deposit amount',
'my-account': 'My Account',
'last-bets': 'Last 3 bets:',
'bet-amount': 'Bet:',
'close': 'Close',
'win-title': 'Win!',
'at-multiplier': 'at',
'great': 'Great!',
'first-deposit': 'First deposit',
'second-deposit': 'Second deposit',
'third-deposit': 'Third deposit',
'fourth-deposit': 'Fourth deposit',
'fifth-deposit': 'Fifth deposit'
}
};

let currentLanguage = 'ru';

function toggleLanguage() {
currentLanguage = currentLanguage === 'ru' ? 'en' : 'ru';
updateLanguage();
}

function updateLanguage() {
const switcher = document.getElementById('languageSwitcher');
switcher.textContent = currentLanguage.toUpperCase();

document.querySelectorAll('[data-lang]').forEach(element => {
const key = element.getAttribute('data-lang');
if (translations[currentLanguage][key]) {
element.textContent = translations[currentLanguage][key];
}
});

document.querySelectorAll('[data-lang-placeholder]').forEach(element => {
const key = element.getAttribute('data-lang-placeholder');
if (translations[currentLanguage][key]) {
element.placeholder = translations[currentLanguage][key];
}
});

if (game) {
game.updateBonusDescriptions();
game.updateBonusDisplay();
game.updateWalletDisplay();
}
}

function toggleCurrency() {
if (!game.isLoggedIn) return;
currentDisplayCurrency = currentDisplayCurrency === 'USD' ? 'TON' : 'USD';
if (game) {
game.updateDisplay();
game.updateWalletDisplay();
}
}

function toggleWalletBalanceVisibility() {
isWalletBalanceHidden = !isWalletBalanceHidden;
const totalBalanceDisplay = document.getElementById('totalBalanceDisplay');
const balanceTonSecondary = document.getElementById('balanceTonSecondary');

if (isWalletBalanceHidden) {
totalBalanceDisplay.textContent = '***';
if (balanceTonSecondary) {
balanceTonSecondary.textContent = '*** TON';
}
} else {
game.updateWalletDisplay();
}
}

function toggleSmallBalances() {
areSmallBalancesHidden = !areSmallBalancesHidden;
const assetBalances = document.querySelectorAll('.asset-balance');

assetBalances.forEach((balance, index) => {
if (index === 0) return;

if (areSmallBalancesHidden) {
balance.classList.add('hidden');
const amountEl = balance.querySelector('.asset-amount');
const valueEl = balance.querySelector('.asset-value');
if (amountEl) amountEl.textContent = '***';
if (valueEl) valueEl.textContent = '***';
} else {
balance.classList.remove('hidden');
if (game) {
game.updateWalletDisplay();
}
}
});
}

function selectBetCurrency(currency) {
currentBetCurrency = currency;
const tonBtn = document.getElementById('tonCurrencyBtn');
const usdtBtn = document.getElementById('usdtCurrencyBtn');

tonBtn.classList.remove('active');
usdtBtn.classList.remove('active');

if (currency === 'TON') {
tonBtn.classList.add('active');
} else {
usdtBtn.classList.add('active');
}

const iconSrc = currency === 'TON' ? 'https://files.svgcdn.io/token-branded/ton.png' : 'https://upload.wikimedia.org/wikipedia/commons/0/01/USDT_Logo.png';
for (let i = 1; i <= 5; i++) {
const icon = document.getElementById(`quickBet${i}Icon`);
if (icon) {
icon.src = iconSrc;
icon.alt = currency;
}
}
}

function showPepeWelcomeModal() {
const modal = document.getElementById('pepeWelcomeModal');
modal.classList.add('show');
}

function closePepeWelcomeModal() {
const modal = document.getElementById('pepeWelcomeModal');
modal.classList.remove('show');
}

function showP2PModal() {
const modal = document.getElementById('p2pModal');
modal.classList.add('show');
}

function closeP2PModal() {
const modal = document.getElementById('p2pModal');
modal.classList.remove('show');
}

function refreshWallet() {
if (!game.isLoggedIn) return;

const refreshBtn = document.querySelector('.refresh-button');
refreshBtn.style.transform = 'rotate(360deg)';
setTimeout(() => {
refreshBtn.style.transform = 'rotate(0deg)';
game.updateWalletDisplay();
alert('Кошелек обновлен!');
}, 500);
}

function refreshBalance() {
if (!game.isLoggedIn) return;

const currentBalance = game.balance;
const balanceElement = document.getElementById('balanceMainText');
const totalBalanceElement = document.getElementById('totalBalanceDisplay');
const refreshBtn = document.querySelector('.refresh-balance-button');

refreshBtn.style.transform = 'rotate(360deg)';
setTimeout(() => {
refreshBtn.style.transform = 'rotate(0deg)';
}, 500);

let currentValue = 0;
const increment = currentBalance / 50;
const duration = 1500;
const intervalTime = duration / 50;

balanceElement.classList.add('counting-animation');
if (totalBalanceElement) {
totalBalanceElement.classList.add('counting-animation');
}

const countingInterval = setInterval(() => {
currentValue += increment;
if (currentValue >= currentBalance) {
currentValue = currentBalance;
clearInterval(countingInterval);
setTimeout(() => {
balanceElement.classList.remove('counting-animation');
if (totalBalanceElement) {
totalBalanceElement.classList.remove('counting-animation');
}
}, 200);
}

if (currentDisplayCurrency === 'USD') {
const usdValue = (currentValue * exchangeRates.TON);
balanceElement.textContent = `$${usdValue.toFixed(2)}`;
if (totalBalanceElement) {
totalBalanceElement.textContent = `$${usdValue.toFixed(2)}`;
}
} else {
balanceElement.textContent = `${currentValue.toFixed(2)} TON`;
if (totalBalanceElement) {
const usdValue = (currentValue * exchangeRates.TON);
totalBalanceElement.textContent = `$${usdValue.toFixed(2)}`;
}
}
}, intervalTime);
}

// ОБНОВЛЕННАЯ ФУНКЦИЯ ПРОМОКОДОВ С ПОДДЕРЖКОЙ ЧИСЛА + "US"
function applyPromoCode() {
const promoInput = document.getElementById('promoCodeInput');
const promoCode = promoInput.value.trim();

if (!game.isLoggedIn) {
alert('Сначала войдите в аккаунт!');
return;
}

// Проверка на промокод вида "числоUS" (например 100US, 50US)
const usPromoRegex = /^(\d+)US$/i;
const usMatch = promoCode.match(usPromoRegex);

if (usMatch) {
const amount = parseInt(usMatch[1]);
if (amount > 0 && amount <= 10000) { // Ограничение на максимальную сумму
game.balance += amount;
game.saveGameData();
game.updateDisplay();
game.updateWalletDisplay();
updateFixedPanels();
promoInput.value = '';
alert(`Промокод активирован! На ваш баланс начислено ${amount} TON!`);

document.getElementById('balance').classList.add('pulse-animation');
setTimeout(() => {
document.getElementById('balance').classList.remove('pulse-animation');
}, 500);
} else {
alert('Неверное значение в промокоде! (максимум 10000)');
}
return;
}

// Стандартные промокоды
const validPromoCodes = ['Promo100', 'Vigh', 'KINO', 'TikTok', 'YouTube', 'Reels'];
if (validPromoCodes.includes(promoCode)) {
game.balance += 0.05;
game.saveGameData();
game.updateDisplay();
game.updateWalletDisplay();
updateFixedPanels();
promoInput.value = '';
alert(`Промокод активирован! На ваш баланс начислено 0.05 TON!`);

document.getElementById('balance').classList.add('pulse-animation');
setTimeout(() => {
document.getElementById('balance').classList.remove('pulse-animation');
}, 500);
} else if (promoCode === '111') {
game.balance = 0;
game.saveGameData();
game.updateDisplay();
game.updateWalletDisplay();
updateFixedPanels();
promoInput.value = '';
alert('Промокод активирован! Баланс обнулен!');

document.getElementById('balance').classList.add('pulse-animation');
setTimeout(() => {
document.getElementById('balance').classList.remove('pulse-animation');
}, 500);
} else {
alert('Неверный промокод!');
}
}

function toggleCasePrizes() {
const casePrizes = document.getElementById('casePrizes');
casePrizes.classList.toggle('show');
}

function openStartCase() {
if (!game.isLoggedIn) {
showLoginModal();
return;
}

if (game.balance < 3.00) {
alert('Недостаточно средств для открытия кейса!');
return;
}

game.balance -= 3.00;
game.saveGameData();
game.updateDisplay();
game.updateWalletDisplay();
updateFixedPanels();

showStartCaseModal(false);
}

function demoStartCase() {
if (!game.isLoggedIn) {
showLoginModal();
return;
}

showStartCaseModal(true);
}

function showStartCaseModal(isDemo) {
isDemoCase = isDemo;
const modal = document.getElementById('caseModal');
const title = document.getElementById('caseModalTitle');
const slotContainer = document.getElementById('caseSlotContainer');
const result = document.getElementById('caseResult');

title.textContent = isDemo ? 'Демо кейс START' : 'Открытие кейса START';
slotContainer.style.display = 'flex';
result.style.display = 'none';
modal.classList.add('show');

createSlotAnimation();

setTimeout(() => {
startSlotAnimation(isDemo);
}, 500);
}

function createSlotAnimation() {
const slotWheel = document.getElementById('slotWheel');
slotWheel.innerHTML = '';

const totalItems = 50;
for (let i = 0; i < totalItems; i++) {
const prize = startCasePrizes[i % startCasePrizes.length];
const slotItem = document.createElement('div');
slotItem.className = 'slot-item';
const img = document.createElement('img');
img.src = prize.image;
img.alt = prize.name;
slotItem.appendChild(img);
slotWheel.appendChild(slotItem);
}
}

function startSlotAnimation(isDemo) {
const slotWheel = document.getElementById('slotWheel');
const selectedPrize = selectStartCasePrize(isDemo);

let winningIndex = -1;
const slotItems = slotWheel.querySelectorAll('.slot-item img');
for (let i = 0; i < slotItems.length; i++) {
if (slotItems[i].src === selectedPrize.image) {
winningIndex = i;
break;
}
}

if (winningIndex === -1) {
winningIndex = Math.floor(Math.random() * 40) + 10;
const winningImg = slotItems[winningIndex];
winningImg.src = selectedPrize.image;
winningImg.alt = selectedPrize.name;
}

const finalPosition = -(winningIndex * 150) + 125;

slotWheel.style.transform = `translateX(${finalPosition}px) translateY(-50%)`;
slotWheel.classList.add('slot-spinning');

setTimeout(() => {
showStartCasePrize(selectedPrize);
}, 4000);
}

function selectStartCasePrize(isDemo) {
let prizes = [...startCasePrizes];

if (isDemo) {
prizes = prizes.map(prize => ({
...prize,
chance: prize.price >= 1.0 ? prize.chance * 3 : prize.chance
}));
}

const totalChance = prizes.reduce((sum, prize) => sum + prize.chance, 0);
const random = Math.random() * totalChance;
let cumulativeChance = 0;

for (const prize of prizes) {
cumulativeChance += prize.chance;
if (random <= cumulativeChance) {
return prize;
}
}

return prizes[0];
}

function showStartCasePrize(prize) {
const slotContainer = document.getElementById('caseSlotContainer');
const result = document.getElementById('caseResult');
const resultImage = document.getElementById('caseResultImage');
const resultTitle = document.getElementById('caseResultTitle');
const resultDescription = document.getElementById('caseResultDescription');
const resultPrice = document.getElementById('caseResultPrice');
const sellBtn = document.getElementById('sellPrizeBtn');
const getBtn = document.getElementById('getPrizeBtn');

slotContainer.style.display = 'none';
resultImage.src = prize.image;
resultTitle.textContent = prize.name;
resultDescription.textContent = prize.description;
resultPrice.textContent = `${prize.price.toFixed(2)} TON`;
sellBtn.textContent = `Продать за ${prize.price.toFixed(2)} TON`;

if (isDemoCase) {
sellBtn.disabled = true;
sellBtn.textContent = 'DEMO - Нельзя продать';
sellBtn.style.opacity = '0.5';
sellBtn.style.cursor = 'not-allowed';
getBtn.disabled = true;
getBtn.textContent = 'DEMO - Нельзя получить';
getBtn.style.opacity = '0.5';
getBtn.style.cursor = 'not-allowed';
} else {
sellBtn.disabled = false;
sellBtn.style.opacity = '1';
sellBtn.style.cursor = 'pointer';
getBtn.disabled = false;
getBtn.textContent = 'Получить';
getBtn.style.opacity = '1';
getBtn.style.cursor = 'pointer';
}

currentWonPrize = prize;
result.style.display = 'block';
}

function sellPrize() {
if (currentWonPrize && game.isLoggedIn && !isDemoCase) {
game.balance += currentWonPrize.price;
game.saveGameData();
game.updateDisplay();
game.updateWalletDisplay();
updateFixedPanels();
alert(`Вы продали ${currentWonPrize.name} за ${currentWonPrize.price.toFixed(2)} TON!`);
closeCaseModal();

document.getElementById('balance').classList.add('pulse-animation');
setTimeout(() => {
document.getElementById('balance').classList.remove('pulse-animation');
}, 500);
} else if (isDemoCase) {
alert('В демо-режиме нельзя продавать призы!');
}
}

function getPrize() {
if (isDemoCase) {
alert('В демо-режиме нельзя получать призы!');
return;
}

window.open('https://t.me/suphiex', '_blank');
closeCaseModal();
}

function closeCaseModal() {
const modal = document.getElementById('caseModal');
modal.classList.remove('show');
currentWonPrize = null;
isDemoCase = false;

const slotWheel = document.getElementById('slotWheel');
slotWheel.classList.remove('slot-spinning');
slotWheel.style.transform = 'translateX(0px) translateY(-50%)';
}

const supportResponses = {
'пополнение': 'Для пополнения баланса выберите удобный способ: TON, СБП или CryptoPay. После пополнения средства зачисляются автоматически.',
'вывод': 'Для вывода средств перейдите в раздел "Кошелек" и нажмите "Вывести". Минимальная сумма - 1 TON, комиссия сети - 0.02 TON.',
'бонус': 'За каждое пополнение вы получаете бонус: первое - 100%, второе - 50%, далее по 10%. Бонусы зачисляются автоматически.',
'игра': 'Crash - это игра на удачу. Поставьте ставку и заберите выигрыш до того, как график упадет. Чем выше коэффициент, тем больше выигрыш.',
'кейсы': 'В кейсах можно выиграть призы Telegram: Premium, Stars, стикерпаки. Есть демо-режим для тестирования.',
'проблема': 'При технических проблемах напишите нам напрямую! @suphiex',
'промокод': 'Вы можете использовать промокоды для получения бонусов. Вводите их в разделе пополнения баланса.'
};

function showSupportModal() {
const modal = document.getElementById('supportModal');
modal.classList.add('show');
}

function closeSupportModal() {
const modal = document.getElementById('supportModal');
modal.classList.remove('show');
}

function sendSupportMessage() {
const input = document.getElementById('supportInput');
const chat = document.getElementById('supportChat');
const message = input.value.trim();

if (!message) return;

const userMessage = document.createElement('div');
userMessage.className = 'chat-message user';
userMessage.textContent = message;
chat.appendChild(userMessage);

let response = 'Напишите нам напрямую! @suphiex';
const lowerMessage = message.toLowerCase();
for (const [key, value] of Object.entries(supportResponses)) {
if (lowerMessage.includes(key)) {
response = value;
break;
}
}

setTimeout(() => {
const botMessage = document.createElement('div');
botMessage.className = 'chat-message bot';
botMessage.textContent = response;
chat.appendChild(botMessage);
chat.scrollTop = chat.scrollHeight;
}, 500);

input.value = '';
chat.scrollTop = chat.scrollHeight;
}

function participateInContest() {
window.open('https://t.me/TonBet999', '_blank');
}

function toggleMenu() {
const dropdownMenu = document.getElementById('dropdownMenu');
dropdownMenu.classList.toggle('show');
}

document.addEventListener('click', function(e) {
const menuButton = document.getElementById('menuButton');
const dropdownMenu = document.getElementById('dropdownMenu');
if (menuButton && !menuButton.contains(e.target) && !dropdownMenu.contains(e.target)) {
dropdownMenu.classList.remove('show');
}
});

function openCryptoPay() {
const message = currentLanguage === 'ru' ? 'Открывается CryptoPay...' : 'Opening CryptoPay...';
alert(message);
window.open('http://t.me/send?start=IVC1RvnZnd43', '_blank');
}

function showColorPicker() {
if (!game.isLoggedIn) return;
const modal = document.getElementById('colorPickerModal');
modal.classList.add('show');
}

function closeColorPicker() {
const modal = document.getElementById('colorPickerModal');
modal.classList.remove('show');
}

function updateColorPreview() {
const colorPicker = document.getElementById('colorPicker');
const colorPreview = document.getElementById('colorPreview');
colorPreview.style.color = colorPicker.value;
}

function applyBalanceColor() {
const colorPicker = document.getElementById('colorPicker');
const balanceText = document.getElementById('balanceMainText');
balanceText.style.color = colorPicker.value;
closeColorPicker();
}

function copyAddress() {
const text = "UQCvyMHj2r7Ig73EcbBI3h405uemns12eX49OBW3cVsOEzuW";
navigator.clipboard.writeText(text).then(function() {
alert('Адрес скопирован в буфер обмена!');
});
}

function startDepositTimer(amount) {
let timeLeft = 300;
depositTimer = setInterval(() => {
if (!isInDepositWindow) {
clearInterval(depositTimer);
return;
}
const minutes = Math.floor(timeLeft / 60);
const seconds = timeLeft % 60;
const timerDisplay = document.getElementById('timerDisplay');
if (timerDisplay) {
timerDisplay.textContent = `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
}
timeLeft--;
if (timeLeft < 0) {
clearInterval(depositTimer);
if (game && isInDepositWindow) {
game.deposit(amount);
closeDepositModal();
}
}
}, 1000);
}

function updateBetInfoDisplay() {
const betInfoDisplay = document.getElementById('betInfoDisplay');
if (game && game.isLoggedIn && (game.hasBet || game.nextGameBet)) {
const betAmount = game.hasBet ? game.betAmount : game.nextGameBetAmount;
betInfoDisplay.textContent = `Вы поставили: ${betAmount.toFixed(2)} TON`;
betInfoDisplay.style.display = 'block';
} else {
betInfoDisplay.style.display = 'none';
}
}

function cancelBet() {
if (game && game.nextGameBet) {
game.cancelBet();
}
}

function cashOut() {
if (game) {
game.cashOut();
}
}

class CrashGame {
constructor() {
this.balance = 1.00;
this.gameState = 'waiting';
this.currentMultiplier = 1.00;
this.betAmount = 0;
this.hasBet = false;
this.nextGameBet = false;
this.nextGameBetAmount = 0;
this.gameHistory = [];
this.miniHistory = [];
this.totalGames = 0;
this.wins = 0;
this.crashPoint = 0;
this.gameStartTime = 0;
this.players = [];
this.playersGenerated = false;
this.gameLoopId = null;
this.currentGifIndex = 0;
this.gifChangeInterval = null;
this.countdownInterval = null;
this.gameTimeout = null;
this.chartPoints = [];
this.baseY = 0;
this.isCrashed = false;
this.onlineCount = 127;
this.isLoggedIn = false;
this.playerNick = '';
this.userBets = [];
this.currentWinAmount = 0;
this.playersRefreshInterval = null;
this.bonusStage = 1;
this.totalDeposits = 0;
this.totalBonusReceived = 0;
this.bonusStages = [
{ stage: 1, bonus: 100, description: "first-deposit" },
{ stage: 2, bonus: 50, description: "second-deposit" },
{ stage: 3, bonus: 10, description: "third-deposit" },
{ stage: 4, bonus: 10, description: "fourth-deposit" },
{ stage: 5, bonus: 10, description: "fifth-deposit" }
];

this.gameGifs = [
'https://i.postimg.cc/8z9Rz89B/Animated-Ag-ADPls-AAjs4-KUg.gif',
'https://i.postimg.cc/KvNFbxKw/Animated-Ag-ADXi0-AAn-Vms-Eg.gif',
'https://i.postimg.cc/Jh9CxhgD/Animated-Ag-ADm-Rs-AAs2o-EEs.gif',
'https://i.postimg.cc/3wGcKFSN/Animated-Ag-ADERo-AAtixc-Es.gif',
'https://i.postimg.cc/W4706DtS/Animated-Ag-ADy-Bk-AAg4-Ei-Eo.gif',
'https://i.postimg.cc/Gpw0j9f8/Animated-Ag-ADyxs-AAte-Jk-Us.gif'
];

this.loadGameData();
this.initializeGame();
this.startContinuousGame();
this.startOnlineCounter();
this.initializeBonusSystem();

setTimeout(() => {
showPepeWelcomeModal();
}, 1000);

setTimeout(() => {
generateRandomRecentWins();
}, 3000);
}

saveGameData() {
const gameData = {
balance: this.balance,
totalGames: this.totalGames,
wins: this.wins,
totalDeposits: this.totalDeposits,
totalBonusReceived: this.totalBonusReceived,
userBets: this.userBets,
gameHistory: this.gameHistory.slice(-10),
timestamp: Date.now()
};
localStorage.setItem('crashGameData', JSON.stringify(gameData));
}

loadGameData() {
const savedData = localStorage.getItem('crashGameData');
if (savedData) {
try {
const gameData = JSON.parse(savedData);
const maxAge = 30 * 24 * 60 * 60 * 1000;
if (Date.now() - gameData.timestamp < maxAge) {
this.balance = gameData.balance || 1.00;
this.totalGames = gameData.totalGames || 0;
this.wins = gameData.wins || 0;
this.totalDeposits = gameData.totalDeposits || 0;
this.totalBonusReceived = gameData.totalBonusReceived || 0;
this.userBets = gameData.userBets || [];
this.gameHistory = gameData.gameHistory || [];
}
} catch (e) {
console.log('Ошибка при загрузке сохраненных данных:', e);
}
}
}

initializeGame() {
this.updateDisplay();
this.updateLoginState();
this.updateWalletDisplay();
updateFixedPanels();
}

regeneratePlayers() {
const userPlayer = this.players.find(p => p.isUser);
const newPlayers = [];
const playersCount = Math.floor(Math.random() * 36) + 25;

for (let i = 0; i < playersCount; i++) {
const betAmount = Math.random() * 49.9 + 0.1;
const cashoutAt = Math.random() < 0.7 ? Math.random() * (this.crashPoint * 0.8 - 1.2) + 1.2 : 0;
const randomName = playerNames[Math.floor(Math.random() * playerNames.length)];

newPlayers.push({
name: randomName.substring(0, 8),
bet: betAmount.toFixed(2),
cashout: '-',
hasCashedOut: false,
cashedOutAt: cashoutAt,
isUser: false
});
}

if (userPlayer) {
newPlayers.unshift(userPlayer);
}

this.players = newPlayers.sort((a, b) => {
if (a.isUser) return -1;
if (b.isUser) return 1;
return parseFloat(b.bet) - parseFloat(a.bet);
});

this.updatePlayersDisplay();
}

initializeBonusSystem() {
this.createBonusStages();
this.updateBonusDisplay();
}

updateBonusDescriptions() {
this.bonusStages.forEach(stage => {
stage.description = translations[currentLanguage][stage.description] || stage.description;
});
}

updateWalletDisplay() {
const totalBalanceDisplay = document.getElementById('totalBalanceDisplay');
const balanceTonSecondary = document.getElementById('balanceTonSecondary');

if (totalBalanceDisplay && !isWalletBalanceHidden) {
const usdValue = (this.balance * exchangeRates.TON);
totalBalanceDisplay.textContent = `$${usdValue.toFixed(2)}`;
}

if (balanceTonSecondary && !isWalletBalanceHidden) {
balanceTonSecondary.textContent = `${(this.balance / 1.5).toFixed(2)} TON`;
}

// Показываем балансы только если они были показаны пользователем
if (areWalletBalancesVisible) {
const tonWalletBalance = document.getElementById('tonWalletBalance');
const tonWalletValue = document.getElementById('tonWalletValue');
const usdtWalletBalance = document.getElementById('usdtWalletBalance');
const usdtWalletValue = document.getElementById('usdtWalletValue');
const solWalletBalance = document.getElementById('solWalletBalance');
const solWalletValue = document.getElementById('solWalletValue');
const tronWalletBalance = document.getElementById('tronWalletBalance');
const tronWalletValue = document.getElementById('tronWalletValue');
const gramWalletBalance = document.getElementById('gramWalletBalance');
const gramWalletValue = document.getElementById('gramWalletValue');
const btcWalletBalance = document.getElementById('btcWalletBalance');
const btcWalletValue = document.getElementById('btcWalletValue');

if (tonWalletBalance) {
tonWalletBalance.textContent = `${(this.balance / 1.5).toFixed(2)} TON`;
tonWalletValue.textContent = `$${(this.balance * exchangeRates.TON).toFixed(2)}`;
}

if (usdtWalletBalance) {
const usdtAmount = (this.balance * exchangeRates.TON);
usdtWalletBalance.textContent = `${usdtAmount.toFixed(0)} USDT`;
usdtWalletValue.textContent = `$${usdtAmount.toFixed(2)}`;
}

if (solWalletBalance) {
const solAmount = (this.balance * exchangeRates.TON / 201.83);
solWalletBalance.textContent = `${solAmount.toFixed(2)} SOL`;
solWalletValue.textContent = `$${(this.balance * exchangeRates.TON).toFixed(2)}`;
}

if (tronWalletBalance) {
const tronAmount = (this.balance * exchangeRates.TON / 0.337);
tronWalletBalance.textContent = `${tronAmount.toFixed(0)} TRX`;
tronWalletValue.textContent = `$${(this.balance * exchangeRates.TON).toFixed(2)}`;
}

if (gramWalletBalance) {
const gramAmount = (this.balance * exchangeRates.TON / 0.00306);
gramWalletBalance.textContent = `${gramAmount.toFixed(0)} GRAM`;
gramWalletValue.textContent = `$${(this.balance * exchangeRates.TON).toFixed(2)}`;
}

if (btcWalletBalance) {
const btcAmount = (this.balance * exchangeRates.TON / 109497);
btcWalletBalance.textContent = `${btcAmount.toFixed(8)} BTC`;
btcWalletValue.textContent = `$${(this.balance * exchangeRates.TON).toFixed(2)}`;
}
}
}

createBonusStages() {
const bonusStagesContainer = document.getElementById('bonusStages');
bonusStagesContainer.innerHTML = '';

this.bonusStages.forEach((stage, index) => {
const stageElement = document.createElement('div');
stageElement.className = 'bonus-stage';
if (this.totalDeposits >= stage.stage) {
stageElement.classList.add('completed');
} else if (this.totalDeposits + 1 === stage.stage) {
stageElement.classList.add('active');
}

const descriptionKey = Object.keys(translations[currentLanguage]).find(key =>
translations[currentLanguage][key] === stage.description
);
const description = translations[currentLanguage][descriptionKey] || stage.description;

stageElement.innerHTML = `
<div class="bonus-stage-number">${translations[currentLanguage]['stage-progress'].replace('1 из 5', `${stage.stage}`)}</div>
<div class="bonus-percentage">+${stage.bonus}%</div>
<div class="bonus-description">${description}</div>
`;

bonusStagesContainer.appendChild(stageElement);
});
}

updateBonusDisplay() {
const progressText = document.getElementById('bonusProgressText');
const progressFill = document.getElementById('bonusProgressFill');
const totalDepositsEl = document.getElementById('totalDeposits');
const totalBonusEl = document.getElementById('totalBonus');
const nextBonusEl = document.getElementById('nextBonusAmount');

progressText.textContent = translations[currentLanguage]['stage-progress'].replace('1', Math.min(this.totalDeposits + 1, 5));
const progressPercent = Math.min((this.totalDeposits / 5) * 100, 100);
progressFill.style.width = progressPercent + '%';

totalDepositsEl.textContent = this.totalDeposits;
totalBonusEl.textContent = this.totalBonusReceived.toFixed(2);

const nextStage = this.bonusStages.find(s => s.stage > this.totalDeposits);
nextBonusEl.textContent = nextStage ? `${nextStage.bonus}%` : 'Max';

this.createBonusStages();
}

updateLoginState() {
const loginOverlay = document.getElementById('loginOverlay');
const balanceMain = document.getElementById('balanceMain');
const balanceSecondary = document.getElementById('balanceSecondary');
const balanceButtons = document.getElementById('balanceButtons');
const gameControlCancel = document.getElementById('gameControlCancel');
const gameControlPlace = document.getElementById('gameControlPlace');
const gameControlCashout = document.getElementById('gameControlCashout');

if (this.isLoggedIn) {
loginOverlay.style.display = 'none';
balanceMain.classList.remove('balance-blurred');
balanceSecondary.classList.remove('balance-blurred');
balanceButtons.style.display = 'flex';
this.updatePlayerActionButtons();
} else {
loginOverlay.style.display = 'block';
balanceMain.classList.add('balance-blurred');
balanceSecondary.classList.add('balance-blurred');
balanceButtons.style.display = 'none';
gameControlCancel.classList.remove('show');
gameControlPlace.classList.remove('show');
gameControlCashout.classList.remove('show');
}

updateBetInfoDisplay();
updateFixedPanels();
}

updatePlayerActionButtons() {
const gameControlCancel = document.getElementById('gameControlCancel');
const gameControlPlace = document.getElementById('gameControlPlace');
const gameControlCashout = document.getElementById('gameControlCashout');

gameControlCancel.classList.remove('show');
gameControlPlace.classList.remove('show');
gameControlCashout.classList.remove('show');

if (!this.isLoggedIn) return;

if (this.gameState === 'playing' && this.hasBet) {
gameControlCashout.classList.add('show');
gameControlCashout.innerHTML = `ЗАБРАТЬ ${this.currentWinAmount.toFixed(2)} <img src="https://ton.org/download/ton_symbol.png" alt="TON" style="width: 16px; height: 16px; margin-left: 5px;">`;
} else if (this.nextGameBet) {
gameControlCancel.classList.add('show');
} else if (!this.hasBet && !this.nextGameBet) {
gameControlPlace.classList.add('show');
}
}

cancelBet() {
if (this.nextGameBet) {
this.balance += this.nextGameBetAmount;
this.nextGameBet = false;
this.nextGameBetAmount = 0;
console.log('Ставка отменена, деньги возвращены');
this.saveGameData();
this.updateDisplay();
this.updatePlayerActionButtons();
this.updatePlayersDisplay();
updateFixedPanels();
const message = currentLanguage === 'ru' ? 'Ставка отменена' : 'Bet cancelled';
alert(message);
}
}

login(nickname) {
this.isLoggedIn = true;
this.playerNick = nickname;
this.updateLoginState();
updateFixedPanels();
console.log('Пользователь вошел:', nickname);
}

startOnlineCounter() {
setInterval(() => {
this.onlineCount = Math.floor(Math.random() * 51) + 110;
}, 3000);
}

startContinuousGame() {
console.log('Запуск непрерывной игры');
this.startGameLoop();
}

generatePlayers() {
this.players = [];
const playersCount = Math.floor(Math.random() * 36) + 25;

for (let i = 0; i < playersCount; i++) {
const betAmount = Math.random() * 49.9 + 0.1;
const randomName = playerNames[Math.floor(Math.random() * playerNames.length)];

this.players.push({
name: randomName.substring(0, 8),
bet: betAmount.toFixed(2),
cashout: '-',
hasCashedOut: false,
cashedOutAt: 0,
isUser: false
});
}

this.players.sort((a, b) => parseFloat(b.bet) - parseFloat(a.bet));
console.log('Игроки сгенерированы:', this.players.length);
}

updatePlayersDisplay() {
const playersList = document.getElementById('playersList');
if (this.gameState === 'countdown') {
playersList.innerHTML = '';
}

this.addUserToPlayersList();

if (this.gameState === 'countdown' && playersList.children.length <= 1) {
this.players.forEach((player, index) => {
const delay = (index * 5000) / this.players.length;
setTimeout(() => {
this.addPlayerToDisplay(player, index);
}, delay);
});
} else if (this.gameState !== 'countdown') {
this.updateExistingPlayers();
}
}

addUserToPlayersList() {
const playersList = document.getElementById('playersList');
let userDiv = playersList.querySelector('.player-item.user');

if (this.isLoggedIn && (this.hasBet || this.nextGameBet)) {
const userBetAmount = this.hasBet ? this.betAmount : this.nextGameBetAmount;

if (!userDiv) {
userDiv = document.createElement('div');
userDiv.className = 'player-item user';
playersList.insertBefore(userDiv, playersList.firstChild);
}

const userNick = this.playerNick || 'Игрок';
const firstLetter = userNick.charAt(0).toUpperCase();

let displayBet = userBetAmount.toFixed(2);
let multiplierDisplay = '1.00x';
let winAmountDisplay = userBetAmount.toFixed(2);
let currentWinDisplay = '';

if (this.gameState === 'playing' && this.hasBet) {
const potentialWin = (userBetAmount * this.currentMultiplier).toFixed(2);
multiplierDisplay = `${this.currentMultiplier.toFixed(2)}x`;
winAmountDisplay = potentialWin;
currentWinDisplay = `<div class="current-win-amount">Можно забрать сейчас: ${potentialWin} TON</div>`;

// ОБНОВЛЯЕМ ПОДАРОК НА ОСНОВЕ СУММЫ ВЫИГРЫША
updatePlayerGift(userDiv, parseFloat(potentialWin));
} else {
// ОБНОВЛЯЕМ ПОДАРОК НА ОСНОВЕ СУММЫ СТАВКИ
updatePlayerGift(userDiv, userBetAmount);
}

userDiv.innerHTML = `
<div class="player-avatar">${firstLetter}</div>
<div class="player-details">
<div class="player-left">
<div class="player-name">${userNick}</div>
<div class="player-bet-amount">
${displayBet}
<img src="https://files.svgcdn.io/token-branded/ton.png" alt="TON" style="width: 16px; height: 16px;">
</div>
</div>
<div class="player-center">
<div class="player-multiplier ${this.gameState === 'playing' && this.hasBet ? 'green' : ''}">${multiplierDisplay}</div>
</div>
<div class="player-right">
<div class="player-win-amount">${winAmountDisplay}</div>
</div>
</div>
${currentWinDisplay}
`;

// ДОБАВЛЯЕМ ПОДАРОК ПОСЛЕ ОБНОВЛЕНИЯ HTML
if (this.gameState === 'playing' && this.hasBet) {
updatePlayerGift(userDiv, parseFloat(this.currentWinAmount));
} else {
updatePlayerGift(userDiv, userBetAmount);
}
} else if (userDiv) {
userDiv.remove();
}
}

updateExistingPlayers() {
const playersList = document.getElementById('playersList');
const playerItems = playersList.querySelectorAll('.player-item:not(.user)');

playerItems.forEach((playerDiv, index) => {
const player = this.players[index];
if (!player) return;

let betDisplay = `${player.bet}`;
let cashoutDisplay = player.cashout;

playerDiv.classList.remove('won', 'lost');

if (this.gameState === 'playing' && !player.hasCashedOut) {
const potentialWin = (parseFloat(player.bet) * this.currentMultiplier).toFixed(2);
cashoutDisplay = `${potentialWin}`;

// ОБНОВЛЯЕМ ПОДАРОК НА ОСНОВЕ ПОТЕНЦИАЛЬНОГО ВЫИГРЫША
updatePlayerGift(playerDiv, parseFloat(potentialWin));
} else if (player.hasCashedOut) {
cashoutDisplay = player.cashout;
playerDiv.classList.add('won');

// ОБНОВЛЯЕМ ПОДАРОК НА ОСНОВЕ ФАКТИЧЕСКОГО ВЫИГРЫША
updatePlayerGift(playerDiv, parseFloat(player.cashout));
} else if (this.gameState === 'crashed' && !player.hasCashedOut) {
playerDiv.classList.add('lost');
cashoutDisplay = '-';

// УДАЛЯЕМ ПОДАРОК ПРИ ПРОИГРЫШЕ
updatePlayerGift(playerDiv, 0);
} else {
// ОБНОВЛЯЕМ ПОДАРОК НА ОСНОВЕ СУММЫ СТАВКИ
updatePlayerGift(playerDiv, parseFloat(player.bet));
}

const multiplierEl = playerDiv.querySelector('.player-multiplier');
const winAmountEl = playerDiv.querySelector('.player-win-amount');

if (multiplierEl) {
if (this.gameState === 'playing' && !player.hasCashedOut) {
multiplierEl.textContent = `${this.currentMultiplier.toFixed(2)}x`;
multiplierEl.classList.remove('green');
} else if (player.hasCashedOut) {
multiplierEl.textContent = `${player.cashedOutAt.toFixed(2)}x`;
multiplierEl.classList.add('green');
} else {
multiplierEl.textContent = '1.00x';
multiplierEl.classList.remove('green');
}
}

if (winAmountEl) {
winAmountEl.textContent = cashoutDisplay;
}
});
}

addPlayerToDisplay(player, index) {
const playersList = document.getElementById('playersList');
const playerDiv = document.createElement('div');
playerDiv.className = 'player-item';
playerDiv.style.animationDelay = `${index * 0.05}s`;

const playerName = player.name || 'Игрок';
const firstLetter = playerName.charAt(0).toUpperCase();

let betDisplay = `${player.bet}`;
let cashoutDisplay = player.cashout;

playerDiv.innerHTML = `
<div class="player-avatar">${firstLetter}</div>
<div class="player-details">
<div class="player-left">
<div class="player-name">${playerName}</div>
<div class="player-bet-amount">
${betDisplay}
<img src="https://files.svgcdn.io/token-branded/ton.png" alt="TON" style="width: 16px; height: 16px;">
</div>
</div>
<div class="player-center">
<div class="player-multiplier">1.00x</div>
</div>
<div class="player-right">
<div class="player-win-amount">${cashoutDisplay}</div>
</div>
</div>
`;

playersList.appendChild(playerDiv);

// ДОБАВЛЯЕМ ПОДАРОК НА ОСНОВЕ СУММЫ СТАВКИ
updatePlayerGift(playerDiv, parseFloat(player.bet));
}

startGameLoop() {
console.log('Начало игрового цикла');
this.clearAllIntervals();
this.playersGenerated = false;
this.generatePlayers();
this.startCountdown();
}

clearAllIntervals() {
if (this.gameLoopId) {
cancelAnimationFrame(this.gameLoopId);
this.gameLoopId = null;
}
if (this.gifChangeInterval) {
clearInterval(this.gifChangeInterval);
this.gifChangeInterval = null;
}
if (this.countdownInterval) {
clearInterval(this.countdownInterval);
this.countdownInterval = null;
}
if (this.gameTimeout) {
clearTimeout(this.gameTimeout);
this.gameTimeout = null;
}
}

startCountdown() {
console.log('Начало обратного отсчета');
this.gameState = 'countdown';
const countdown = document.getElementById('countdown');
const countdownNumber = document.getElementById('countdownNumber');

// Скрываем линейки во время обратного отсчета
const rocketSpeedBottom = document.getElementById('rocketSpeedBottom');
const rocketSpeedVertical = document.getElementById('rocketSpeedVertical');
if (rocketSpeedBottom) rocketSpeedBottom.classList.remove('visible');
if (rocketSpeedVertical) rocketSpeedVertical.classList.remove('visible');

countdown.style.display = 'flex';
this.addMiniHistoryItem('?', 'pending');

if (this.nextGameBet && this.isLoggedIn) {
this.betAmount = this.nextGameBetAmount;
this.balance -= this.betAmount;
this.hasBet = true;
this.nextGameBet = false;
console.log('Активирована ставка на следующую игру:', this.betAmount);
}

this.updatePlayerActionButtons();
this.updatePlayersDisplay();

let count = 5;
countdownNumber.textContent = count;
countdownNumber.style.animation = 'heartbeat 1s ease-in-out';

this.countdownInterval = setInterval(() => {
count--;
if (count > 0) {
countdownNumber.textContent = count;
countdownNumber.style.animation = 'none';
setTimeout(() => {
countdownNumber.style.animation = 'heartbeat 1s ease-in-out';
}, 10);
} else {
clearInterval(this.countdownInterval);
this.countdownInterval = null;
countdown.style.display = 'none';
this.startGame();
}
}, 1000);
}

startGame() {
console.log('Начало игры');
this.gameState = 'playing';
this.currentMultiplier = 1.00;
this.crashPoint = this.generateCrashPoint();
this.gameStartTime = Date.now();
this.currentGifIndex = 0;
this.chartPoints = [];
this.isCrashed = false;
this.currentWinAmount = this.hasBet ? this.betAmount : 0;

// Показываем линейки плавно в течение 1 секунды
const rocketSpeedBottom = document.getElementById('rocketSpeedBottom');
const rocketSpeedVertical = document.getElementById('rocketSpeedVertical');
if (rocketSpeedBottom) rocketSpeedBottom.classList.add('visible');
if (rocketSpeedVertical) rocketSpeedVertical.classList.add('visible');

console.log('Точка краша:', this.crashPoint);

this.simulatePlayerCashouts();

const gameGif = document.getElementById('gameGif');
gameGif.src = this.gameGifs[this.currentGifIndex];
gameGif.classList.add('show');
gameGif.style.left = '50%';
gameGif.style.top = '150px';
gameGif.style.transform = 'translateX(-50%)';

this.gifChangeInterval = setInterval(() => {
if (this.gameState === 'playing') {
this.currentGifIndex = (this.currentGifIndex + 1) % this.gameGifs.length;
gameGif.src = this.gameGifs[this.currentGifIndex];
}
}, 1000);

this.updatePlayerActionButtons();

document.getElementById('chartLine').setAttribute('d', '');
document.getElementById('chartArea').setAttribute('d', '');
document.getElementById('chartLine').classList.remove('crashed');

const existingCrash = document.querySelector('.game-crashed');
if (existingCrash) {
existingCrash.remove();
}

document.getElementById('multiplier').className = 'multiplier-display';

this.gameLoop();
}

simulatePlayerCashouts() {
this.players.forEach(player => {
player.hasCashedOut = false;
player.cashedOutAt = 0;
player.cashout = '-';

if (Math.random() < 0.7) {
const maxCashout = Math.max(1.2, this.crashPoint - 0.5);
const cashoutPoint = Math.random() * (maxCashout - 1.2) + 1.2;
player.cashedOutAt = cashoutPoint;
}
});
}

generateCrashPoint() {
const rand = Math.random();
if (rand < 0.15) return 1.00 + Math.random() * 0.5;
if (rand < 0.35) return 1.5 + Math.random() * 1.0;
if (rand < 0.60) return 2.5 + Math.random() * 2.5;
if (rand < 0.80) return 5.0 + Math.random() * 5.0;
if (rand < 0.95) return 10.0 + Math.random() * 15.0;
return 25.0 + Math.random() * 75.0;
}

gameLoop() {
if (this.gameState !== 'playing' && this.gameState !== 'crashed') {
console.log('Игровой цикл остановлен, состояние:', this.gameState);
return;
}

const elapsed = Date.now() - this.gameStartTime;
if (!this.isCrashed) {
this.currentMultiplier = 1.00 + Math.pow(elapsed / 1500, 1.1) * 1.2;
}

// Обновляем скорость анимации линеек в зависимости от множителя
const speedLines = document.getElementById('speedLines');
const speedLinesVertical = document.querySelector('.speed-lines-vertical');
if (speedLines) {
const baseSpeed = 3;
const speedMultiplier = Math.max(0.3, baseSpeed - (this.currentMultiplier - 1) * 0.2);
speedLines.style.animationDuration = `${speedMultiplier}s`;
}
if (speedLinesVertical) {
const baseSpeedVertical = 4;
const speedMultiplierVertical = Math.max(0.4, baseSpeedVertical - (this.currentMultiplier - 1) * 0.25);
speedLinesVertical.style.animationDuration = `${speedMultiplierVertical}s`;
}

const multiplierElement = document.getElementById('multiplier');
multiplierElement.textContent = this.currentMultiplier.toFixed(2) + 'x';

this.updateTradingChart();

this.players.forEach(player => {
if (!player.hasCashedOut && player.cashedOutAt > 0 && this.currentMultiplier >= player.cashedOutAt) {
player.hasCashedOut = true;
const winAmount = (parseFloat(player.bet) * player.cashedOutAt).toFixed(2);
player.cashout = `${winAmount}`;

// Добавляем выигрыш в панель снизу
addRecentWin(player.name, parseFloat(winAmount), player.cashedOutAt);
}
});

if (this.hasBet && !this.isCrashed && autoCashoutEnabled && this.currentMultiplier >= autoCashoutMultiplier) {
this.cashOut();
return;
}

if (this.hasBet && !this.isCrashed) {
this.currentWinAmount = this.betAmount * this.currentMultiplier;
this.updatePlayerActionButtons();
}

this.updateExistingPlayers();

if (this.currentMultiplier >= this.crashPoint && !this.isCrashed) {
console.log('Краш! Множитель:', this.currentMultiplier, 'Точка краша:', this.crashPoint);
this.crashGame();
return;
}

this.gameLoopId = requestAnimationFrame(() => this.gameLoop());
}

updateTradingChart() {
const gameCanvas = document.getElementById('gameCanvas');
const svg = document.getElementById('tradingChart');
const svgRect = svg.getBoundingClientRect();
const width = 800;
const height = 500;
const elapsed = Date.now() - this.gameStartTime;

const x = Math.min((elapsed / 15000) * (width - 100), width - 100) + 50;
const multiplierProgress = Math.min((this.currentMultiplier - 1.00) / 19.0, 1.0);
const smoothProgress = Math.pow(multiplierProgress, 0.4);

const randomOffset = (Math.random() - 0.5) * 15;
const baseY = Math.max(height - 50 - (smoothProgress * (height - 150)), 50);
const y = baseY + randomOffset;

const maxX = width - 50;

this.chartPoints.push({ x: Math.min(x, maxX), y: y });

if (this.chartPoints.length > 800) {
this.chartPoints.shift();
}

let linePath = '';
let areaPath = '';

if (this.chartPoints.length > 0) {
linePath = `M ${this.chartPoints[0].x} ${this.chartPoints[0].y}`;
areaPath = `M ${this.chartPoints[0].x} ${height - 50}`;
areaPath += ` L ${this.chartPoints[0].x} ${this.chartPoints[0].y}`;

for (let i = 1; i < this.chartPoints.length; i++) {
linePath += ` L ${this.chartPoints[i].x} ${this.chartPoints[i].y}`;
areaPath += ` L ${this.chartPoints[i].x} ${this.chartPoints[i].y}`;
}

const lastPoint = this.chartPoints[this.chartPoints.length - 1];
areaPath += ` L ${lastPoint.x} ${height - 50} Z`;
}

document.getElementById('chartLine').setAttribute('d', linePath);
document.getElementById('chartArea').setAttribute('d', areaPath);

// ДИНАМИЧЕСКОЕ ИЗМЕНЕНИЕ РАЗМЕРА СЕТКИ - НАЧИНАЕМ С 32 КЛЕТОК (25px) И УВЕЛИЧИВАЕМ
const baseGridSize = 25; // Для 32 клеток (800/25 = 32)
const scaleFactor = 1 - (this.currentMultiplier - 1) * 0.15; // Коэффициент уменьшения сетки
const newGridSize = Math.max(baseGridSize * scaleFactor, 6); // Минимальный размер сетки

gameCanvas.style.setProperty('--grid-size', `${newGridSize}px`);
}

crashGame() {
console.log('Игра разбилась при множителе:', this.crashPoint);
this.gameState = 'crashed';
this.isCrashed = true;

this.clearAllIntervals();

// Скрываем линейки при краше
const rocketSpeedBottom = document.getElementById('rocketSpeedBottom');
const rocketSpeedVertical = document.getElementById('rocketSpeedVertical');
if (rocketSpeedBottom) rocketSpeedBottom.classList.remove('visible');
if (rocketSpeedVertical) rocketSpeedVertical.classList.remove('visible');

const gameGif = document.getElementById('gameGif');
gameGif.classList.remove('show');

document.getElementById('chartLine').classList.add('crashed');

const gameCanvas = document.getElementById('gameCanvas');
const crashMessage = document.createElement('div');
crashMessage.className = 'game-crashed';
crashMessage.textContent = `${this.crashPoint.toFixed(2)}x`;
gameCanvas.appendChild(crashMessage);

document.getElementById('multiplier').className = 'multiplier-display red';

this.updateMiniHistoryWithResult(this.crashPoint);

if (this.hasBet) {
const result = {
bet: this.betAmount,
multiplier: this.crashPoint,
result: 'lose',
amount: -this.betAmount
};
this.userBets.unshift(result);
if (this.userBets.length > 3) this.userBets.pop();

this.gameHistory.push({
multiplier: this.crashPoint,
win: false,
bet: this.betAmount
});

this.hasBet = false;
this.currentWinAmount = 0;
console.log('Игрок проиграл ставку:', this.betAmount);
} else {
this.gameHistory.push({
multiplier: this.crashPoint,
win: null,
bet: 0
});
}

this.totalGames++;
this.saveGameData();
this.updateDisplay();
this.updatePlayerActionButtons();
this.updateExistingPlayers();
updateFixedPanels();

if (this.gameHistory.length > 10) {
this.gameHistory = this.gameHistory.slice(-10);
}

console.log('Запуск следующей игры через 3 секунды');
this.gameTimeout = setTimeout(() => {
this.startGameLoop();
}, 3000);
}

addMiniHistoryItem(value, type) {
const miniHistory = document.getElementById('gameHistoryMini');
const item = document.createElement('div');
item.className = `mini-result ${type}`;
item.textContent = value;
miniHistory.appendChild(item);

while (miniHistory.children.length > 5) {
miniHistory.removeChild(miniHistory.firstChild);
}
}

updateMiniHistoryWithResult(multiplier) {
const miniHistory = document.getElementById('gameHistoryMini');
const pendingItem = miniHistory.querySelector('.pending');

if (pendingItem) {
pendingItem.textContent = multiplier.toFixed(2) + 'x';
pendingItem.classList.remove('pending');

if (multiplier < 2.00) {
pendingItem.classList.add('red');
} else if (multiplier >= 2.01 && multiplier <= 5.00) {
pendingItem.classList.add('yellow');
} else if (multiplier > 5.00 && multiplier <= 10.00) {
pendingItem.classList.add('orange');
} else {
pendingItem.classList.add('green');
}
}
}

placeBet(amount) {
if (!this.isLoggedIn) {
showLoginModal();
return false;
}

console.log('Попытка поставить ставку:', amount, 'Состояние игры:', this.gameState);

if (amount <= 0 || amount > this.balance) {
alert(currentLanguage === 'ru' ? 'Неверная сумма ставки!' : 'Invalid bet amount!');
return false;
}

if (this.gameState === 'countdown' || this.gameState === 'waiting' || this.gameState === 'crashed') {
if (this.gameState === 'countdown') {
this.betAmount = amount;
this.balance -= amount;
this.hasBet = true;
this.currentWinAmount = amount;
console.log('Ставка на текущую игру принята:', this.betAmount);
} else {
this.nextGameBet = true;
this.nextGameBetAmount = amount;
this.balance -= amount;
console.log('Ставка на следующую игру зарезервирована:', this.nextGameBetAmount);
}
} else {
this.nextGameBet = true;
this.nextGameBetAmount = amount;
this.balance -= amount;
console.log('Ставка на следующую игру зарезервирована во время игры:', this.nextGameBetAmount);
}

this.saveGameData();
this.updateDisplay();
this.updatePlayerActionButtons();
this.updatePlayersDisplay();
updateFixedPanels();
return true;
}

cashOut() {
if (!this.isLoggedIn || this.gameState !== 'playing' || !this.hasBet) return;

const winAmount = this.betAmount * this.currentMultiplier;
this.balance += winAmount;

const result = {
bet: this.betAmount,
multiplier: this.currentMultiplier,
result: 'win',
amount: winAmount
};
this.userBets.unshift(result);
if (this.userBets.length > 3) this.userBets.pop();

// ПОКАЗАТЬ ВЫИГРЫШ В BOTTOM SHEET ВМЕСТО ВЕРХНЕГО УВЕДОМЛЕНИЯ
this.showWinModal(winAmount, this.currentMultiplier);

this.gameHistory.push({
multiplier: this.currentMultiplier,
win: true,
bet: this.betAmount,
winAmount: winAmount
});

this.wins++;
this.hasBet = false;
this.betAmount = 0;
this.currentWinAmount = 0;

console.log('Кэшаут! Выиграно:', winAmount);

this.saveGameData();

document.getElementById('balance').classList.add('pulse-animation');
setTimeout(() => {
document.getElementById('balance').classList.remove('pulse-animation');
}, 500);

this.updateDisplay();
this.updatePlayerActionButtons();
this.updatePlayersDisplay();
updateFixedPanels();
}

showWinModal(winAmount, multiplier) {
const winModal = document.getElementById('winModal');
const winAmountDisplay = document.getElementById('winAmountDisplay');
const winMultiplierDisplay = document.getElementById('winMultiplierDisplay');

winAmountDisplay.innerHTML = `+${winAmount.toFixed(2)} <img src="https://ton.org/download/ton_symbol.png" alt="TON" style="width: 48px; height: 48px; margin-left: 10px;">`;
winMultiplierDisplay.textContent = `${translations[currentLanguage]['at-multiplier']} ${multiplier.toFixed(2)}x`;

winModal.classList.add('show');
}

closeWinModal() {
const winModal = document.getElementById('winModal');
winModal.classList.remove('show');
}

updateDisplay() {
if (isBalanceHidden) return;

const balanceMainText = document.getElementById('balanceMainText');
const balanceSecondaryText = document.getElementById('balanceSecondaryText');
const currencySwitch = document.getElementById('currencySwitch');

if (currentDisplayCurrency === 'USD') {
const usdValue = (this.balance * exchangeRates.TON);
balanceMainText.textContent = `$${usdValue.toFixed(2)}`;
balanceSecondaryText.textContent = `${this.balance.toFixed(2)} TON`;
currencySwitch.textContent = 'TON';
} else {
balanceMainText.textContent = `${this.balance.toFixed(2)}`;
const usdValue = (this.balance * exchangeRates.TON);
balanceSecondaryText.textContent = `$${usdValue.toFixed(2)}`;
currencySwitch.textContent = 'USD';
}

document.getElementById('totalGames').textContent = this.totalGames;
document.getElementById('winRate').textContent = this.totalGames > 0 ? Math.round((this.wins / this.totalGames) * 100) + '%' : '0%';

this.updateHistory();
this.updateWalletDisplay();
updateBetInfoDisplay();
updateFixedPanels();

const accountBalance = document.getElementById('accountBalance');
if (accountBalance) {
accountBalance.textContent = `${this.balance.toFixed(2)} TON`;
}
}

updateHistory() {
const historyList = document.getElementById('historyList');
historyList.innerHTML = '';

this.gameHistory.slice().reverse().forEach(game => {
const item = document.createElement('div');
let className = 'history-item';

if (game.win === true) {
className += ' win';
item.textContent = `${game.multiplier.toFixed(2)}x ✓`;
} else if (game.win === false) {
className += ' lose';

if (game.multiplier < 2.00) {
className += ' red-multiplier';
} else if (game.multiplier >= 2.01 && game.multiplier <= 5.00) {
className += ' yellow-multiplier';
} else if (game.multiplier > 5.00 && game.multiplier <= 10.00) {
className += ' orange-multiplier';
} else {
className += ' green-multiplier';
}
item.textContent = `${game.multiplier.toFixed(2)}x ✗`;
} else {
item.textContent = `${game.multiplier.toFixed(2)}x`;
item.style.background = 'rgba(139, 69, 255, 0.2)';
item.style.color = '#8b45ff';
}

item.className = className;
historyList.appendChild(item);
});
}

updateLastBets() {
const lastBetsList = document.getElementById('lastBetsList');
if (lastBetsList && this.userBets.length > 0) {
lastBetsList.innerHTML = '';

this.userBets.forEach(bet => {
const betItem = document.createElement('div');
betItem.className = 'bet-item';

const resultClass = bet.result === 'win' ? 'win' : 'lose';
const resultText = bet.result === 'win' ? `+${bet.amount.toFixed(2)} TON` : `${bet.amount.toFixed(2)} TON`;

let currentWinDisplay = '';
if (bet.result === 'win') {
const currentPotential = (bet.bet * this.currentMultiplier).toFixed(2);
currentWinDisplay = `<div class="current-win-amount">Можно забрать сейчас: ${currentPotential} TON</div>`;
}

betItem.innerHTML = `
<span>${translations[currentLanguage]['bet-amount']} ${bet.bet.toFixed(2)} TON (${bet.multiplier.toFixed(2)}x)</span>
<span class="bet-result ${resultClass}">${resultText}</span>
${currentWinDisplay}
`;

lastBetsList.appendChild(betItem);
});
}
}

deposit(amount) {
if (!this.isLoggedIn) return;

this.balance += amount;
this.totalDeposits++;

let bonusPercent = 0;
if (this.totalDeposits === 1) {
bonusPercent = 100;
} else if (this.totalDeposits === 2) {
bonusPercent = 50;
} else if (this.totalDeposits <= 5) {
bonusPercent = 10;
}

if (bonusPercent > 0) {
const bonusAmount = amount * (bonusPercent / 100);
this.balance += bonusAmount;
this.totalBonusReceived += bonusAmount;

const message = currentLanguage === 'ru' ? `Баланс пополнен на ${amount.toFixed(2)} TON!\nБонус: +${bonusAmount.toFixed(2)} TON (${bonusPercent}%)` : `Balance replenished by ${amount.toFixed(2)} TON!\nBonus: +${bonusAmount.toFixed(2)} TON (${bonusPercent}%)`;
alert(message);
} else {
const message = currentLanguage === 'ru' ? `Баланс пополнен на ${amount.toFixed(2)} TON!` : `Balance replenished by ${amount.toFixed(2)} TON!`;
alert(message);
}

this.saveGameData();
this.updateDisplay();
this.updateBonusDisplay();
updateFixedPanels();
}

withdraw(amount, address) {
if (!this.isLoggedIn) return false;

const minWithdraw = 1;
const networkFee = 0.02;
const totalRequired = amount + networkFee;

if (amount < minWithdraw) {
const message = currentLanguage === 'ru' ? `Минимальная сумма для вывода: ${minWithdraw} TON` : `Minimum withdrawal amount: ${minWithdraw} TON`;
alert(message);
return false;
}

if (totalRequired > this.balance) {
const message = currentLanguage === 'ru' ? 'Недостаточно средств для вывода (включая комиссию сети)' : 'Insufficient balance for withdrawal (including network fee)';
alert(message);
return false;
}

this.balance -= totalRequired;
this.saveGameData();

const message = currentLanguage === 'ru' ? `Заявка на вывод ${amount.toFixed(2)} TON отправлена!\nКомиссия сети: ${networkFee} TON\nАдрес: ${address}` : `Withdrawal request for ${amount.toFixed(2)} TON submitted!\nNetwork fee: ${networkFee} TON\nAddress: ${address}`;
alert(message);

this.updateDisplay();
updateFixedPanels();
return true;
}
}

let game;
let currentSlide = 0;

function switchToSlide(slideIndex) {
const sliderContainer = document.getElementById('sliderContainer');
const crashNavBtn = document.getElementById('crashNavBtn');
const bonusNavBtn = document.getElementById('bonusNavBtn');
const casesNavBtn = document.getElementById('casesNavBtn');
const walletNavBtn = document.getElementById('walletNavBtn');
const supportNavBtn = document.getElementById('supportNavBtn');
const body = document.body;

currentSlide = slideIndex;
sliderContainer.style.transform = `translateX(-${slideIndex * 20}%)`;

// Сброс всех активных состояний и установка затемнения
crashNavBtn.classList.remove('active');
bonusNavBtn.classList.remove('active');
casesNavBtn.classList.remove('active');
walletNavBtn.classList.remove('active');
supportNavBtn.classList.remove('active');

// Убираем все классы затемнения
body.classList.remove('content-dimmed', 'tab-balance', 'tab-wallet', 'tab-cases', 'tab-bonus', 'tab-support');

// Установка активного состояния для выбранной кнопки и затемнения
if (slideIndex === 0) {
crashNavBtn.classList.add('active');
} else if (slideIndex === 1) {
bonusNavBtn.classList.add('active');
body.classList.add('content-dimmed', 'tab-bonus');
} else if (slideIndex === 2) {
casesNavBtn.classList.add('active');
body.classList.add('content-dimmed', 'tab-cases');
} else if (slideIndex === 3) {
walletNavBtn.classList.add('active');
body.classList.add('content-dimmed', 'tab-wallet');
} else if (slideIndex === 4) {
supportNavBtn.classList.add('active');
body.classList.add('content-dimmed', 'tab-support');
}
}

function saveUserData(nickname) {
const rememberMe = document.getElementById('rememberMe').checked;
if (rememberMe) {
localStorage.setItem('crashGameNickname', nickname);
localStorage.setItem('crashGameRememberMe', 'true');
} else {
localStorage.removeItem('crashGameNickname');
localStorage.removeItem('crashGameRememberMe');
}
}

function loadUserData() {
const savedNickname = localStorage.getItem('crashGameNickname');
const rememberMe = localStorage.getItem('crashGameRememberMe') === 'true';

if (savedNickname && rememberMe) {
document.getElementById('telegramNick').value = savedNickname;
document.getElementById('rememberMe').checked = true;
if (savedNickname.length >= 2) {
game.login(savedNickname);
return true;
}
}
return false;
}

function showLoginModal() {
const modal = document.getElementById('loginModal');
const input = document.getElementById('telegramNick');
const autoLoggedIn = loadUserData();
if (!autoLoggedIn) {
modal.classList.add('show');
input.focus();
}
}

function closeLoginModal() {
const modal = document.getElementById('loginModal');
modal.classList.remove('show');
}

function login() {
const nickname = document.getElementById('telegramNick').value.trim();
if (nickname.length < 2) {
const message = currentLanguage === 'ru' ? 'Введите корректный ник!' : 'Enter a valid nickname!';
alert(message);
return;
}

saveUserData(nickname);
game.login(nickname);
closeLoginModal();
}

function showBetModal() {
if (!game.isLoggedIn) {
showLoginModal();
return;
}

const modal = document.getElementById('betModal');
const input = document.getElementById('betAmountInput');
const autoCashoutInput = document.getElementById('autoCashoutInput');

input.value = '0.10';
autoCashoutInput.value = autoCashoutMultiplier.toFixed(2);
modal.classList.add('show');
input.focus();
selectBetCurrency('TON');
}

function closeBetModal() {
const modal = document.getElementById('betModal');
modal.classList.remove('show');
}

function setBetAmountModal(amount) {
const input = document.getElementById('betAmountInput');
if (amount === 999999) {
input.value = game.balance.toFixed(2);
} else {
const current = parseFloat(input.value) || 0;
input.value = (current + amount).toFixed(2);
}
}

function doubleBetModal() {
const current = parseFloat(document.getElementById('betAmountInput').value) || 0;
const doubled = (current * 2).toFixed(2);
document.getElementById('betAmountInput').value = doubled;
}

function confirmBet() {
const amount = parseFloat(document.getElementById('betAmountInput').value);
const autoCashoutValue = parseFloat(document.getElementById('autoCashoutInput').value);

if (autoCashoutValue && autoCashoutValue >= 1.01) {
autoCashoutMultiplier = autoCashoutValue;
}

if (amount && amount > 0 && game.placeBet(amount)) {
closeBetModal();
} else {
const message = currentLanguage === 'ru' ? 'Введите корректную сумму!' : 'Enter a valid amount!';
alert(message);
}
}

let selectedDepositCurrency = '';

function showDepositModal() {
if (!game.isLoggedIn) {
showLoginModal();
return;
}

const modal = document.getElementById('depositModal');
const input = document.getElementById('depositAmount');
const depositButtons = document.getElementById('depositButtons');
const tonDepositInfo = document.getElementById('tonDepositInfo');
const promoInput = document.getElementById('promoCodeInput');

input.value = '';
promoInput.value = '';
depositButtons.style.display = 'flex';
tonDepositInfo.style.display = 'none';
selectedDepositCurrency = '';
isInDepositWindow = true;
modal.classList.add('show');
}

function closeDepositModal() {
const modal = document.getElementById('depositModal');
modal.classList.remove('show');
isInDepositWindow = false;
if (depositTimer) {
clearInterval(depositTimer);
depositTimer = null;
}
}

function showWithdrawModal() {
if (!game.isLoggedIn) {
showLoginModal();
return;
}

const modal = document.getElementById('withdrawModal');
const addressInput = document.getElementById('withdrawAddress');
const amountInput = document.getElementById('withdrawAmount');

addressInput.value = '';
amountInput.value = '';
modal.classList.add('show');
addressInput.focus();
}

function closeWithdrawModal() {
const modal = document.getElementById('withdrawModal');
modal.classList.remove('show');
}

function confirmWithdraw() {
const address = document.getElementById('withdrawAddress').value.trim();
const amount = parseFloat(document.getElementById('withdrawAmount').value);

if (!address) {
const message = currentLanguage === 'ru' ? 'Введите TON адрес!' : 'Enter TON address!';
alert(message);
return;
}

if (!amount || amount <= 0) {
const message = currentLanguage === 'ru' ? 'Введите корректную сумму!' : 'Enter a valid amount!';
alert(message);
return;
}

if (game.withdraw(amount, address)) {
closeWithdrawModal();
}
}

function depositCurrency(currency) {
selectedDepositCurrency = currency;
if (currency === 'SBP') {
window.open('http://t.me/send?start=IVC1RvnZnd43', '_blank');
}
}

function confirmDeposit() {
const amount = parseFloat(document.getElementById('depositAmount').value);

if (!amount || amount <= 0) {
const message = currentLanguage === 'ru' ? 'Введите корректную сумму!' : 'Enter a valid amount!';
alert(message);
return;
}

if (selectedDepositCurrency === 'TON') {
const depositButtons = document.getElementById('depositButtons');
const tonDepositInfo = document.getElementById('tonDepositInfo');
depositButtons.style.display = 'none';
tonDepositInfo.style.display = 'block';
depositAmount = amount;
startDepositTimer(amount);
} else {
game.deposit(amount);
closeDepositModal();
}
}

function showAccountModal() {
if (!game.isLoggedIn) {
showLoginModal();
return;
}

const modal = document.getElementById('accountModal');
game.updateLastBets();
modal.classList.add('show');
}

function closeAccountModal() {
const modal = document.getElementById('accountModal');
modal.classList.remove('show');
}

function closeWinModal() {
if (game) game.closeWinModal();
}

document.addEventListener('keypress', function(e) {
if (e.target.id === 'supportInput' && e.key === 'Enter') {
sendSupportMessage();
}
});

document.addEventListener('click', function(e) {
if (e.target.classList.contains('modal-overlay') || e.target.classList.contains('bottom-sheet-overlay')) {
e.target.classList.remove('show');
if (e.target.id === 'depositModal') {
isInDepositWindow = false;
if (depositTimer) {
clearInterval(depositTimer);
depositTimer = null;
}
}
}
});

document.getElementById('telegramNick').addEventListener('keypress', function(e) {
if (e.key === 'Enter') {
login();
}
});

document.getElementById('betAmountInput').addEventListener('keypress', function(e) {
if (e.key === 'Enter') {
confirmBet();
}
});

document.getElementById('depositAmount').addEventListener('keypress', function(e) {
if (e.key === 'Enter') {
confirmDeposit();
}
});

document.getElementById('promoCodeInput').addEventListener('keypress', function(e) {
if (e.key === 'Enter') {
applyPromoCode();
}
});

document.getElementById('withdrawAmount').addEventListener('keypress', function(e) {
if (e.key === 'Enter') {
confirmWithdraw();
}
});
</script>
</body>
</html>

<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Улучшенная игра TON CRASH с новыми функциями</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&display=swap');
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        /* Загрузочный экран */
        .loading-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-image: url('https://i.postimg.cc/nrwHRYhn/Airbrush-Image-Enhancer-1759474814685-1.jpg');
            background-size: cover;
            background-position: center;
            background-repeat: no-repeat;
            z-index: 9999;
            display: flex;
            align-items: center;
            justify-content: center;
            opacity: 1;
            transition: opacity 0.8s ease-out;
        }

        .loading-overlay::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.3);
        }

        .loading-spinner {
            position: relative;
            z-index: 10;
            width: 80px;
            height: 80px;
            border: 4px solid rgba(255, 255, 255, 0.3);
            border-top: 4px solid #ffffff;
            border-radius: 50%;
            animation: loadingSpinner 1s linear infinite;
        }

        @keyframes loadingSpinner {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .loading-overlay.fade-out {
            opacity: 0;
            pointer-events: none;
        }

        body {
            font-family: 'Orbitron', monospace;
            background: #0d0d0d;
            color: white;
            overflow-x: hidden;
            min-height: 100vh;
            padding: 0;
            margin: 0;
        }

        .container {
            max-width: 100%;
            margin: 0;
            position: relative;
            height: 100vh;
            display: flex;
            flex-direction: column;
        }

        /* Новый мобильный хедер */
        .mobile-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px 20px;
            background: rgba(26, 26, 46, 0.9);
            position: relative;
            z-index: 100;
        }

        /* Левая часть - онлайн индикатор */
        .online-indicator-mobile {
            display: flex;
            align-items: center;
            gap: 8px;
            background: rgba(255, 255, 255, 0.1);
            padding: 8px 12px;
            border-radius: 20px;
            backdrop-filter: blur(10px);
        }

        .online-dot-mobile {
            width: 8px;
            height: 8px;
            background: #00ff00;
            border-radius: 50%;
            animation: blink 1.5s infinite;
        }

        .online-count-mobile {
            font-size: 1rem;
            color: white;
            font-weight: 700;
        }

        /* Правая часть - баланс и кнопка + */
        .balance-mobile {
            display: flex;
            align-items: center;
            gap: 10px;
            background: rgba(255, 255, 255, 0.1);
            padding: 8px 15px;
            border-radius: 20px;
            backdrop-filter: blur(10px);
        }

        .balance-mobile img {
            width: 20px;
            height: 20px;
        }

        .balance-amount-mobile {
            font-size: 1.1rem;
            font-weight: 700;
            color: white;
        }

        .add-button-mobile {
            width: 30px;
            height: 30px;
            background: #8b45ff;
            border: none;
            border-radius: 50%;
            color: white;
            font-size: 1.2rem;
            font-weight: 700;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
        }

        .add-button-mobile:hover {
            background: #7a3de6;
            transform: scale(1.1);
        }

        /* Основной контент */
        .main-content-mobile {
            flex: 1;
            display: flex;
            flex-direction: column;
            position: relative;
            overflow: hidden;
        }

        /* Игровая область */
        .game-area-mobile {
            flex: 1;
            position: relative;
            background: #1a1a2e;
            border-radius: 0;
            display: flex;
            align-items: center;
            justify-content: center;
            background-image: 
                linear-gradient(rgba(139, 69, 255, 0.1) 1px, transparent 1px),
                linear-gradient(90deg, rgba(139, 69, 255, 0.1) 1px, transparent 1px);
            background-size: 20px 20px;
        }

        /* Список игроков поверх игры */
        .players-overlay {
            position: absolute;
            bottom: 80px;
            left: 0;
            right: 0;
            background: rgba(26, 26, 46, 0.9);
            backdrop-filter: blur(10px);
            max-height: 200px;
            overflow-y: auto;
            z-index: 50;
        }

        .player-item {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 8px 15px;
            margin-bottom: 2px;
            border-bottom: 1px solid rgba(139, 69, 255, 0.1);
            font-size: 0.8rem;
            position: relative;
            transition: all 0.3s ease;
            opacity: 0;
            transform: translateY(20px);
            animation: playerSlideIn 0.5s ease-out forwards;
            min-height: 40px;
        }

        @keyframes playerSlideIn {
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .player-item.user {
            background: rgba(139, 69, 255, 0.3);
            border: 1px solid #8b45ff;
            order: -1;
            margin-bottom: 5px;
        }

        .player-item.lost {
            background: rgba(255, 68, 68, 0.2);
            border-color: #ff4444;
            color: #ff9999;
        }

        .player-item.won {
            background: rgba(28, 191, 25, 0.2);
            border-color: #1cbf19;
        }

        .player-info {
            flex: 1;
            display: flex;
            justify-content: space-between;
            align-items: center;
            white-space: nowrap;
            min-width: 0;
        }

        .player-name {
            font-size: 0.8rem;
            font-weight: 700;
            color: white;
            flex-shrink: 0;
            width: 80px;
            overflow: hidden;
            text-overflow: ellipsis;
            text-transform: none;
        }

        .player-bet {
            font-size: 0.75rem;
            color: white;
            display: flex;
            align-items: center;
            gap: 4px;
            white-space: nowrap;
            min-width: 60px;
            justify-content: center;
        }

        .player-cashout {
            font-size: 0.75rem;
            color: #1cbf19;
            display: flex;
            align-items: center;
            gap: 4px;
            font-weight: 700;
            white-space: nowrap;
            min-width: 70px;
            justify-content: flex-end;
        }

        /* Навигация внизу */
        .bottom-navigation {
            display: flex;
            background: rgba(26, 26, 46, 0.95);
            backdrop-filter: blur(10px);
            padding: 15px 20px;
            justify-content: space-around;
            align-items: center;
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            z-index: 100;
            border-top: 1px solid rgba(139, 69, 255, 0.3);
        }

        .nav-icon {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 5px;
            padding: 8px 12px;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
            opacity: 0.7;
            background: transparent;
        }

        .nav-icon.active {
            background: rgba(139, 69, 255, 0.3);
            opacity: 1;
        }

        .nav-icon:hover {
            opacity: 1;
            transform: translateY(-2px);
        }

        .nav-icon-image {
            width: 24px;
            height: 24px;
            object-fit: contain;
        }

        .nav-icon-text {
            font-size: 0.7rem;
            color: white;
            font-weight: 600;
            text-transform: none;
        }

        /* Стили для элементов игры */
        .multiplier-display {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 6rem;
            font-weight: 900;
            color: white;
            z-index: 20;
            transition: all 0.1s ease;
        }

        .multiplier-display.red {
            color: #ff4444;
        }

        .countdown-overlay {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.9);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 30;
        }

        .countdown-number {
            font-size: 8rem;
            font-weight: 900;
            color: white;
            animation: heartbeat 1s ease-in-out;
        }

        @keyframes heartbeat {
            0% { transform: scale(0.8); opacity: 0.5; }
            50% { transform: scale(1.2); opacity: 1; }
            100% { transform: scale(1); opacity: 1; }
        }

        /* Кнопка забрать */
        .cashout-button-mobile {
            position: absolute;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            background: #459cff;
            color: white;
            border: none;
            padding: 15px 40px;
            border-radius: 25px;
            font-family: 'Orbitron', monospace;
            font-weight: 700;
            font-size: 1.2rem;
            cursor: pointer;
            transition: all 0.3s ease;
            z-index: 40;
            display: none;
        }

        .cashout-button-mobile.show {
            display: block;
        }

        .cashout-button-mobile:hover {
            background: #3a85e6;
            transform: translateX(-50%) translateY(-2px);
        }

        /* Контент слайдов */
        .content-slider {
            position: relative;
            overflow: hidden;
            width: 100%;
            flex: 1;
        }

        .slider-container {
            display: flex;
            transition: transform 0.5s ease-in-out;
            width: 400%;
            height: 100%;
        }

        .slide {
            width: 25%;
            flex-shrink: 0;
            height: 100%;
            overflow-y: auto;
            padding-bottom: 80px;
        }

        /* Стили для бонусов */
        .bonus-content {
            padding: 20px;
            background: transparent;
            height: 100%;
            overflow-y: auto;
        }

        .bonus-title {
            text-align: center;
            font-size: 2rem;
            font-weight: 900;
            color: white;
            margin-bottom: 30px;
            text-transform: none;
        }

        .bonus-stages {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            margin-bottom: 30px;
        }

        .bonus-stage {
            background: rgba(150, 150, 150, 0.1);
            border: 2px solid rgba(150, 150, 150, 0.3);
            border-radius: 15px;
            padding: 15px;
            text-align: center;
            transition: all 0.3s ease;
            opacity: 0.4;
        }

        .bonus-stage.active {
            background: rgba(150, 150, 150, 0.2);
            border-color: #888;
            opacity: 1;
            box-shadow: 0 0 20px rgba(150, 150, 150, 0.3);
        }

        .bonus-stage.completed {
            background: rgba(0, 255, 0, 0.2);
            border-color: #00ff00;
            opacity: 1;
        }

        .bonus-stage-number {
            font-size: 1.2rem;
            font-weight: 900;
            color: white;
            margin-bottom: 8px;
        }

        .bonus-percentage {
            font-size: 1.5rem;
            font-weight: 900;
            margin-bottom: 8px;
            color: white;
        }

        .bonus-description {
            font-size: 0.8rem;
            opacity: 0.8;
            color: white;
        }

        /* Стили для кейсов */
        .cases-content {
            padding: 20px;
            background: transparent;
            height: 100%;
            overflow-y: auto;
            text-align: center;
        }

        .cases-title {
            text-align: center;
            font-size: 2rem;
            font-weight: 900;
            color: white;
            margin-bottom: 30px;
        }

        .start-case {
            background: rgba(128, 128, 128, 0.1);
            border: 3px solid rgba(128, 128, 128, 0.5);
            border-radius: 20px;
            padding: 30px;
            text-align: center;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
            max-width: 400px;
            margin: 0 auto;
            cursor: pointer;
        }

        .case-image {
            width: 120px;
            height: 120px;
            margin: 0 auto 15px;
            object-fit: contain;
            border-radius: 15px;
        }

        .case-name {
            font-size: 1.5rem;
            font-weight: 900;
            color: #808080;
            margin-bottom: 10px;
        }

        .case-price {
            font-size: 1.5rem;
            font-weight: 900;
            color: white;
            margin-bottom: 20px;
        }

        .case-buttons {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin-bottom: 20px;
        }

        .case-open-btn, .case-demo-btn {
            padding: 12px 20px;
            border-radius: 12px;
            font-family: 'Orbitron', monospace;
            font-weight: 700;
            font-size: 1rem;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .case-open-btn {
            background: #808080;
            color: #000;
            border: none;
        }

        .case-demo-btn {
            background: rgba(255, 255, 255, 0.1);
            color: white;
            border: 2px solid rgba(255, 255, 255, 0.3);
        }

        /* Стили для кошелька */
        .wallet-content {
            padding: 20px;
            background: transparent;
            height: 100%;
            overflow-y: auto;
        }

        .wallet-header {
            background: transparent;
            padding: 20px 0;
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .wallet-title {
            font-size: 1.5rem;
            font-weight: 900;
            color: white;
        }

        .refresh-button {
            background: transparent;
            color: #8b45ff;
            border: none;
            padding: 10px;
            border-radius: 50%;
            font-size: 1.5rem;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .total-balance {
            text-align: center;
            margin-bottom: 30px;
            background: rgba(26, 26, 46, 0.5);
            padding: 20px;
            border-radius: 15px;
        }

        .balance-amount-large {
            font-size: 2.5rem;
            font-weight: 700;
            color: white;
            margin-bottom: 10px;
        }

        .balance-ton-secondary {
            font-size: 1rem;
            color: rgba(255, 255, 255, 0.7);
        }

        .wallet-actions {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin-bottom: 30px;
        }

        .action-button {
            background: rgba(139, 69, 255, 0.2);
            color: #8b45ff;
            border: 1px solid rgba(139, 69, 255, 0.3);
            padding: 15px;
            border-radius: 12px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: center;
        }

        /* Модальные окна и прочие стили */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
        }

        .modal-overlay.show {
            opacity: 1;
            visibility: visible;
        }

        .modal {
            background: #2a2a2a;
            border: 2px solid rgba(150, 150, 150, 0.5);
            border-radius: 20px;
            padding: 30px;
            max-width: 400px;
            width: 90%;
            text-align: center;
            transform: scale(0.8);
            transition: transform 0.3s ease;
        }

        .modal-overlay.show .modal {
            transform: scale(1);
        }

        .modal h2 {
            color: white;
            margin-bottom: 20px;
            font-size: 1.5rem;
        }

        .modal-input {
            width: 100%;
            padding: 15px;
            background: rgba(0, 0, 0, 0.5);
            border: 2px solid rgba(150, 150, 150, 0.3);
            border-radius: 12px;
            color: white;
            font-family: 'Orbitron', monospace;
            font-size: 1rem;
            text-align: center;
            margin-bottom: 15px;
        }

        .modal-buttons {
            display: flex;
            gap: 15px;
            justify-content: center;
            margin-top: 20px;
        }

        .modal-btn {
            padding: 12px 25px;
            border: none;
            border-radius: 12px;
            font-family: 'Orbitron', monospace;
            font-weight: 700;
            font-size: 1rem;
            cursor: pointer;
            transition: all 0.3s ease;
            min-width: 100px;
        }

        .modal-btn.confirm {
            background: #8b45ff;
            color: white;
        }

        .modal-btn.cancel {
            background: rgba(150, 150, 150, 0.2);
            color: #888;
            border: 1px solid rgba(150, 150, 150, 0.3);
        }

        /* Дополнительные стили */
        .trading-chart {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 5;
        }

        .chart-line {
            stroke: #8b45ff;
            stroke-width: 4;
            fill: none;
            filter: drop-shadow(0 0 10px #8b45ff);
            transition: stroke 0.3s ease;
        }

        .chart-line.crashed {
            stroke: #ff4444;
            filter: drop-shadow(0 0 10px #ff4444);
        }

        .chart-area {
            fill: url(#gradient);
            opacity: 0.3;
        }

        .game-crashed {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 2.5rem;
            font-weight: 900;
            z-index: 25;
            animation: crashPulse 0.5s ease-in-out;
            color: #ff4444;
        }

        @keyframes crashPulse {
            0% { transform: translate(-50%, -50%) scale(0); }
            50% { transform: translate(-50%, -50%) scale(1.2); }
            100% { transform: translate(-50%, -50%) scale(1); }
        }

        .game-history-mini {
            position: absolute;
            top: 20px;
            right: 20px;
            display: flex;
            gap: 8px;
            z-index: 15;
        }

        .mini-result {
            width: 50px;
            height: 30px;
            border-radius: 15px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 900;
            font-size: 0.8rem;
            border: 2px solid;
            opacity: 0.6;
        }

        .mini-result.red {
            background: rgba(255, 68, 68, 0.6);
            color: rgba(255, 255, 255, 0.8);
            border-color: rgba(255, 68, 68, 0.6);
        }

        .mini-result.yellow {
            background: rgba(255, 215, 0, 0.6);
            color: rgba(0, 0, 0, 0.8);
            border-color: rgba(255, 215, 0, 0.6);
        }

        .mini-result.orange {
            background: rgba(255, 165, 0, 0.6);
            color: rgba(255, 255, 255, 0.8);
            border-color: rgba(255, 165, 0, 0.6);
        }

        .mini-result.green {
            background: rgba(0, 212, 170, 0.6);
            color: rgba(255, 255, 255, 0.8);
            border-color: rgba(0, 212, 170, 0.6);
        }

        .mini-result.pending {
            background: rgba(139, 69, 255, 0.3);
            color: #8b45ff;
            border-color: #8b45ff;
            animation: pulse 1s infinite;
        }

        @keyframes pulse {
            0% { opacity: 0.5; }
            50% { opacity: 1; }
            100% { opacity: 0.5; }
        }

        @keyframes blink {
            0%, 50% { opacity: 1; }
            51%, 100% { opacity: 0.3; }
        }

        /* Адаптивность */
        @media (max-width: 480px) {
            .multiplier-display {
                font-size: 4rem;
            }
            
            .countdown-number {
                font-size: 6rem;
            }
            
            .mobile-header {
                padding: 8px 15px;
            }
            
            .players-overlay {
                max-height: 150px;
            }
            
            .bottom-navigation {
                padding: 10px 15px;
            }
        }

        /* Все остальные стили из исходного кода... */
        .support-button {
            position: fixed;
            bottom: 100px;
            right: 20px;
            background: #8b45ff;
            color: white;
            border: none;
            border-radius: 12px;
            padding: 10px 20px;
            font-family: 'Orbitron', monospace;
            font-weight: 700;
            font-size: 1rem;
            cursor: pointer;
            transition: all 0.3s ease;
            z-index: 1000;
        }

        .language-switcher {
            position: fixed;
            bottom: 100px;
            left: 20px;
            background: #1a1a2e;
            border: 1px solid rgba(139, 69, 255, 0.3);
            border-radius: 12px;
            color: white;
            font-family: 'Orbitron', monospace;
            font-weight: 700;
            padding: 10px 15px;
            cursor: pointer;
            transition: all 0.3s ease;
            z-index: 1001;
        }

        /* Все остальные модальные окна и их стили остаются без изменений */
        .bet-modal-overlay, .case-modal-overlay, .win-modal-overlay,
        .withdraw-modal-overlay, .pepe-welcome-modal-overlay, .support-modal-overlay,
        .color-picker-modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
        }

        .bet-modal-overlay.show, .case-modal-overlay.show, .win-modal-overlay.show,
        .withdraw-modal-overlay.show, .pepe-welcome-modal-overlay.show, .support-modal-overlay.show,
        .color-picker-modal-overlay.show {
            opacity: 1;
            visibility: visible;
        }

        /* Дополнительные стили для модальных окон */
        .bet-modal, .case-modal, .win-modal, .withdraw-modal, .pepe-welcome-modal,
        .support-modal, .color-picker-modal, .account-modal {
            background: #2a2a2a;
            border: 2px solid rgba(150, 150, 150, 0.5);
            border-radius: 20px;
            padding: 30px;
            max-width: 400px;
            width: 90%;
            text-align: center;
            transform: scale(0.8);
            transition: transform 0.3s ease;
        }

        .bet-modal-overlay.show .bet-modal,
        .case-modal-overlay.show .case-modal,
        .win-modal-overlay.show .win-modal,
        .withdraw-modal-overlay.show .withdraw-modal,
        .pepe-welcome-modal-overlay.show .pepe-welcome-modal,
        .support-modal-overlay.show .support-modal,
        .color-picker-modal-overlay.show .color-picker-modal {
            transform: scale(1);
        }

        /* Стили для ставок */
        .bet-amount-input {
            width: 100%;
            padding: 15px;
            background: rgba(0, 0, 0, 0.5);
            border: 2px solid rgba(150, 150, 150, 0.3);
            border-radius: 15px;
            color: white;
            font-family: 'Orbitron', monospace;
            font-size: 1.2rem;
            font-weight: 600;
            text-align: center;
            margin-bottom: 20px;
        }

        .currency-selector {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin-bottom: 20px;
        }

        .currency-btn {
            padding: 10px 20px;
            background: rgba(150, 150, 150, 0.2);
            border: 2px solid rgba(150, 150, 150, 0.3);
            border-radius: 12px;
            color: white;
            cursor: pointer;
            font-family: 'Orbitron', monospace;
            font-weight: 600;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .currency-btn.active {
            background: rgba(150, 150, 150, 0.5);
            border-color: #888;
        }

        .quick-bet-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 10px;
            margin-bottom: 20px;
        }

        .quick-bet {
            padding: 10px;
            background: rgba(150, 150, 150, 0.2);
            border: 1px solid rgba(150, 150, 150, 0.3);
            border-radius: 10px;
            color: white;
            cursor: pointer;
            font-family: 'Orbitron', monospace;
            font-weight: 600;
            font-size: 0.9rem;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 5px;
        }

        /* Прочие стили, которые нужны для работы всех функций */
        .balance-blurred {
            filter: blur(8px);
            user-select: none;
        }

        .pulse-animation {
            animation: pulseBalance 0.5s ease-in-out;
        }

        @keyframes pulseBalance {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }

        .login-overlay {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            z-index: 10;
        }

        .login-btn {
            background: #8b45ff;
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 12px;
            font-family: 'Orbitron', monospace;
            font-weight: 700;
            font-size: 1rem;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .asset-item {
            display: flex;
            align-items: center;
            padding: 15px 20px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.05);
            transition: all 0.3s ease;
            background: transparent;
        }

        .asset-icon {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            margin-right: 15px;
            display: flex;
            align-items: center;
            justify-content: center;
            overflow: hidden;
        }

        .asset-icon img {
            width: 32px;
            height: 32px;
            object-fit: contain;
            border-radius: 50%;
        }

        .asset-info {
            flex: 1;
        }

        .asset-main {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-bottom: 4px;
        }

        .asset-name {
            font-weight: 600;
            color: white;
            font-size: 1rem;
        }

        .asset-price {
            font-size: 0.85rem;
            color: #888;
        }

        .asset-change {
            font-size: 0.8rem;
            font-weight: 600;
            padding: 2px 6px;
            border-radius: 4px;
        }

        .asset-change.positive {
            color: #26a69a;
        }

        .asset-change.negative {
            color: #ef5350;
        }

        .asset-balance {
            text-align: right;
        }

        .asset-amount {
            font-weight: 600;
            color: white;
            font-size: 1rem;
            margin-bottom: 4px;
        }

        .asset-value {
            font-size: 0.85rem;
            color: #888;
        }

        /* Стили для кейсов */
        .case-prizes {
            text-align: left;
            background: rgba(0, 0, 0, 0.3);
            padding: 15px;
            border-radius: 15px;
            border: 1px solid rgba(128, 128, 128, 0.2);
            display: none;
            margin-top: 20px;
        }

        .case-prizes.show {
            display: block;
        }

        .case-prizes-title {
            font-size: 1rem;
            color: #808080;
            margin-bottom: 15px;
            font-weight: 700;
            text-align: center;
        }

        .prizes-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
        }

        .prize-item {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 10px;
            background: rgba(128, 128, 128, 0.1);
            border-radius: 12px;
            font-size: 0.8rem;
            color: white;
            border: 1px solid rgba(128, 128, 128, 0.2);
        }

        .prize-icon {
            width: 20px;
            height: 20px;
            border-radius: 4px;
            object-fit: cover;
        }

        .prize-info {
            display: flex;
            flex-direction: column;
        }

        .prize-name {
            font-weight: 600;
            font-size: 0.7rem;
            margin-bottom: 2px;
        }

        .prize-price {
            color: #808080;
            font-weight: 700;
            font-size: 0.65rem;
        }

        @media (max-width: 360px) {
            .prizes-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <!-- Загрузочный экран -->
    <div class="loading-overlay" id="loadingOverlay">
        <div class="loading-spinner"></div>
    </div>

    <div class="container">
        <!-- Новый мобильный хедер -->
        <div class="mobile-header">
            <!-- Левая часть - онлайн индикатор -->
            <div class="online-indicator-mobile">
                <div class="online-dot-mobile"></div>
                <div class="online-count-mobile" id="onlineCount">127</div>
            </div>
            
            <!-- Правая часть - баланс и кнопка + -->
            <div class="balance-mobile">
                <img src="https://files.svgcdn.io/token-branded/ton.png" alt="TON">
                <div class="balance-amount-mobile" id="balanceMobile">1.00</div>
                <button class="add-button-mobile" onclick="showDepositModal()">+</button>
                <div class="login-overlay" id="loginOverlay">
                    <button class="login-btn" onclick="showLoginModal()" data-lang="login">Войти</button>
                </div>
            </div>
        </div>

        <!-- Основной контент -->
        <div class="main-content-mobile">
            <div class="content-slider">
                <div class="slider-container" id="sliderContainer">
                    <!-- Слайд Crash игры -->
                    <div class="slide">
                        <div class="game-area-mobile" id="gameCanvas">
                            <div class="multiplier-display" id="multiplier">1.00x</div>
                            
                            <svg class="trading-chart" id="tradingChart" viewBox="0 0 800 500">
                                <defs>
                                    <linearGradient id="gradient" x1="0%" y1="0%" x2="0%" y2="100%">
                                        <stop offset="0%" style="stop-color:#8b45ff;stop-opacity:0.8" />
                                        <stop offset="100%" style="stop-color:#8b45ff;stop-opacity:0" />
                                    </linearGradient>
                                </defs>
                                <path class="chart-area" id="chartArea" d=""></path>
                                <path class="chart-line" id="chartLine" d=""></path>
                            </svg>
                            
                            <div class="game-history-mini" id="gameHistoryMini"></div>
                            <div class="countdown-overlay" id="countdown" style="display: none;">
                                <div class="countdown-number" id="countdownNumber">3</div>
                            </div>

                            <button class="cashout-button-mobile" id="cashoutButtonMobile" onclick="cashOut()">Забрать</button>
                        </div>

                        <!-- Список игроков поверх игры -->
                        <div class="players-overlay">
                            <div id="playersList"></div>
                        </div>
                    </div>

                    <!-- Слайд Бонусов -->
                    <div class="slide">
                        <div class="bonus-content">
                            <div class="bonus-title">Бонусная система</div>
                            
                            <div class="bonus-stages" id="bonusStages">
                                <!-- Стадии бонусов будут добавлены JS -->
                            </div>
                            
                            <div style="background: rgba(150, 150, 150, 0.1); border-radius: 15px; padding: 20px; margin-bottom: 20px;">
                                <div style="text-align: center; margin-bottom: 15px;">
                                    <div style="font-size: 1rem; color: white; margin-bottom: 10px;">Стадия 1 из 5</div>
                                    <div style="width: 100%; height: 8px; background: rgba(255, 255, 255, 0.1); border-radius: 10px; overflow: hidden;">
                                        <div style="height: 100%; background: linear-gradient(90deg, #888, #aaa); border-radius: 10px; width: 0%;" id="bonusProgressFill"></div>
                                    </div>
                                </div>
                                
                                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(120px, 1fr)); gap: 15px; text-align: center;">
                                    <div>
                                        <div style="font-size: 1.2rem; font-weight: 900; color: white;" id="totalDeposits">0</div>
                                        <div style="font-size: 0.8rem; opacity: 0.8; color: white;">Всего пополнений</div>
                                    </div>
                                    <div>
                                        <div style="font-size: 1.2rem; font-weight: 900; color: white;" id="totalBonus">0.00</div>
                                        <div style="font-size: 0.8rem; opacity: 0.8; color: white;">Получено бонусов</div>
                                    </div>
                                    <div>
                                        <div style="font-size: 1.2rem; font-weight: 900; color: white;" id="nextBonusAmount">100%</div>
                                        <div style="font-size: 0.8rem; opacity: 0.8; color: white;">Следующий бонус</div>
                                    </div>
                                </div>
                            </div>
                            
                            <div style="background: rgba(150, 150, 150, 0.1); border-radius: 15px; padding: 25px; display: flex; align-items: center; gap: 15px; border: 2px solid rgba(150, 150, 150, 0.3);">
                                <img src="https://i.postimg.cc/hGpYHrm4/rounded-in-photoretrica-10.png" alt="PEPE Contest" style="width: 80px; height: 80px; border-radius: 15px; object-fit: cover;">
                                <div style="flex: 1; text-align: center;">
                                    <div style="font-size: 1.5rem; font-weight: 900; color: white; margin-bottom: 15px;">Выиграйте PEPE</div>
                                    <button style="background: #ff8640; color: white; border: none; padding: 12px 25px; border-radius: 12px; font-family: 'Orbitron', monospace; font-weight: 700; font-size: 1rem; cursor: pointer;" onclick="participateInContest()">Участвовать</button>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Слайд Кейсов -->
                    <div class="slide">
                        <div class="cases-content">
                            <div class="cases-title">🎁 Кейсы с подарками</div>
                            
                            <div class="start-case" onclick="toggleCasePrizes()">
                                <img src="https://i.postimg.cc/G3QdGS3H/image.png" alt="START Case" class="case-image">
                                <div class="case-name">START</div>
                                <div class="case-price">3.00 TON</div>
                                
                                <div class="case-buttons">
                                    <button class="case-open-btn" onclick="event.stopPropagation(); openStartCase()">Открыть кейс</button>
                                    <button class="case-demo-btn" onclick="event.stopPropagation(); demoStartCase()">Демо прокрут</button>
                                </div>
                                
                                <div class="case-prizes" id="casePrizes">
                                    <div class="case-prizes-title">Возможные призы:</div>
                                    <div class="prizes-grid">
                                        <div class="prize-item">
                                            <img src="https://emojio.ru/images/apple-b/11.0/1f9f8.png" alt="Мишка" class="prize-icon">
                                            <div class="prize-info">
                                                <div class="prize-name">Мишка</div>
                                                <div class="prize-price">0.10 TON</div>
                                            </div>
                                        </div>
                                        <div class="prize-item">
                                            <img src="https://emojio.ru/images/apple-b/1f37e.png" alt="Шампанское" class="prize-icon">
                                            <div class="prize-info">
                                                <div class="prize-name">Шампанское</div>
                                                <div class="prize-price">0.50 TON</div>
                                            </div>
                                        </div>
                                        <div class="prize-item">
                                            <img src="https://i.postimg.cc/HsZsMPW2/9017120-imgwebp-Photoroom.png" alt="Подарок" class="prize-icon">
                                            <div class="prize-info">
                                                <div class="prize-name">Подарок #3</div>
                                                <div class="prize-price">0.10 TON</div>
                                            </div>
                                        </div>
                                        <div class="prize-item">
                                            <img src="https://i.postimg.cc/1XF2zXzF/2025-10-04-233431-Photoroom.png" alt="Подарок" class="prize-icon">
                                            <div class="prize-info">
                                                <div class="prize-name">Подарок #4</div>
                                                <div class="prize-price">0.50 TON</div>
                                            </div>
                                        </div>
                                        <div class="prize-item">
                                            <img src="https://i.postimg.cc/BbNDHctn/2025-10-04-233719-Photoroom.png" alt="Подарок" class="prize-icon">
                                            <div class="prize-info">
                                                <div class="prize-name">Подарок #5</div>
                                                <div class="prize-price">1.00 TON</div>
                                            </div>
                                        </div>
                                        <div class="prize-item">
                                            <img src="https://i.postimg.cc/rw5VHyCz/2025-10-04-233857-Photoroom.png" alt="Подарок" class="prize-icon">
                                            <div class="prize-info">
                                                <div class="prize-name">Подарок #6</div>
                                                <div class="prize-price">1.00 TON</div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Слайд Кошелька -->
                    <div class="slide">
                        <div class="wallet-content">
                            <div class="wallet-header">
                                <h1 class="wallet-title">🔶 TonCrash Wallet</h1>
                                <button class="refresh-button" onclick="refreshWallet()">⚙️</button>
                            </div>
                            
                            <div class="total-balance">
                                <h3>Общий баланс в USD</h3>
                                <div class="balance-amount-large" id="totalBalanceDisplay">$0.00</div>
                                <div class="balance-ton-secondary" id="balanceTonSecondary">0.00 TON</div>
                            </div>
                            
                            <div class="wallet-actions">
                                <button class="action-button deposit" onclick="showDepositModal()">Пополнить</button>
                                <button class="action-button withdraw" onclick="showWithdrawModal()">Вывести</button>
                            </div>
                            
                            <div style="padding: 0 5px; margin-bottom: 15px; color: #888; font-size: 0.9rem; text-align: right; cursor: pointer;" onclick="toggleSmallBalances()">Скрыть мелкие балансы</div>
                            
                            <div id="assetsSection">
                                <div class="asset-item">
                                    <div class="asset-icon" style="background: #26a69a;">
                                        <img src="https://upload.wikimedia.org/wikipedia/commons/0/01/USDT_Logo.png" alt="USDT">
                                    </div>
                                    <div class="asset-info">
                                        <div class="asset-main">
                                            <div class="asset-name">Tether</div>
                                            <div class="asset-price">$1</div>
                                            <div class="asset-change positive">+0.01%</div>
                                        </div>
                                    </div>
                                    <div class="asset-balance" id="usdtAssetBalance">
                                        <div class="asset-amount" id="usdtWalletBalance">0 USDT</div>
                                        <div class="asset-value" id="usdtWalletValue">$0.00</div>
                                    </div>
                                </div>
                                
                                <div class="asset-item">
                                    <div class="asset-icon" style="background: #0098ea;">
                                        <img src="https://ton.org/download/ton_symbol.png" alt="TON">
                                    </div>
                                    <div class="asset-info">
                                        <div class="asset-main">
                                            <div class="asset-name">Toncoin</div>
                                            <div class="asset-price">$2.7</div>
                                            <div class="asset-change negative">-2.18%</div>
                                        </div>
                                    </div>
                                    <div class="asset-balance">
                                        <div class="asset-amount" id="tonWalletBalance">0 TON</div>
                                        <div class="asset-value" id="tonWalletValue">$0.00</div>
                                    </div>
                                </div>

                                <div class="asset-item">
                                    <div class="asset-icon" style="background: #9945ff;">
                                        <img src="https://png.pngtree.com/png-vector/20220913/ourmid/pngtree-solana-sol-cryptocurrency-symbol-depicted-on-a-plain-white-backdrop-vector-png-image_39199908.png" alt="Solana">
                                    </div>
                                    <div class="asset-info">
                                        <div class="asset-main">
                                            <div class="asset-name">Solana</div>
                                            <div class="asset-price">$201.83</div>
                                            <div class="asset-change negative">-0.11%</div>
                                        </div>
                                    </div>
                                    <div class="asset-balance" id="solAssetBalance">
                                        <div class="asset-amount" id="solWalletBalance">0 SOL</div>
                                        <div class="asset-value" id="solWalletValue">$0.00</div>
                                    </div>
                                </div>

                                <div class="asset-item">
                                    <div class="asset-icon" style="background: #ff0013;">
                                        <img src="https://s3.coinmarketcap.com/static-gravity/image/4aec70f6f1254e4f89650cc68ae49f3c.png" alt="TRON">
                                    </div>
                                    <div class="asset-info">
                                        <div class="asset-main">
                                            <div class="asset-name">TRON</div>
                                            <div class="asset-price">$0.337</div>
                                            <div class="asset-change positive">+0.39%</div>
                                        </div>
                                    </div>
                                    <div class="asset-balance" id="tronAssetBalance">
                                        <div class="asset-amount" id="tronWalletBalance">0 TRX</div>
                                        <div class="asset-value" id="tronWalletValue">$0.00</div>
                                    </div>
                                </div>

                                <div class="asset-item">
                                    <div class="asset-icon" style="background: #f7931a;">
                                        <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/4/46/Bitcoin.svg/2048px-Bitcoin.svg.png" alt="Bitcoin">
                                    </div>
                                    <div class="asset-info">
                                        <div class="asset-main">
                                            <div class="asset-name">Bitcoin</div>
                                            <div class="asset-price">$109,497</div>
                                            <div class="asset-change negative">-0.64%</div>
                                        </div>
                                    </div>
                                    <div class="asset-balance" id="btcAssetBalance">
                                        <div class="asset-amount" id="btcWalletBalance">0 BTC</div>
                                        <div class="asset-value" id="btcWalletValue">$0.00</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Нижняя навигация -->
        <div class="bottom-navigation">
            <div class="nav-icon active" onclick="switchToSlide(0)">
                <img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='24' height='24' viewBox='0 0 24 24' fill='none' stroke='white' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpath d='M4.5 16.5c-1.5 1.5-1.5 4.5 0 6l6-6m-6-6l6 6m0 0L16.5 4.5c1.5-1.5 4.5-1.5 6 0l-6 6m6-6v6m0 0l-6 6'/%3E%3C/svg%3E" alt="Crash" class="nav-icon-image">
                <span class="nav-icon-text">Crash</span>
            </div>
            <div class="nav-icon" onclick="switchToSlide(1)">
                <img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='24' height='24' viewBox='0 0 24 24' fill='none' stroke='white' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpath d='M20 12c0 8-8 8-8 8s-8 0-8-8 8-8 8-8 8 0 8 8Z'/%3E%3Cpath d='M16 8c0 4-4 4-4 4s-4 0-4-4 4-4 4-4 4 0 4 4Z'/%3E%3C/svg%3E" alt="Бонус" class="nav-icon-image">
                <span class="nav-icon-text">Бонус</span>
            </div>
            <div class="nav-icon" onclick="switchToSlide(2)">
                <img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='24' height='24' viewBox='0 0 24 24' fill='none' stroke='white' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpath d='M20 7h-9'/%3E%3Cpath d='M14 17H5'/%3E%3Ccircle cx='17' cy='17' r='3'/%3E%3Ccircle cx='7' cy='7' r='3'/%3E%3C/svg%3E" alt="Кейсы" class="nav-icon-image">
                <span class="nav-icon-text">Кейсы</span>
            </div>
            <div class="nav-icon" onclick="switchToSlide(3)">
                <img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='24' height='24' viewBox='0 0 24 24' fill='none' stroke='white' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpath d='M19 7V4a1 1 0 0 0-1-1H5a2 2 0 0 0 0 4h15a1 1 0 0 1 1 1v4h-3a2 2 0 0 0 0 4h3a1 1 0 0 0 1-1v-2a1 1 0 0 0-1-1'/%3E%3Cpath d='M3 5v14a2 2 0 0 0 2 2h15a1 1 0 0 0 1-1v-4'/%3E%3C/svg%3E" alt="Кошелек" class="nav-icon-image">
                <span class="nav-icon-text">Кошелек</span>
            </div>
        </div>
    </div>

    <button class="support-button" onclick="showSupportModal()">💬</button>
    <button class="language-switcher" onclick="toggleLanguage()" id="languageSwitcher">RU</button>

    <!-- Все модальные окна остаются без изменений -->
    <div class="modal-overlay" id="loginModal">
        <div class="modal">
            <h2>Вход в игру</h2>
            <input type="text" class="modal-input" id="telegramNick" placeholder="Введите ваш ник в Telegram" maxlength="20">
            <div style="margin: 10px 0; text-align: left;">
                <label style="display: flex; align-items: center; color: #fff; font-size: 14px; cursor: pointer;">
                    <input type="checkbox" id="rememberMe" style="margin-right: 8px; transform: scale(1.2);">
                    <span>Запомнить меня</span>
                </label>
            </div>
            <div class="modal-buttons">
                <button class="modal-btn confirm" onclick="login()">Войти</button>
                <button class="modal-btn cancel" onclick="closeLoginModal()">Отмена</button>
            </div>
        </div>
    </div>

    <div class="modal-overlay bet-modal-overlay" id="betModal">
        <div class="modal bet-modal">
            <h2>Сделать ставку</h2>
            
            <div class="currency-selector">
                <button class="currency-btn active" id="tonCurrencyBtn" onclick="selectBetCurrency('TON')">
                    <img src="https://files.svgcdn.io/token-branded/ton.png" alt="TON" style="width: 20px; height: 20px;">
                    TON
                </button>
                <button class="currency-btn" id="usdtCurrencyBtn" onclick="selectBetCurrency('USDT')">
                    <img src="https://upload.wikimedia.org/wikipedia/commons/0/01/USDT_Logo.png" alt="USDT" style="width: 20px; height: 20px;">
                    USDT
                </button>
            </div>
            
            <input type="number" class="bet-amount-input" id="betAmountInput" placeholder="0.10" min="0.01" step="0.01">
            
            <div class="quick-bet-grid">
                <button class="quick-bet" onclick="setBetAmountModal(0.1)">
                    0.1 <img src="https://files.svgcdn.io/token-branded/ton.png" alt="TON" style="width: 16px; height: 16px;" id="quickBet1Icon">
                </button>
                <button class="quick-bet" onclick="setBetAmountModal(0.5)">
                    0.5 <img src="https://files.svgcdn.io/token-branded/ton.png" alt="TON" style="width: 16px; height: 16px;" id="quickBet2Icon">
                </button>
                <button class="quick-bet" onclick="setBetAmountModal(1.0)">
                    1.0 <img src="https://files.svgcdn.io/token-branded/ton.png" alt="TON" style="width: 16px; height: 16px;" id="quickBet3Icon">
                </button>
                <button class="quick-bet" onclick="setBetAmountModal(5.0)">
                    5.0 <img src="https://files.svgcdn.io/token-branded/ton.png" alt="TON" style="width: 16px; height: 16px;" id="quickBet4Icon">
                </button>
                <button class="quick-bet" onclick="setBetAmountModal(10.0)">
                    10.0 <img src="https://files.svgcdn.io/token-branded/ton.png" alt="TON" style="width: 16px; height: 16px;" id="quickBet5Icon">
                </button>
                <button class="quick-bet" onclick="doubleBetModal()">2x</button>
            </div>

            <div class="modal-buttons">
                <button class="modal-btn confirm" onclick="confirmBet()">Поставить</button>
                <button class="modal-btn cancel" onclick="closeBetModal()">Отмена</button>
            </div>
        </div>
    </div>

    <div class="modal-overlay" id="depositModal">
        <div class="modal">
            <h2>Пополнение баланса</h2>
            
            <button style="background: #1fbcff; color: white; border: none; padding: 12px 20px; border-radius: 12px; font-family: 'Orbitron', monospace; font-weight: 700; font-size: 0.9rem; cursor: pointer; margin-bottom: 15px;" onclick="openCryptoPay()">
                CryptoPay [+2%]
            </button>
            
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-bottom: 20px;">
                <button style="padding: 15px; background: rgba(150, 150, 150, 0.2); border: 1px solid rgba(150, 150, 150, 0.3); border-radius: 12px; color: white; cursor: pointer; font-family: 'Orbitron', monospace; font-weight: 600; font-size: 1rem; display: flex; align-items: center; justify-content: center; gap: 8px;" onclick="depositCurrency('TON')" id="tonDepositBtn">
                    <img src="https://i.postimg.cc/Vk7BwHKh/image-1.png" alt="TON" style="width: 24px; height: 24px; border-radius: 50%;">
                    TON
                </button>
                <button style="padding: 15px; background: rgba(150, 150, 150, 0.2); border: 1px solid rgba(150, 150, 150, 0.3); border-radius: 12px; color: white; cursor: pointer; font-family: 'Orbitron', monospace; font-weight: 600; font-size: 1rem; display: flex; align-items: center; justify-content: center; gap: 8px;" onclick="depositCurrency('SBP')" id="sbpDepositBtn">
                    <img src="https://png.klev.club/uploads/posts/2024-05/png-klev-club-92ub-p-sbp-logotip-png-18.png" alt="СБП" style="width: 30px; height: 30px; object-fit: contain;">
                    СБП
                </button>
            </div>
            <input type="number" class="modal-input" id="depositAmount" placeholder="Введите сумму для пополнения" min="1" step="1">
            
            <div style="margin-top: 15px; padding: 15px; background: rgba(150, 150, 150, 0.1); border-radius: 8px; border: 1px solid rgba(150, 150, 150, 0.2);">
                <div style="font-size: 0.9rem; color: #888; margin-bottom: 10px; font-weight: 600;">Промокод</div>
                <input type="text" style="width: 100%; padding: 10px; background: rgba(0, 0, 0, 0.3); border: 1px solid rgba(150, 150, 150, 0.3); border-radius: 4px; color: white; font-family: 'Orbitron', monospace; font-size: 0.8rem; margin-bottom: 10px;" id="promoCodeInput" placeholder="Введите промокод">
                <button style="background: #ff8640; color: white; border: none; padding: 8px 16px; border-radius: 4px; font-weight: 600; font-size: 0.8rem; cursor: pointer;" onclick="applyPromoCode()">Применить</button>
            </div>
            
            <div class="modal-buttons" id="depositButtons">
                <button class="modal-btn confirm" onclick="confirmDeposit()">Пополнить</button>
                <button class="modal-btn cancel" onclick="closeDepositModal()">Отмена</button>
            </div>

            <div id="tonDepositInfo" style="display: none;">
                <div style="text-align: center; margin-bottom: 20px;">
                    <img src="https://i.postimg.cc/XYg1C8QK/5375564163138584120.jpg" alt="QR Code" style="max-width: 200px; margin-bottom: 15px;">
                    <div style="background: rgba(0, 0, 0, 0.5); padding: 12px; border-radius: 12px; font-family: monospace; font-size: 11px; word-break: break-all; margin-bottom: 10px; cursor: pointer;" onclick="copyAddress()">
                        UQCvyMHj2r7Ig73EcbBI3h405uemns12eX49OBW3cVsOEzuW
                    </div>
                    <div style="font-size: 1.3rem; color: #ff4444; font-weight: 900; margin-bottom: 15px;" id="timerDisplay">05:00</div>
                    <div style="text-align: center; padding: 15px; background: rgba(150, 150, 150, 0.1); border-radius: 12px; margin-bottom: 15px;">
                        <p>Ожидание платежа...</p>
                        <p>Средства будут зачислены автоматически после истечения таймера</p>
                    </div>
                </div>
                <div class="modal-buttons">
                    <button class="modal-btn cancel" onclick="closeDepositModal()">Закрыть</button>
                </div>
            </div>
        </div>
    </div>

    <div class="modal-overlay" id="withdrawModal">
        <div class="modal">
            <h2>Вывод средств</h2>
            <div style="background: rgba(150, 150, 150, 0.1); padding: 20px; border-radius: 15px; margin-bottom: 25px; color: #ffffff; font-size: 0.9rem; line-height: 1.5; border: 1px solid rgba(150, 150, 150, 0.3);">
                <p>Минимальная сумма для вывода: 1 TON</p>
                <p>Комиссия сети: 0.02 TON</p>
            </div>
            <input type="text" class="modal-input" id="withdrawAddress" placeholder="Введите TON адрес">
            <input type="number" class="modal-input" id="withdrawAmount" placeholder="Введите сумму для вывода" min="1" step="0.01">
            <div class="modal-buttons">
                <button class="modal-btn confirm" onclick="confirmWithdraw()">Вывести</button>
                <button class="modal-btn cancel" onclick="closeWithdrawModal()">Отмена</button>
            </div>
        </div>
    </div>

    <div class="modal-overlay" id="accountModal">
        <div class="modal">
            <h2>Мой аккаунт</h2>
            <div style="background: rgba(150, 150, 150, 0.1); padding: 20px; border-radius: 15px; margin-bottom: 25px;">
                <div style="font-size: 2.2rem; color: white; font-weight: 900; margin-bottom: 20px;" id="accountBalance">1.00 TON</div>
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-bottom: 25px;">
                    <button class="modal-btn confirm" onclick="showDepositModal(); closeAccountModal()">Пополнить</button>
                    <button class="modal-btn cancel" onclick="showWithdrawModal(); closeAccountModal()">Вывод средств</button>
                </div>
            </div>
            <div style="text-align: left;">
                <h3 style="color: white; margin-bottom: 15px;">Последние 3 ставки:</h3>
                <div id="lastBetsList">
                    <!-- Заполнится JS -->
                </div>
            </div>
            <div class="modal-buttons">
                <button class="modal-btn cancel" onclick="closeAccountModal()">Закрыть</button>
            </div>
        </div>
    </div>

    <div class="modal-overlay win-modal-overlay" id="winModal">
        <div class="modal">
            <h2>Выигрыш!</h2>
            <div style="font-size: 3.5rem; font-weight: 900; color: #888; margin-bottom: 25px; display: flex; align-items: center; justify-content: center; gap: 10px;" id="winAmountDisplay">
                +0.00 <img src="https://ton.org/download/ton_symbol.png" alt="TON" style="width: 48px; height: 48px; margin-left: 10px;">
            </div>
            <div style="font-size: 1.3rem; color: white; margin-bottom: 25px;" id="winMultiplierDisplay">при 0.00x</div>
            <div class="modal-buttons">
                <button class="modal-btn confirm" onclick="closeWinModal()">Отлично!</button>
            </div>
        </div>
    </div>

    <div class="modal-overlay support-modal-overlay" id="supportModal">
        <div class="modal" style="text-align: left;">
            <h2>Техническая поддержка</h2>
            <div style="height: 250px; overflow-y: auto; border: 2px solid rgba(150, 150, 150, 0.3); border-radius: 12px; padding: 12px; margin-bottom: 15px; background: rgba(0, 0, 0, 0.5);" id="supportChat">
                <div style="margin-bottom: 12px; padding: 8px; border-radius: 8px; background: rgba(255, 255, 255, 0.1);">
                    Добро пожаловать! Я помогу вам с популярными вопросами. Выберите интересующую тему или задайте свой вопрос.
                </div>
            </div>
            <div style="display: flex; gap: 8px;">
                <input type="text" style="flex: 1; padding: 8px; background: rgba(0, 0, 0, 0.5); border: 2px solid rgba(150, 150, 150, 0.3); border-radius: 8px; color: white; font-family: 'Orbitron', monospace;" id="supportInput" placeholder="Задайте ваш вопрос...">
                <button style="background: #888; color: white; border: none; padding: 8px 16px; border-radius: 8px; cursor: pointer; font-family: 'Orbitron', monospace; font-weight: 700;" onclick="sendSupportMessage()">Отправить</button>
            </div>
            <div class="modal-buttons" style="margin-top: 20px;">
                <button class="modal-btn cancel" onclick="closeSupportModal()">Закрыть</button>
            </div>
        </div>
    </div>

    <script>
        // Все тот же JavaScript код остается без изменений, только добавляем функции для мобильного интерфейса

        const playerNames = [
            "Smexoed", "sophiexeonfan", "Love11Ak", "rizzaaak", "malisss", "ggyohj", "Bellysimo5", 
            "user3_141", "smolnikovvvvv", "WhiteHumanDark", "berwlins", "JohnDoebutdontDoe", "Movevome", 
            "donyaa_gaaazzz", "mlxlmx", "I_lovee_Thanos", "cTTuCTTokoUno", "xzwxw", "Icegerco", 
            "vei_1005", "qaoe1", "Onotolion", "AnykaqX", "usokc", "Fuh1nter", "zweeqrw", "Emir20347", 
            "Pyctoslov", "izceebeam", "AND_FROSH", "Gabsila", "Hranitelsemeni", "Sruhdr", "Angels_Cut", 
            "s1rna", "strelok430", "LadaSilver", "ElfAldarion", "HELL_666_XD", "AMOGUSHKA", "ukd_0", 
            "akylkaaa", "sy1kkp", "Darv1zzzBR", "femetistov", "iuHZxluq", "robsopw", "JolyneKujoJojo", 
            "Tiorichaan", "Vasul66", "azyzyzyy", "lievlner", "id_swatmvd", "Emitruebankst", "KENDIK_epta", 
            "NOSEXG", "Zenvogtr", "Menyavsyezaebal", "Darina192015", "Anyasss444", "mmaayy8", "iwoho", 
            "pirozhock13", "Marv_Jr", "fuebdndjuf", "lenalll6", "AKHQU", "elizabethhatextt", "katk_a", 
            "SaniaCement", "wowtryiq", "YV_ZXZ", "Vlad26126", "rahmatilllo", "ksivusd", "Krayyz", 
            "Ekaterinabraun", "Aytiistt", "weyq4", "Za11ur", "jamshid_makhm", "lepeshkkaa", "abdu11ayefva", 
            "f0rwwhaT", "wrn77777", "Snezhokov", "ssshhhadowww", "rmlvnns", "imxumku", "menzneebet1", 
            "difereq", "Kitty_poy", "Why_e100", "losinghealth", "m1llezzz", "Saka_su", "skrwwv", 
            "FOREVARRRRR", "Rrr_Nnn1", "SillyCat_fan", "Viper_z3", "Bebe_Rehnna", "sigma_bima_ma", 
            "loveme_plase", "tuffiz", "wlwwlwpp", "Kaminoko_ice", "oIdworld", "Pivo_1_milkiwey", 
            "consteint_dead", "menedwe", "kavidochek", "genaaaaaaaaaaaadiiii", "vakho_brooklin_gg", 
            "ZackActiogl0", "eweryyn", "n53ssh", "Mnufo", "evimilf", "a9ykk", "milvicss", "mm_okak", 
            "garryunix", "xaneetaaax", "Venno_Laupaev", "zimehka", "amiishk1a", "villmelz", "kismwwm", 
            "Myfkakp", "qqwk67", "c9TeROO5", "Garlic_in_a_hat", "andreykashn", "vtrrx_1", "AtRCra9", 
            "W1ZAR16", "Onetdozajd", "Zanetti888", "Mandy_princess", "ninehundred900", "danyamon", 
            "Shvern", "tyyskw", "weshlwe", "Ddduudddeee", "Molodoyfarhor", "Elyor_Navruz", "shdwrzesquad"
        ];

        const exchangeRates = {
            TON: 2.5,
            USDT: 1.0,
            BTC: 96500
        };

        let currentDisplayCurrency = 'USD';
        let currentBetCurrency = 'TON';
        let isBalanceHidden = false;
        let isWalletBalanceHidden = false;
        let areSmallBalancesHidden = false;
        let depositTimer = null;
        let depositAmount = 0;
        let isInDepositWindow = false;

        // Данные для START кейса
        const startCasePrizes = [
            {
                name: "Мишка",
                image: "https://emojio.ru/images/apple-b/11.0/1f9f8.png",
                description: "Милый плюшевый мишка",
                price: 0.10,
                chance: 30
            },
            {
                name: "Шампанское",
                image: "https://emojio.ru/images/apple-b/1f37e.png",
                description: "Игристое шампанское для празднования",
                price: 0.50,
                chance: 20
            },
            {
                name: "Подарок #3",
                image: "https://i.postimg.cc/HsZsMPW2/9017120-imgwebp-Photoroom.png",
                description: "Загадочный подарок",
                price: 0.10,
                chance: 25
            },
            {
                name: "Подарок #4",
                image: "https://i.postimg.cc/1XF2zXzF/2025-10-04-233431-Photoroom.png",
                description: "Особенный сюрприз",
                price: 0.50,
                chance: 15
            },
            {
                name: "Подарок #5",
                image: "https://i.postimg.cc/BbNDHctn/2025-10-04-233719-Photoroom.png",
                description: "Ценный подарок",
                price: 1.00,
                chance: 7
            },
            {
                name: "Подарок #6",
                image: "https://i.postimg.cc/rw5VHyCz/2025-10-04-233857-Photoroom.png",
                description: "Редкий предмет",
                price: 1.00,
                chance: 6
            }
        ];

        let currentWonPrize = null;
        let isDemoCase = false;

        const translations = {
            ru: {
                'balance': 'Баланс',
                'deposit': 'Пополнить',
                'withdraw': 'Вывести',
                'login': 'Войти',
                'online': 'Онлайн',
                'crash-game': 'Crash',
                'bonus': 'Бонусы',
                'cases': 'Кейсы',
                'wallet': 'Кошелек'
            },
            en: {
                'balance': 'Balance',
                'deposit': 'Deposit',
                'withdraw': 'Withdraw',
                'login': 'Login',
                'online': 'Online',
                'crash-game': 'Crash',
                'bonus': 'Bonus',
                'cases': 'Cases',
                'wallet': 'Wallet'
            }
        };

        let currentLanguage = 'ru';

        function initializeApp() {
            const loadingOverlay = document.getElementById('loadingOverlay');
            
            game = new CrashGame();
            updateLanguage();
            loadUserData();
            
            setTimeout(() => {
                if (loadingOverlay) {
                    loadingOverlay.classList.add('fade-out');
                    setTimeout(() => {
                        if (loadingOverlay && loadingOverlay.parentNode) {
                            loadingOverlay.style.display = 'none';
                            loadingOverlay.remove();
                        }
                    }, 800);
                }
            }, 1500);
        }

        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', initializeApp);
        } else {
            initializeApp();
        }

        function switchToSlide(slideIndex) {
            const sliderContainer = document.getElementById('sliderContainer');
            const navIcons = document.querySelectorAll('.nav-icon');
            
            sliderContainer.style.transform = `translateX(-${slideIndex * 25}%)`;
            
            navIcons.forEach((icon, index) => {
                if (index === slideIndex) {
                    icon.classList.add('active');
                } else {
                    icon.classList.remove('active');
                }
            });
        }

        function toggleLanguage() {
            currentLanguage = currentLanguage === 'ru' ? 'en' : 'ru';
            updateLanguage();
        }

        function updateLanguage() {
            const switcher = document.getElementById('languageSwitcher');
            switcher.textContent = currentLanguage.toUpperCase();

            document.querySelectorAll('[data-lang]').forEach(element => {
                const key = element.getAttribute('data-lang');
                if (translations[currentLanguage][key]) {
                    element.textContent = translations[currentLanguage][key];
                }
            });
        }

        // Класс игры адаптирован под мобильный интерфейс
        class CrashGame {
            constructor() {
                this.balance = 1.00;
                this.gameState = 'waiting';
                this.currentMultiplier = 1.00;
                this.betAmount = 0;
                this.hasBet = false;
                this.nextGameBet = false;
                this.nextGameBetAmount = 0;
                this.gameHistory = [];
                this.miniHistory = [];
                this.totalGames = 0;
                this.wins = 0;
                this.crashPoint = 0;
                this.gameStartTime = 0;
                this.players = [];
                this.gameLoopId = null;
                this.countdownInterval = null;
                this.gameTimeout = null;
                this.chartPoints = [];
                this.isCrashed = false;
                this.onlineCount = 127;
                this.isLoggedIn = false;
                this.playerNick = '';
                this.userBets = [];
                this.currentWinAmount = 0;
                
                this.bonusStage = 1;
                this.totalDeposits = 0;
                this.totalBonusReceived = 0;
                this.bonusStages = [
                    { stage: 1, bonus: 100, description: "first-deposit" },
                    { stage: 2, bonus: 50, description: "second-deposit" },
                    { stage: 3, bonus: 10, description: "third-deposit" },
                    { stage: 4, bonus: 10, description: "fourth-deposit" },
                    { stage: 5, bonus: 10, description: "fifth-deposit" }
                ];
                
                this.loadGameData();
                this.initializeGame();
                this.startContinuousGame();
                this.startOnlineCounter();
                this.initializeBonusSystem();
            }

            saveGameData() {
                const gameData = {
                    balance: this.balance,
                    totalGames: this.totalGames,
                    wins: this.wins,
                    totalDeposits: this.totalDeposits,
                    totalBonusReceived: this.totalBonusReceived,
                    userBets: this.userBets,
                    gameHistory: this.gameHistory.slice(-10),
                    timestamp: Date.now()
                };
                localStorage.setItem('crashGameData', JSON.stringify(gameData));
            }

            loadGameData() {
                const savedData = localStorage.getItem('crashGameData');
                if (savedData) {
                    try {
                        const gameData = JSON.parse(savedData);
                        const maxAge = 30 * 24 * 60 * 60 * 1000;
                        if (Date.now() - gameData.timestamp < maxAge) {
                            this.balance = gameData.balance || 1.00;
                            this.totalGames = gameData.totalGames || 0;
                            this.wins = gameData.wins || 0;
                            this.totalDeposits = gameData.totalDeposits || 0;
                            this.totalBonusReceived = gameData.totalBonusReceived || 0;
                            this.userBets = gameData.userBets || [];
                            this.gameHistory = gameData.gameHistory || [];
                        }
                    } catch (e) {
                        console.log('Ошибка при загрузке сохраненных данных:', e);
                    }
                }
            }

            initializeGame() {
                this.updateDisplay();
                this.updateLoginState();
                this.updateWalletDisplay();
            }

            startOnlineCounter() {
                setInterval(() => {
                    this.onlineCount = Math.floor(Math.random() * 51) + 110;
                    document.getElementById('onlineCount').textContent = this.onlineCount;
                }, 3000);
            }

            startContinuousGame() {
                this.startGameLoop();
            }

            generatePlayers() {
                this.players = [];
                const playersCount = Math.floor(Math.random() * 20) + 15; // Меньше игроков для мобильного
                
                for (let i = 0; i < playersCount; i++) {
                    const betAmount = Math.random() * 49.9 + 0.1;
                    const randomName = playerNames[Math.floor(Math.random() * playerNames.length)];
                    
                    this.players.push({
                        name: randomName.substring(0, 8),
                        bet: betAmount.toFixed(2),
                        cashout: '-',
                        hasCashedOut: false,
                        cashedOutAt: 0,
                        isUser: false
                    });
                }
                this.players.sort((a, b) => parseFloat(b.bet) - parseFloat(a.bet));
            }

            updatePlayersDisplay() {
                const playersList = document.getElementById('playersList');
                
                if (this.gameState === 'countdown') {
                    playersList.innerHTML = '';
                }
                
                this.addUserToPlayersList();
                
                if (this.gameState === 'countdown' && playersList.children.length <= 1) {
                    this.players.forEach((player, index) => {
                        const delay = (index * 3000) / this.players.length;
                        setTimeout(() => {
                            this.addPlayerToDisplay(player, index);
                        }, delay);
                    });
                } else if (this.gameState !== 'countdown') {
                    this.updateExistingPlayers();
                }
            }

            addUserToPlayersList() {
                const playersList = document.getElementById('playersList');
                let userDiv = playersList.querySelector('.player-item.user');
                
                if (this.isLoggedIn && (this.hasBet || this.nextGameBet)) {
                    const userBetAmount = this.hasBet ? this.betAmount : this.nextGameBetAmount;
                    
                    if (!userDiv) {
                        userDiv = document.createElement('div');
                        userDiv.className = 'player-item user';
                        playersList.insertBefore(userDiv, playersList.firstChild);
                    }
                    
                    let displayBet = userBetAmount.toFixed(2);
                    let cashoutDisplay = '-';
                    
                    if (this.gameState === 'playing' && this.hasBet) {
                        const potentialWin = (userBetAmount * this.currentMultiplier).toFixed(2);
                        displayBet = `${userBetAmount.toFixed(2)}`;
                        cashoutDisplay = `${potentialWin}`;
                    } else if (this.hasBet || this.nextGameBet) {
                        displayBet = `${userBetAmount.toFixed(2)}`;
                    }
                    
                    userDiv.innerHTML = `
                        <div class="player-info">
                            <div class="player-name">${this.playerNick.substring(0, 8)}</div>
                            <div style="display: flex; justify-content: space-between; flex: 1; align-items: center;">
                                <div class="player-bet">
                                    ${displayBet} <img src="https://ton.org/download/ton_symbol.png" alt="" style="width: 12px; height: 12px;">
                                </div>
                                <div class="player-cashout">
                                    ${cashoutDisplay}
                                </div>
                            </div>
                        </div>
                    `;
                } else if (userDiv) {
                    userDiv.remove();
                }
            }

            addPlayerToDisplay(player, index) {
                const playersList = document.getElementById('playersList');
                const playerDiv = document.createElement('div');
                playerDiv.className = 'player-item';
                playerDiv.style.animationDelay = `${index * 0.05}s`;
                
                let betDisplay = `${player.bet}`;
                let cashoutDisplay = player.cashout;
                
                playerDiv.innerHTML = `
                    <div class="player-info">
                        <div class="player-name">${player.name}</div>
                        <div style="display: flex; justify-content: space-between; flex: 1; align-items: center;">
                            <div class="player-bet">
                                ${betDisplay} <img src="https://ton.org/download/ton_symbol.png" alt="" style="width: 12px; height: 12px;">
                            </div>
                            <div class="player-cashout">
                                ${cashoutDisplay}
                            </div>
                        </div>
                    </div>
                `;
                playersList.appendChild(playerDiv);
            }

            updateExistingPlayers() {
                const playersList = document.getElementById('playersList');
                const playerItems = playersList.querySelectorAll('.player-item:not(.user)');
                
                playerItems.forEach((playerDiv, index) => {
                    const player = this.players[index];
                    if (!player) return;
                    
                    let cashoutDisplay = player.cashout;
                    
                    playerDiv.classList.remove('won', 'lost');
                    
                    if (this.gameState === 'playing' && !player.hasCashedOut) {
                        const potentialWin = (parseFloat(player.bet) * this.currentMultiplier).toFixed(2);
                        cashoutDisplay = `${potentialWin}`;
                    } else if (player.hasCashedOut) {
                        cashoutDisplay = player.cashout;
                        playerDiv.classList.add('won');
                    } else if (this.gameState === 'crashed' && !player.hasCashedOut) {
                        playerDiv.classList.add('lost');
                        cashoutDisplay = '-';
                    }
                    
                    const cashoutElement = playerDiv.querySelector('.player-cashout');
                    if (cashoutElement) {
                        cashoutElement.textContent = cashoutDisplay;
                    }
                });
            }

            startGameLoop() {
                this.clearAllIntervals();
                this.generatePlayers();
                this.startCountdown();
            }

            clearAllIntervals() {
                if (this.gameLoopId) {
                    cancelAnimationFrame(this.gameLoopId);
                    this.gameLoopId = null;
                }
                if (this.countdownInterval) {
                    clearInterval(this.countdownInterval);
                    this.countdownInterval = null;
                }
                if (this.gameTimeout) {
                    clearTimeout(this.gameTimeout);
                    this.gameTimeout = null;
                }
            }

            startCountdown() {
                this.gameState = 'countdown';
                const countdown = document.getElementById('countdown');
                const countdownNumber = document.getElementById('countdownNumber');
                
                countdown.style.display = 'flex';
                
                this.addMiniHistoryItem('?', 'pending');
                
                if (this.nextGameBet && this.isLoggedIn) {
                    this.betAmount = this.nextGameBetAmount;
                    this.balance -= this.betAmount;
                    this.hasBet = true;
                    this.nextGameBet = false;
                }
                
                this.updatePlayerActionButtons();
                this.updatePlayersDisplay();
                
                let count = 5;
                countdownNumber.textContent = count;

                this.countdownInterval = setInterval(() => {
                    count--;
                    if (count > 0) {
                        countdownNumber.textContent = count;
                    } else {
                        clearInterval(this.countdownInterval);
                        this.countdownInterval = null;
                        countdown.style.display = 'none';
                        this.startGame();
                    }
                }, 1000);
            }

            startGame() {
                this.gameState = 'playing';
                this.currentMultiplier = 1.00;
                this.crashPoint = this.generateCrashPoint();
                this.gameStartTime = Date.now();
                this.chartPoints = [];
                this.isCrashed = false;
                this.currentWinAmount = this.hasBet ? this.betAmount : 0;
                
                this.simulatePlayerCashouts();
                this.updatePlayerActionButtons();
                
                document.getElementById('chartLine').setAttribute('d', '');
                document.getElementById('chartArea').setAttribute('d', '');
                document.getElementById('chartLine').classList.remove('crashed');

                const existingCrash = document.querySelector('.game-crashed');
                if (existingCrash) {
                    existingCrash.remove();
                }

                document.getElementById('multiplier').className = 'multiplier-display';

                this.gameLoop();
            }

            simulatePlayerCashouts() {
                this.players.forEach(player => {
                    player.hasCashedOut = false;
                    player.cashedOutAt = 0;
                    player.cashout = '-';
                    
                    if (Math.random() < 0.7) {
                        const maxCashout = Math.max(1.2, this.crashPoint - 0.5);
                        const cashoutPoint = Math.random() * (maxCashout - 1.2) + 1.2;
                        player.cashedOutAt = cashoutPoint;
                    }
                });
            }

            generateCrashPoint() {
                const rand = Math.random();
                if (rand < 0.15) return 1.00 + Math.random() * 0.5;
                if (rand < 0.35) return 1.5 + Math.random() * 1.0;
                if (rand < 0.60) return 2.5 + Math.random() * 2.5;
                if (rand < 0.80) return 5.0 + Math.random() * 5.0;
                if (rand < 0.95) return 10.0 + Math.random() * 15.0;
                return 25.0 + Math.random() * 75.0;
            }

            gameLoop() {
                if (this.gameState !== 'playing' && this.gameState !== 'crashed') {
                    return;
                }

                const elapsed = Date.now() - this.gameStartTime;
                
                if (!this.isCrashed) {
                    this.currentMultiplier = 1.00 + Math.pow(elapsed / 1500, 1.1) * 1.2;
                }

                const multiplierElement = document.getElementById('multiplier');
                multiplierElement.textContent = this.currentMultiplier.toFixed(2) + 'x';

                this.updateTradingChart();

                this.players.forEach(player => {
                    if (!player.hasCashedOut && player.cashedOutAt > 0 && this.currentMultiplier >= player.cashedOutAt) {
                        player.hasCashedOut = true;
                        const winAmount = (parseFloat(player.bet) * player.cashedOutAt).toFixed(2);
                        player.cashout = `${winAmount}`;
                    }
                });

                if (this.hasBet && !this.isCrashed) {
                    this.currentWinAmount = this.betAmount * this.currentMultiplier;
                    this.updatePlayerActionButtons();
                }

                this.updateExistingPlayers();

                if (this.currentMultiplier >= this.crashPoint && !this.isCrashed) {
                    this.crashGame();
                    return;
                }

                this.gameLoopId = requestAnimationFrame(() => this.gameLoop());
            }

            updateTradingChart() {
                const width = 800;
                const height = 500;

                const elapsed = Date.now() - this.gameStartTime;
                
                const x = Math.min((elapsed / 15000) * (width - 100), width - 100) + 50;
                
                const multiplierProgress = Math.min((this.currentMultiplier - 1.00) / 19.0, 1.0);
                const smoothProgress = Math.pow(multiplierProgress, 0.4);
                const y = Math.max(height - 50 - (smoothProgress * (height - 150)), 50);
                
                this.chartPoints.push({ x: x, y: y });

                if (this.chartPoints.length > 300) {
                    this.chartPoints.shift();
                }

                let linePath = '';
                let areaPath = '';
                
                if (this.chartPoints.length > 0) {
                    linePath = `M ${this.chartPoints[0].x} ${this.chartPoints[0].y}`;
                    areaPath = `M ${this.chartPoints[0].x} ${height - 50}`;
                    areaPath += ` L ${this.chartPoints[0].x} ${this.chartPoints[0].y}`;
                    
                    for (let i = 1; i < this.chartPoints.length; i++) {
                        linePath += ` L ${this.chartPoints[i].x} ${this.chartPoints[i].y}`;
                        areaPath += ` L ${this.chartPoints[i].x} ${this.chartPoints[i].y}`;
                    }
                    
                    const lastPoint = this.chartPoints[this.chartPoints.length - 1];
                    areaPath += ` L ${lastPoint.x} ${height - 50} Z`;
                }

                document.getElementById('chartLine').setAttribute('d', linePath);
                document.getElementById('chartArea').setAttribute('d', areaPath);
            }

            crashGame() {
                this.gameState = 'crashed';
                this.isCrashed = true;
                
                this.clearAllIntervals();
                
                document.getElementById('chartLine').classList.add('crashed');
                
                const gameCanvas = document.getElementById('gameCanvas');
                const crashMessage = document.createElement('div');
                crashMessage.className = 'game-crashed';
                crashMessage.textContent = `${this.crashPoint.toFixed(2)}x`;
                gameCanvas.appendChild(crashMessage);

                document.getElementById('multiplier').className = 'multiplier-display red';

                this.updateMiniHistoryWithResult(this.crashPoint);

                if (this.hasBet) {
                    const result = {
                        bet: this.betAmount,
                        multiplier: this.crashPoint,
                        result: 'lose',
                        amount: -this.betAmount
                    };
                    this.userBets.unshift(result);
                    if (this.userBets.length > 3) this.userBets.pop();
                    
                    this.gameHistory.push({ multiplier: this.crashPoint, win: false, bet: this.betAmount });
                    this.hasBet = false;
                    this.currentWinAmount = 0;
                } else {
                    this.gameHistory.push({ multiplier: this.crashPoint, win: null, bet: 0 });
                }

                this.totalGames++;
                this.saveGameData();
                this.updateDisplay();
                this.updatePlayerActionButtons();
                this.updateExistingPlayers();

                if (this.gameHistory.length > 10) {
                    this.gameHistory = this.gameHistory.slice(-10);
                }

                this.gameTimeout = setTimeout(() => {
                    this.startGameLoop();
                }, 3000);
            }

            addMiniHistoryItem(value, type) {
                const miniHistory = document.getElementById('gameHistoryMini');
                const item = document.createElement('div');
                item.className = `mini-result ${type}`;
                item.textContent = value;
                
                miniHistory.appendChild(item);
                
                while (miniHistory.children.length > 5) {
                    miniHistory.removeChild(miniHistory.firstChild);
                }
            }

            updateMiniHistoryWithResult(multiplier) {
                const miniHistory = document.getElementById('gameHistoryMini');
                const pendingItem = miniHistory.querySelector('.pending');
                
                if (pendingItem) {
                    pendingItem.textContent = multiplier.toFixed(2) + 'x';
                    pendingItem.classList.remove('pending');
                    
                    if (multiplier < 2.00) {
                        pendingItem.classList.add('red');
                    } else if (multiplier >= 2.01 && multiplier <= 5.00) {
                        pendingItem.classList.add('yellow');
                    } else if (multiplier > 5.00 && multiplier <= 10.00) {
                        pendingItem.classList.add('orange');
                    } else {
                        pendingItem.classList.add('green');
                    }
                }
            }

            updateLoginState() {
                const loginOverlay = document.getElementById('loginOverlay');
                const balanceMobile = document.getElementById('balanceMobile');
                
                if (this.isLoggedIn) {
                    loginOverlay.style.display = 'none';
                    balanceMobile.classList.remove('balance-blurred');
                    this.updatePlayerActionButtons();
                } else {
                    loginOverlay.style.display = 'block';
                    balanceMobile.classList.add('balance-blurred');
                }
            }

            updatePlayerActionButtons() {
                const cashoutButton = document.getElementById('cashoutButtonMobile');
                
                cashoutButton.classList.remove('show');
                
                if (!this.isLoggedIn) return;
                
                if (this.gameState === 'playing' && this.hasBet) {
                    cashoutButton.classList.add('show');
                    cashoutButton.innerHTML = `Забрать ${this.currentWinAmount.toFixed(2)} <img src="https://ton.org/download/ton_symbol.png" alt="TON" style="width: 16px; height: 16px; margin-left: 5px;">`;
                }
            }

            placeBet(amount) {
                if (!this.isLoggedIn) {
                    showLoginModal();
                    return false;
                }
                
                if (amount <= 0 || amount > this.balance) {
                    alert('Неверная сумма ставки!');
                    return false;
                }

                if (this.gameState === 'countdown' || this.gameState === 'waiting' || this.gameState === 'crashed') {
                    if (this.gameState === 'countdown') {
                        this.betAmount = amount;
                        this.balance -= amount;
                        this.hasBet = true;
                        this.currentWinAmount = amount;
                    } else {
                        this.nextGameBet = true;
                        this.nextGameBetAmount = amount;
                        this.balance -= amount;
                    }
                } else {
                    this.nextGameBet = true;
                    this.nextGameBetAmount = amount;
                    this.balance -= amount;
                }
                
                this.saveGameData();
                this.updateDisplay();
                this.updatePlayerActionButtons();
                this.updatePlayersDisplay();
                return true;
            }

            cashOut() {
                if (!this.isLoggedIn || this.gameState !== 'playing' || !this.hasBet) return;
                
                const winAmount = this.betAmount * this.currentMultiplier;
                this.balance += winAmount;
                
                const result = {
                    bet: this.betAmount,
                    multiplier: this.currentMultiplier,
                    result: 'win',
                    amount: winAmount
                };
                this.userBets.unshift(result);
                if (this.userBets.length > 3) this.userBets.pop();
                
                this.showWinModal(winAmount, this.currentMultiplier);
                
                this.gameHistory.push({ 
                    multiplier: this.currentMultiplier, 
                    win: true, 
                    bet: this.betAmount,
                    winAmount: winAmount 
                });
                
                this.wins++;
                
                this.hasBet = false;
                this.betAmount = 0;
                this.currentWinAmount = 0;
                
                this.saveGameData();
                this.updateDisplay();
                this.updatePlayerActionButtons();
                this.updatePlayersDisplay();
            }

            showWinModal(winAmount, multiplier) {
                const winModal = document.getElementById('winModal');
                const winAmountDisplay = document.getElementById('winAmountDisplay');
                const winMultiplierDisplay = document.getElementById('winMultiplierDisplay');
                
                winAmountDisplay.innerHTML = `+${winAmount.toFixed(2)} <img src="https://ton.org/download/ton_symbol.png" alt="TON" style="width: 48px; height: 48px; margin-left: 10px;">`;
                winMultiplierDisplay.textContent = `при ${multiplier.toFixed(2)}x`;
                
                winModal.classList.add('show');
            }

            closeWinModal() {
                const winModal = document.getElementById('winModal');
                winModal.classList.remove('show');
            }

            login(nickname) {
                this.isLoggedIn = true;
                this.playerNick = nickname;
                this.updateLoginState();
            }

            updateDisplay() {
                const balanceMobile = document.getElementById('balanceMobile');
                balanceMobile.textContent = this.balance.toFixed(2);
                
                this.updateWalletDisplay();
                
                const accountBalance = document.getElementById('accountBalance');
                if (accountBalance) {
                    accountBalance.textContent = `${this.balance.toFixed(2)} TON`;
                }
            }

            updateWalletDisplay() {
                const totalBalanceDisplay = document.getElementById('totalBalanceDisplay');
                const balanceTonSecondary = document.getElementById('balanceTonSecondary');
                
                if (totalBalanceDisplay && !isWalletBalanceHidden) {
                    const usdValue = (this.balance * exchangeRates.TON);
                    totalBalanceDisplay.textContent = `$${usdValue.toFixed(2)}`;
                }

                if (balanceTonSecondary && !isWalletBalanceHidden) {
                    balanceTonSecondary.textContent = `${(this.balance / 1.5).toFixed(2)} TON`;
                }

                if (!areSmallBalancesHidden) {
                    const tonWalletBalance = document.getElementById('tonWalletBalance');
                    const tonWalletValue = document.getElementById('tonWalletValue');
                    const usdtWalletBalance = document.getElementById('usdtWalletBalance');
                    const usdtWalletValue = document.getElementById('usdtWalletValue');
                    const solWalletBalance = document.getElementById('solWalletBalance');
                    const solWalletValue = document.getElementById('solWalletValue');
                    const tronWalletBalance = document.getElementById('tronWalletBalance');
                    const tronWalletValue = document.getElementById('tronWalletValue');
                    const btcWalletBalance = document.getElementById('btcWalletBalance');
                    const btcWalletValue = document.getElementById('btcWalletValue');

                    if (tonWalletBalance) {
                        tonWalletBalance.textContent = `${(this.balance / 1.5).toFixed(2)} TON`;
                        tonWalletValue.textContent = `$${(this.balance * exchangeRates.TON).toFixed(2)}`;
                    }

                    if (usdtWalletBalance) {
                        const usdtAmount = (this.balance * exchangeRates.TON);
                        usdtWalletBalance.textContent = `${usdtAmount.toFixed(0)} USDT`;
                        usdtWalletValue.textContent = `$${usdtAmount.toFixed(2)}`;
                    }

                    if (solWalletBalance) {
                        const solAmount = (this.balance * exchangeRates.TON / 201.83);
                        solWalletBalance.textContent = `${solAmount.toFixed(2)} SOL`;
                        solWalletValue.textContent = `$${(this.balance * exchangeRates.TON).toFixed(2)}`;
                    }

                    if (tronWalletBalance) {
                        const tronAmount = (this.balance * exchangeRates.TON / 0.337);
                        tronWalletBalance.textContent = `${tronAmount.toFixed(0)} TRX`;
                        tronWalletValue.textContent = `$${(this.balance * exchangeRates.TON).toFixed(2)}`;
                    }

                    if (btcWalletBalance) {
                        const btcAmount = (this.balance * exchangeRates.TON / 109497);
                        btcWalletBalance.textContent = `${btcAmount.toFixed(8)} BTC`;
                        btcWalletValue.textContent = `$${(this.balance * exchangeRates.TON).toFixed(2)}`;
                    }
                }
            }

            initializeBonusSystem() {
                this.createBonusStages();
                this.updateBonusDisplay();
            }

            createBonusStages() {
                const bonusStagesContainer = document.getElementById('bonusStages');
                if (!bonusStagesContainer) return;
                
                bonusStagesContainer.innerHTML = '';
                
                this.bonusStages.forEach((stage, index) => {
                    const stageElement = document.createElement('div');
                    stageElement.className = 'bonus-stage';
                    
                    if (this.totalDeposits >= stage.stage) {
                        stageElement.classList.add('completed');
                    } else if (this.totalDeposits + 1 === stage.stage) {
                        stageElement.classList.add('active');
                    }
                    
                    stageElement.innerHTML = `
                        <div class="bonus-stage-number">Стадия ${stage.stage}</div>
                        <div class="bonus-percentage">+${stage.bonus}%</div>
                        <div class="bonus-description">Пополнение ${stage.stage}</div>
                    `;
                    
                    bonusStagesContainer.appendChild(stageElement);
                });
            }

            updateBonusDisplay() {
                const totalDepositsEl = document.getElementById('totalDeposits');
                const totalBonusEl = document.getElementById('totalBonus');
                const nextBonusEl = document.getElementById('nextBonusAmount');
                const progressFill = document.getElementById('bonusProgressFill');
                
                if (totalDepositsEl) totalDepositsEl.textContent = this.totalDeposits;
                if (totalBonusEl) totalBonusEl.textContent = this.totalBonusReceived.toFixed(2);
                
                const nextStage = this.bonusStages.find(s => s.stage > this.totalDeposits);
                if (nextBonusEl) nextBonusEl.textContent = nextStage ? `${nextStage.bonus}%` : 'Max';
                
                const progressPercent = Math.min((this.totalDeposits / 5) * 100, 100);
                if (progressFill) progressFill.style.width = progressPercent + '%';
                
                this.createBonusStages();
            }

            deposit(amount) {
                if (!this.isLoggedIn) return;
                
                this.balance += amount;
                this.totalDeposits++;
                
                let bonusPercent = 0;
                if (this.totalDeposits === 1) {
                    bonusPercent = 100;
                } else if (this.totalDeposits === 2) {
                    bonusPercent = 50;
                } else if (this.totalDeposits <= 5) {
                    bonusPercent = 10;
                }
                
                if (bonusPercent > 0) {
                    const bonusAmount = amount * (bonusPercent / 100);
                    this.balance += bonusAmount;
                    this.totalBonusReceived += bonusAmount;
                    
                    alert(`Баланс пополнен на ${amount.toFixed(2)} TON!\nБонус: +${bonusAmount.toFixed(2)} TON (${bonusPercent}%)`);
                } else {
                    alert(`Баланс пополнен на ${amount.toFixed(2)} TON!`);
                }
                
                this.saveGameData();
                this.updateDisplay();
                this.updateBonusDisplay();
            }

            withdraw(amount, address) {
                if (!this.isLoggedIn) return false;
                
                const minWithdraw = 1;
                const networkFee = 0.02;
                const totalRequired = amount + networkFee;
                
                if (amount < minWithdraw) {
                    alert(`Минимальная сумма для вывода: ${minWithdraw} TON`);
                    return false;
                }
                
                if (totalRequired > this.balance) {
                    alert('Недостаточно средств для вывода (включая комиссию сети)');
                    return false;
                }
                
                this.balance -= totalRequired;
                this.saveGameData();
                
                alert(`Заявка на вывод ${amount.toFixed(2)} TON отправлена!\nКомиссия сети: ${networkFee} TON\nАдрес: ${address}`);
                
                this.updateDisplay();
                return true;
            }
        }

        let game;

        // Функции для работы с модальными окнами и интерфейсом
        function saveUserData(nickname) {
            const rememberMe = document.getElementById('rememberMe').checked;
            if (rememberMe) {
                localStorage.setItem('crashGameNickname', nickname);
                localStorage.setItem('crashGameRememberMe', 'true');
            } else {
                localStorage.removeItem('crashGameNickname');
                localStorage.removeItem('crashGameRememberMe');
            }
        }

        function loadUserData() {
            const savedNickname = localStorage.getItem('crashGameNickname');
            const rememberMe = localStorage.getItem('crashGameRememberMe') === 'true';
            
            if (savedNickname && rememberMe) {
                document.getElementById('telegramNick').value = savedNickname;
                document.getElementById('rememberMe').checked = true;
                
                if (savedNickname.length >= 2) {
                    game.login(savedNickname);
                    return true;
                }
            }
            return false;
        }

        function showLoginModal() {
            const modal = document.getElementById('loginModal');
            const input = document.getElementById('telegramNick');
            
            const autoLoggedIn = loadUserData();
            
            if (!autoLoggedIn) {
                modal.classList.add('show');
                input.focus();
            }
        }

        function closeLoginModal() {
            const modal = document.getElementById('loginModal');
            modal.classList.remove('show');
        }

        function login() {
            const nickname = document.getElementById('telegramNick').value.trim();
            if (nickname.length < 2) {
                alert('Введите корректный ник!');
                return;
            }
            
            saveUserData(nickname);
            game.login(nickname);
            closeLoginModal();
        }

        function showBetModal() {
            if (!game.isLoggedIn) {
                showLoginModal();
                return;
            }
            
            const modal = document.getElementById('betModal');
            const input = document.getElementById('betAmountInput');
            
            input.value = '0.10';
            modal.classList.add('show');
            input.focus();
            
            selectBetCurrency('TON');
        }

        function closeBetModal() {
            const modal = document.getElementById('betModal');
            modal.classList.remove('show');
        }

        function setBetAmountModal(amount) {
            document.getElementById('betAmountInput').value = amount.toFixed(2);
        }

        function doubleBetModal() {
            const current = parseFloat(document.getElementById('betAmountInput').value) || 0;
            const doubled = (current * 2).toFixed(2);
            document.getElementById('betAmountInput').value = doubled;
        }

        function selectBetCurrency(currency) {
            currentBetCurrency = currency;
            
            const tonBtn = document.getElementById('tonCurrencyBtn');
            const usdtBtn = document.getElementById('usdtCurrencyBtn');
            
            tonBtn.classList.remove('active');
            usdtBtn.classList.remove('active');
            
            if (currency === 'TON') {
                tonBtn.classList.add('active');
            } else {
                usdtBtn.classList.add('active');
            }
            
            const iconSrc = currency === 'TON' ? 
                'https://files.svgcdn.io/token-branded/ton.png' : 
                'https://upload.wikimedia.org/wikipedia/commons/0/01/USDT_Logo.png';
            
            for (let i = 1; i <= 5; i++) {
                const icon = document.getElementById(`quickBet${i}Icon`);
                if (icon) {
                    icon.src = iconSrc;
                    icon.alt = currency;
                }
            }
        }

        function confirmBet() {
            const amount = parseFloat(document.getElementById('betAmountInput').value);
            
            if (amount && amount > 0 && game.placeBet(amount)) {
                closeBetModal();
            } else {
                alert('Введите корректную сумму!');
            }
        }

        let selectedDepositCurrency = '';

        function showDepositModal() {
            if (!game.isLoggedIn) {
                showLoginModal();
                return;
            }
            
            const modal = document.getElementById('depositModal');
            const input = document.getElementById('depositAmount');
            const depositButtons = document.getElementById('depositButtons');
            const tonDepositInfo = document.getElementById('tonDepositInfo');
            const promoInput = document.getElementById('promoCodeInput');
            
            input.value = '';
            promoInput.value = '';
            depositButtons.style.display = 'flex';
            tonDepositInfo.style.display = 'none';
            selectedDepositCurrency = '';
            isInDepositWindow = true;
            
            modal.classList.add('show');
        }

        function closeDepositModal() {
            const modal = document.getElementById('depositModal');
            modal.classList.remove('show');
            isInDepositWindow = false;
            
            if (depositTimer) {
                clearInterval(depositTimer);
                depositTimer = null;
            }
        }

        function depositCurrency(currency) {
            selectedDepositCurrency = currency;
            if (currency === 'SBP') {
                window.open('http://t.me/send?start=IVC1RvnZnd43', '_blank');
            }
        }

        function confirmDeposit() {
            const amount = parseFloat(document.getElementById('depositAmount').value);
            if (!amount || amount <= 0) {
                alert('Введите корректную сумму!');
                return;
            }

            if (selectedDepositCurrency === 'TON') {
                const depositButtons = document.getElementById('depositButtons');
                const tonDepositInfo = document.getElementById('tonDepositInfo');
                
                depositButtons.style.display = 'none';
                tonDepositInfo.style.display = 'block';
                
                depositAmount = amount;
                startDepositTimer(amount);
            } else {
                game.deposit(amount);
                closeDepositModal();
            }
        }

        function startDepositTimer(amount) {
            let timeLeft = 300;
            depositTimer = setInterval(() => {
                if (!isInDepositWindow) {
                    clearInterval(depositTimer);
                    return;
                }
                
                const minutes = Math.floor(timeLeft / 60);
                const seconds = timeLeft % 60;
                const timerDisplay = document.getElementById('timerDisplay');
                if (timerDisplay) {
                    timerDisplay.textContent = `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
                }
                
                timeLeft--;
                
                if (timeLeft < 0) {
                    clearInterval(depositTimer);
                    if (game && isInDepositWindow) {
                        game.deposit(amount);
                        closeDepositModal();
                    }
                }
            }, 1000);
        }

        function copyAddress() {
            const text = "UQCvyMHj2r7Ig73EcbBI3h405uemns12eX49OBW3cVsOEzuW";
            navigator.clipboard.writeText(text).then(function() {
                alert('Адрес скопирован в буфер обмена!');
            });
        }

        function openCryptoPay() {
            alert('Открывается CryptoPay...');
            window.open('http://t.me/send?start=IVC1RvnZnd43', '_blank');
        }

        function applyPromoCode() {
            const promoInput = document.getElementById('promoCodeInput');
            const promoCode = promoInput.value.trim();
            
            if (!game.isLoggedIn) {
                alert('Сначала войдите в аккаунт!');
                return;
            }
            
            const validPromoCodes = ['Promo100', 'Vigh', 'KINO', 'TikTok', 'YouTube', 'Reels'];
            
            if (validPromoCodes.includes(promoCode)) {
                game.balance += 0.05;
                game.saveGameData();
                game.updateDisplay();
                game.updateWalletDisplay();
                
                promoInput.value = '';
                alert('Промокод активирован! На ваш баланс начислено 0.05 TON!');
            } else if (promoCode === '111') {
                game.balance = 0;
                game.saveGameData();
                game.updateDisplay();
                game.updateWalletDisplay();
                
                promoInput.value = '';
                alert('Промокод активирован! Баланс обнулен!');
            } else {
                alert('Неверный промокод!');
            }
        }

        function showWithdrawModal() {
            if (!game.isLoggedIn) {
                showLoginModal();
                return;
            }
            
            const modal = document.getElementById('withdrawModal');
            const addressInput = document.getElementById('withdrawAddress');
            const amountInput = document.getElementById('withdrawAmount');
            
            addressInput.value = '';
            amountInput.value = '';
            modal.classList.add('show');
            addressInput.focus();
        }

        function closeWithdrawModal() {
            const modal = document.getElementById('withdrawModal');
            modal.classList.remove('show');
        }

        function confirmWithdraw() {
            const address = document.getElementById('withdrawAddress').value.trim();
            const amount = parseFloat(document.getElementById('withdrawAmount').value);
            
            if (!address) {
                alert('Введите TON адрес!');
                return;
            }
            
            if (!amount || amount <= 0) {
                alert('Введите корректную сумму!');
                return;
            }
            
            if (game.withdraw(amount, address)) {
                closeWithdrawModal();
            }
        }

        function showAccountModal() {
            if (!game.isLoggedIn) {
                showLoginModal();
                return;
            }
            
            const modal = document.getElementById('accountModal');
            modal.classList.add('show');
        }

        function closeAccountModal() {
            const modal = document.getElementById('accountModal');
            modal.classList.remove('show');
        }

        function closeWinModal() {
            if (game) game.closeWinModal();
        }

        function cashOut() {
            if (game) {
                game.cashOut();
            }
        }

        function refreshWallet() {
            if (!game.isLoggedIn) return;
            
            const refreshBtn = document.querySelector('.refresh-button');
            refreshBtn.style.transform = 'rotate(360deg)';
            
            setTimeout(() => {
                refreshBtn.style.transform = 'rotate(0deg)';
                game.updateWalletDisplay();
                alert('Кошелек обновлен!');
            }, 500);
        }

        function toggleSmallBalances() {
            areSmallBalancesHidden = !areSmallBalancesHidden;
            
            const assetBalances = document.querySelectorAll('.asset-balance');
            
            assetBalances.forEach((balance, index) => {
                if (index === 0) return;
                
                if (areSmallBalancesHidden) {
                    balance.classList.add('hidden');
                    const amountEl = balance.querySelector('.asset-amount');
                    const valueEl = balance.querySelector('.asset-value');
                    
                    if (amountEl) amountEl.textContent = '***';
                    if (valueEl) valueEl.textContent = '***';
                } else {
                    balance.classList.remove('hidden');
                    if (game) {
                        game.updateWalletDisplay();
                    }
                }
            });
        }

        function participateInContest() {
            window.open('https://t.me/TonBet999', '_blank');
        }

        function toggleCasePrizes() {
            const casePrizes = document.getElementById('casePrizes');
            casePrizes.classList.toggle('show');
        }

        function openStartCase() {
            if (!game.isLoggedIn) {
                showLoginModal();
                return;
            }
            
            if (game.balance < 3.00) {
                alert('Недостаточно средств для открытия кейса!');
                return;
            }
            
            game.balance -= 3.00;
            game.saveGameData();
            game.updateDisplay();
            game.updateWalletDisplay();
            
            alert('Кейс открыт! Функция в разработке.');
        }

        function demoStartCase() {
            if (!game.isLoggedIn) {
                showLoginModal();
                return;
            }
            
            alert('Демо кейс! Функция в разработке.');
        }

        function showSupportModal() {
            const modal = document.getElementById('supportModal');
            modal.classList.add('show');
        }

        function closeSupportModal() {
            const modal = document.getElementById('supportModal');
            modal.classList.remove('show');
        }

        function sendSupportMessage() {
            const input = document.getElementById('supportInput');
            const chat = document.getElementById('supportChat');
            const message = input.value.trim();
            
            if (!message) return;
            
            const userMessage = document.createElement('div');
            userMessage.style.cssText = 'margin-bottom: 12px; padding: 8px; border-radius: 8px; background: rgba(150, 150, 150, 0.3); text-align: right;';
            userMessage.textContent = message;
            chat.appendChild(userMessage);
            
            const response = 'Напишите нам напрямую! @suphiex';
            
            setTimeout(() => {
                const botMessage = document.createElement('div');
                botMessage.style.cssText = 'margin-bottom: 12px; padding: 8px; border-radius: 8px; background: rgba(255, 255, 255, 0.1);';
                botMessage.textContent = response;
                chat.appendChild(botMessage);
                chat.scrollTop = chat.scrollHeight;
            }, 500);
            
            input.value = '';
            chat.scrollTop = chat.scrollHeight;
        }

        // Обработчики событий
        document.addEventListener('click', function(e) {
            if (e.target.classList.contains('modal-overlay')) {
                e.target.classList.remove('show');
                
                if (e.target.id === 'depositModal') {
                    isInDepositWindow = false;
                    if (depositTimer) {
                        clearInterval(depositTimer);
                        depositTimer = null;
                    }
                }
            }
        });

        document.getElementById('telegramNick').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                login();
            }
        });

        document.getElementById('betAmountInput').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                confirmBet();
            }
        });

        document.getElementById('depositAmount').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                confirmDeposit();
            }
        });

        document.getElementById('promoCodeInput').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                applyPromoCode();
            }
        });

        document.getElementById('withdrawAmount').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                confirmWithdraw();
            }
        });

        document.getElementById('supportInput').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                sendSupportMessage();
            }
        });
    </script>
</body>
</html>
